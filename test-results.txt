
> vite-project@0.0.0 test
> vitest --run


[1m[46m RUN [49m[22m [36mv3.2.4 [39m[90mF:/tes 9/sistem-praktikum-pwa[39m

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts
[22m[39mGoTrueClient@sb-rkyoifqbfcztnhevpnpx-auth-token:1 (2.86.0) 2026-01-14T05:57:45.607Z Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mquery[2m > [22m[2mshould fetch all records from a table
[22m[39mðŸ”´ API Error (query:test_table)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mquery[2m > [22m[2mshould fetch all records from a table
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mquery[2m > [22m[2mshould apply select option
[22m[39mðŸ”´ API Error (query:test_table)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mquery[2m > [22m[2mshould apply select option
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mquery[2m > [22m[2mshould apply order option
[22m[39mðŸ”´ API Error (query:test_table)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mquery[2m > [22m[2mshould apply order option
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mquery[2m > [22m[2mshould apply limit option
[22m[39mðŸ”´ API Error (query:test_table)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mquery[2m > [22m[2mshould apply limit option
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mquery[2m > [22m[2mshould apply offset with range
[22m[39mðŸ”´ API Error (query:test_table)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mquery[2m > [22m[2mshould apply offset with range
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstderr[2m | server/src/__tests__/unit/api/nilai.api.test.ts[2m > [22m[2mNilai API - CRUD Operations[2m > [22m[2mgetNilaiByKelas[2m > [22m[2mshould get all nilai for a kelas
[22m[39mgetNilaiByKelas error: ServerError: "failed to parse order (mahasiswa(user(full_name)).asc)" (line 1, column 10)
    at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:284:16[90m)[39m
    at handleError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:323:12[90m)[39m
    at Module.getNilaiByKelas [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\nilai.api.ts:160:22[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\nilai.api.test.ts:230:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
  code: [32m'INTERNAL_ERROR'[39m,
  statusCode: [33m500[39m,
  details: {
    hint: [1mnull[22m,
    details: [32m`unexpected '(' expecting letter, digit, "-", "->>", "->", delimiter (.), "," or end of input`[39m
  },
  timestamp: [32m'2026-01-14T05:57:46.324Z'[39m
}

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mquery[2m > [22m[2mshould throw NotFoundError when throwOnEmpty is true and no data
[22m[39mðŸ”´ API Error (query:test_table)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mquery[2m > [22m[2mshould throw NotFoundError when throwOnEmpty is true and no data
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstderr[2m | server/src/__tests__/unit/api/nilai.api.test.ts[2m > [22m[2mNilai API - CRUD Operations[2m > [22m[2mgetNilaiByKelas[2m > [22m[2mshould return empty array when no nilai found
[22m[39mgetNilaiByKelas error: ServerError: "failed to parse order (mahasiswa(user(full_name)).asc)" (line 1, column 10)
    at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:284:16[90m)[39m
    at handleError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:323:12[90m)[39m
    at Module.getNilaiByKelas [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\nilai.api.ts:160:22[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\nilai.api.test.ts:244:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
  code: [32m'INTERNAL_ERROR'[39m,
  statusCode: [33m500[39m,
  details: {
    hint: [1mnull[22m,
    details: [32m`unexpected '(' expecting letter, digit, "-", "->>", "->", delimiter (.), "," or end of input`[39m
  },
  timestamp: [32m'2026-01-14T05:57:46.422Z'[39m
}

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mqueryWithFilters[2m > [22m[2mshould apply eq filter
[22m[39mðŸ”´ API Error (queryWithFilters:test_table)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mqueryWithFilters[2m > [22m[2mshould apply eq filter
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstderr[2m | server/src/__tests__/unit/api/nilai.api.test.ts[2m > [22m[2mNilai API - CRUD Operations[2m > [22m[2mgetNilaiByKelas[2m > [22m[2mshould throw error on database error
[22m[39mgetNilaiByKelas error: ServerError: "failed to parse order (mahasiswa(user(full_name)).asc)" (line 1, column 10)
    at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:284:16[90m)[39m
    at handleError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:323:12[90m)[39m
    at Module.getNilaiByKelas [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\nilai.api.ts:160:22[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\nilai.api.test.ts:254:7
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
  code: [32m'INTERNAL_ERROR'[39m,
  statusCode: [33m500[39m,
  details: {
    hint: [1mnull[22m,
    details: [32m`unexpected '(' expecting letter, digit, "-", "->>", "->", delimiter (.), "," or end of input`[39m
  },
  timestamp: [32m'2026-01-14T05:57:46.486Z'[39m
}

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mqueryWithFilters[2m > [22m[2mshould apply multiple filters
[22m[39mðŸ”´ API Error (queryWithFilters:test_table)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mqueryWithFilters[2m > [22m[2mshould apply multiple filters
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstderr[2m | server/src/__tests__/unit/api/nilai.api.test.ts[2m > [22m[2mNilai API - CRUD Operations[2m > [22m[2mgetNilaiByMahasiswa[2m > [22m[2mshould get all nilai for a mahasiswa
[22m[39mgetNilaiByMahasiswa error: ValidationError: Invalid data format
    at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:282:16[90m)[39m
    at handleError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:323:12[90m)[39m
    at Module.getNilaiByMahasiswa [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\nilai.api.ts:198:22[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\nilai.api.test.ts:264:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
  code: [32m'VALIDATION_ERROR'[39m,
  statusCode: [33m400[39m,
  details: { hint: [1mnull[22m, details: [1mnull[22m },
  timestamp: [32m'2026-01-14T05:57:46.552Z'[39m
}

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mqueryWithFilters[2m > [22m[2mshould apply all filter operators
[22m[39mðŸ”´ API Error (queryWithFilters:test_table)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mqueryWithFilters[2m > [22m[2mshould apply all filter operators
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstderr[2m | server/src/__tests__/unit/api/nilai.api.test.ts[2m > [22m[2mNilai API - CRUD Operations[2m > [22m[2mgetNilaiByMahasiswa[2m > [22m[2mshould return empty array when no nilai found
[22m[39mgetNilaiByMahasiswa error: ValidationError: Invalid data format
    at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:282:16[90m)[39m
    at handleError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:323:12[90m)[39m
    at Module.getNilaiByMahasiswa [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\nilai.api.ts:198:22[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\nilai.api.test.ts:279:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
  code: [32m'VALIDATION_ERROR'[39m,
  statusCode: [33m400[39m,
  details: { hint: [1mnull[22m, details: [1mnull[22m },
  timestamp: [32m'2026-01-14T05:57:46.626Z'[39m
}

[90mstderr[2m | server/src/__tests__/unit/api/nilai.api.test.ts[2m > [22m[2mNilai API - CRUD Operations[2m > [22m[2mgetNilaiById[2m > [22m[2mshould throw error when nilai not found
[22m[39mgetNilaiById error: Error: Not found
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\nilai.api.test.ts:302:52
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mgetById[2m > [22m[2mshould fetch single record by ID
[22m[39mðŸ”´ API Error (getById:test_table:1)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mgetById[2m > [22m[2mshould fetch single record by ID
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstderr[2m | server/src/__tests__/unit/api/nilai.api.test.ts[2m > [22m[2mNilai API - Statistics[2m > [22m[2mgetNilaiSummary[2m > [22m[2mshould calculate summary statistics correctly
[22m[39mgetNilaiSummary error: BaseApiError: An unknown error occurred
    at handleError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:339:10[90m)[39m
    at Module.getNilaiSummary [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\nilai.api.ts:538:27[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\nilai.api.test.ts:337:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
  code: [32m'UNKNOWN'[39m,
  statusCode: [90mundefined[39m,
  details: { originalError: [32m'[object Object]'[39m },
  timestamp: [32m'2026-01-14T05:57:46.737Z'[39m
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mgetKehadiranStats[2m > [22m[2mshould calculate stats correctly with all statuses
[22m[39mFailed to fetch kehadiran stats {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m,
    hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
    message: [32m"Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache"[39m
  }
}

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mgetById[2m > [22m[2mshould throw NotFoundError when record not found
[22m[39mðŸ”´ API Error (getById:test_table:nonexistent)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mgetById[2m > [22m[2mshould throw NotFoundError when record not found
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mgetKehadiranStats[2m > [22m[2mshould return zero stats when no records
[22m[39mFailed to fetch kehadiran stats {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m,
    hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
    message: [32m"Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mgetKehadiranStats[2m > [22m[2mshould calculate 100% when all hadir
[22m[39mFailed to fetch kehadiran stats {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m,
    hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
    message: [32m"Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/nilai.api.test.ts[2m > [22m[2mNilai API - Statistics[2m > [22m[2mgetNilaiSummary[2m > [22m[2mshould handle empty nilai data
[22m[39mgetNilaiSummary error: BaseApiError: An unknown error occurred
    at handleError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:339:10[90m)[39m
    at Module.getNilaiSummary [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\nilai.api.ts:538:27[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\nilai.api.test.ts:360:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
  code: [32m'UNKNOWN'[39m,
  statusCode: [90mundefined[39m,
  details: { originalError: [32m'[object Object]'[39m },
  timestamp: [32m'2026-01-14T05:57:46.931Z'[39m
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mgetKehadiranStats[2m > [22m[2mshould calculate 0% when all alpha
[22m[39mFailed to fetch kehadiran stats {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m,
    hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
    message: [32m"Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mgetKehadiranStats[2m > [22m[2mshould handle errors gracefully
[22m[39mFailed to fetch kehadiran stats {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m,
    hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
    message: [32m"Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mgetKehadiranStats[2m > [22m[2mshould round persentase to nearest integer
[22m[39mFailed to fetch kehadiran stats {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m,
    hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
    message: [32m"Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/nilai.api.test.ts[2m > [22m[2mNilai API - Statistics[2m > [22m[2mgetNilaiSummary[2m > [22m[2mshould filter out null nilai_akhir when calculating average
[22m[39mgetNilaiSummary error: BaseApiError: An unknown error occurred
    at handleError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:339:10[90m)[39m
    at Module.getNilaiSummary [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\nilai.api.ts:538:27[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\nilai.api.test.ts:392:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
  code: [32m'UNKNOWN'[39m,
  statusCode: [90mundefined[39m,
  details: { originalError: [32m'[object Object]'[39m },
  timestamp: [32m'2026-01-14T05:57:47.086Z'[39m
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mcalculateNilaiKehadiran[2m > [22m[2mshould calculate nilai with hadir only (100)
[22m[39mFailed to fetch kehadiran stats {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m,
    hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
    message: [32m"Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mcalculateNilaiKehadiran[2m > [22m[2mshould calculate nilai with hadir only (100)
[22m[39mFailed to calculate nilai kehadiran {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: ServerError: Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache
      at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:284:16[90m)[39m
      at getKehadiranStats [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:348:11[90m)[39m
  [90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
      at Module.calculateNilaiKehadiran [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:360:19[90m)[39m
      at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\kehadiran.api.test.ts:372:21
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
    code: [32m'INTERNAL_ERROR'[39m,
    statusCode: [33m500[39m,
    details: {
      hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
      details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m
    },
    timestamp: [32m'2026-01-14T05:57:47.146Z'[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mcalculateNilaiKehadiran[2m > [22m[2mshould calculate nilai with mixed statuses
[22m[39mFailed to fetch kehadiran stats {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m,
    hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
    message: [32m"Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mcalculateNilaiKehadiran[2m > [22m[2mshould calculate nilai with mixed statuses
[22m[39mFailed to calculate nilai kehadiran {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: ServerError: Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache
      at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:284:16[90m)[39m
      at getKehadiranStats [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:348:11[90m)[39m
  [90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
      at Module.calculateNilaiKehadiran [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:360:19[90m)[39m
      at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\kehadiran.api.test.ts:397:21
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
    code: [32m'INTERNAL_ERROR'[39m,
    statusCode: [33m500[39m,
    details: {
      hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
      details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m
    },
    timestamp: [32m'2026-01-14T05:57:47.214Z'[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/nilai.api.test.ts[2m > [22m[2mNilai API - Statistics[2m > [22m[2mgetNilaiSummary[2m > [22m[2mshould round average to 2 decimal places
[22m[39mgetNilaiSummary error: BaseApiError: An unknown error occurred
    at handleError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:339:10[90m)[39m
    at Module.getNilaiSummary [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\nilai.api.ts:538:27[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\nilai.api.test.ts:414:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
  code: [32m'UNKNOWN'[39m,
  statusCode: [90mundefined[39m,
  details: { originalError: [32m'[object Object]'[39m },
  timestamp: [32m'2026-01-14T05:57:47.241Z'[39m
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mcalculateNilaiKehadiran[2m > [22m[2mshould give 0 nilai for all alpha
[22m[39mFailed to fetch kehadiran stats {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m,
    hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
    message: [32m"Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mcalculateNilaiKehadiran[2m > [22m[2mshould give 0 nilai for all alpha
[22m[39mFailed to calculate nilai kehadiran {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: ServerError: Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache
      at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:284:16[90m)[39m
      at getKehadiranStats [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:348:11[90m)[39m
  [90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
      at Module.calculateNilaiKehadiran [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:360:19[90m)[39m
      at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\kehadiran.api.test.ts:416:21
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
    code: [32m'INTERNAL_ERROR'[39m,
    statusCode: [33m500[39m,
    details: {
      hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
      details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m
    },
    timestamp: [32m'2026-01-14T05:57:47.278Z'[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mcalculateNilaiKehadiran[2m > [22m[2mshould return 0 when no records
[22m[39mFailed to fetch kehadiran stats {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m,
    hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
    message: [32m"Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mcalculateNilaiKehadiran[2m > [22m[2mshould return 0 when no records
[22m[39mFailed to calculate nilai kehadiran {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: ServerError: Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache
      at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:284:16[90m)[39m
      at getKehadiranStats [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:348:11[90m)[39m
  [90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
      at Module.calculateNilaiKehadiran [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:360:19[90m)[39m
      at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\kehadiran.api.test.ts:433:21
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
    code: [32m'INTERNAL_ERROR'[39m,
    statusCode: [33m500[39m,
    details: {
      hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
      details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m
    },
    timestamp: [32m'2026-01-14T05:57:47.341Z'[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/nilai.api.test.ts[2m > [22m[2mNilai API - Statistics[2m > [22m[2mgetMahasiswaForGrading[2m > [22m[2mshould return mahasiswa with their nilai
[22m[39mgetMahasiswaForGrading error: ValidationError: Invalid data format
    at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:282:16[90m)[39m
    at handleError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:323:12[90m)[39m
    at Module.getMahasiswaForGrading [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\nilai.api.ts:597:28[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\nilai.api.test.ts:455:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
  code: [32m'VALIDATION_ERROR'[39m,
  statusCode: [33m400[39m,
  details: { hint: [1mnull[22m, details: [1mnull[22m },
  timestamp: [32m'2026-01-14T05:57:47.396Z'[39m
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mcalculateNilaiKehadiran[2m > [22m[2mshould cap nilai at 100
[22m[39mFailed to fetch kehadiran stats {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m,
    hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
    message: [32m"Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mcalculateNilaiKehadiran[2m > [22m[2mshould cap nilai at 100
[22m[39mFailed to calculate nilai kehadiran {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: ServerError: Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache
      at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:284:16[90m)[39m
      at getKehadiranStats [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:348:11[90m)[39m
  [90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
      at Module.calculateNilaiKehadiran [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:360:19[90m)[39m
      at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\kehadiran.api.test.ts:453:21
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
    code: [32m'INTERNAL_ERROR'[39m,
    statusCode: [33m500[39m,
    details: {
      hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
      details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m
    },
    timestamp: [32m'2026-01-14T05:57:47.403Z'[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mcalculateNilaiKehadiran[2m > [22m[2mshould return 0 on error
[22m[39mFailed to fetch kehadiran stats {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m,
    hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
    message: [32m"Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/nilai.api.test.ts[2m > [22m[2mNilai API - Statistics[2m > [22m[2mgetMahasiswaForGrading[2m > [22m[2mshould return mahasiswa with default nilai when not graded yet
[22m[39mgetMahasiswaForGrading error: ValidationError: Invalid data format
    at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:282:16[90m)[39m
    at handleError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:323:12[90m)[39m
    at Module.getMahasiswaForGrading [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\nilai.api.ts:597:28[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\nilai.api.test.ts:491:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
  code: [32m'VALIDATION_ERROR'[39m,
  statusCode: [33m400[39m,
  details: { hint: [1mnull[22m, details: [1mnull[22m },
  timestamp: [32m'2026-01-14T05:57:47.465Z'[39m
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mcalculateNilaiKehadiran[2m > [22m[2mshould return 0 on error
[22m[39mFailed to calculate nilai kehadiran {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: ServerError: Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache
      at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:284:16[90m)[39m
      at getKehadiranStats [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:348:11[90m)[39m
  [90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
      at Module.calculateNilaiKehadiran [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:360:19[90m)[39m
      at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\kehadiran.api.test.ts:472:21
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
    code: [32m'INTERNAL_ERROR'[39m,
    statusCode: [33m500[39m,
    details: {
      hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
      details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m
    },
    timestamp: [32m'2026-01-14T05:57:47.466Z'[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mcalculateNilaiKehadiran[2m > [22m[2mshould round nilai to nearest integer
[22m[39mFailed to fetch kehadiran stats {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m,
    hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
    message: [32m"Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/nilai.api.test.ts[2m > [22m[2mNilai API - Statistics[2m > [22m[2mgetMahasiswaForGrading[2m > [22m[2mshould return empty array when no mahasiswa enrolled
[22m[39mgetMahasiswaForGrading error: ValidationError: Invalid data format
    at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:282:16[90m)[39m
    at handleError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:323:12[90m)[39m
    at Module.getMahasiswaForGrading [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\nilai.api.ts:597:28[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\nilai.api.test.ts:507:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
  code: [32m'VALIDATION_ERROR'[39m,
  statusCode: [33m400[39m,
  details: { hint: [1mnull[22m, details: [1mnull[22m },
  timestamp: [32m'2026-01-14T05:57:47.531Z'[39m
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mcalculateNilaiKehadiran[2m > [22m[2mshould round nilai to nearest integer
[22m[39mFailed to calculate nilai kehadiran {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: ServerError: Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache
      at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:284:16[90m)[39m
      at getKehadiranStats [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:348:11[90m)[39m
  [90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
      at Module.calculateNilaiKehadiran [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:360:19[90m)[39m
      at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\kehadiran.api.test.ts:496:21
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
    code: [32m'INTERNAL_ERROR'[39m,
    statusCode: [33m500[39m,
    details: {
      hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
      details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m
    },
    timestamp: [32m'2026-01-14T05:57:47.531Z'[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/nilai.api.test.ts[2m > [22m[2mNilai API - Statistics[2m > [22m[2mgetMahasiswaForGrading[2m > [22m[2mshould handle multiple mahasiswa with mixed nilai status
[22m[39mgetMahasiswaForGrading error: ValidationError: Invalid data format
    at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:282:16[90m)[39m
    at handleError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:323:12[90m)[39m
    at Module.getMahasiswaForGrading [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\nilai.api.ts:597:28[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\nilai.api.test.ts:552:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
  code: [32m'VALIDATION_ERROR'[39m,
  statusCode: [33m400[39m,
  details: { hint: [1mnull[22m, details: [1mnull[22m },
  timestamp: [32m'2026-01-14T05:57:47.594Z'[39m
}

 [31mâ¯[39m server/src/__tests__/unit/api/nilai.api.test.ts [2m([22m[2m20 tests[22m[2m | [22m[31m12 failed[39m[2m)[22m[33m 1683[2mms[22m[39m
   [32mâœ“[39m Nilai API - CRUD Operations[2m > [22mgetNilai[2m > [22mshould get all nilai without filters[32m 9[2mms[22m[39m
   [32mâœ“[39m Nilai API - CRUD Operations[2m > [22mgetNilai[2m > [22mshould get nilai with kelas_id filter[32m 2[2mms[22m[39m
   [32mâœ“[39m Nilai API - CRUD Operations[2m > [22mgetNilai[2m > [22mshould get nilai with mahasiswa_id filter[32m 1[2mms[22m[39m
   [32mâœ“[39m Nilai API - CRUD Operations[2m > [22mgetNilai[2m > [22mshould get nilai with nilai_akhir range filters[32m 1[2mms[22m[39m
   [32mâœ“[39m Nilai API - CRUD Operations[2m > [22mgetNilai[2m > [22mshould get nilai with all filters combined[32m 2[2mms[22m[39m
[31m   [31mÃ—[31m Nilai API - CRUD Operations[2m > [22mgetNilaiByKelas[2m > [22mshould get all nilai for a kelas[39m[33m 410[2mms[22m[39m
[31m     â†’ "failed to parse order (mahasiswa(user(full_name)).asc)" (line 1, column 10)[39m
[31m   [31mÃ—[31m Nilai API - CRUD Operations[2m > [22mgetNilaiByKelas[2m > [22mshould return empty array when no nilai found[39m[32m 81[2mms[22m[39m
[31m     â†’ "failed to parse order (mahasiswa(user(full_name)).asc)" (line 1, column 10)[39m
   [32mâœ“[39m Nilai API - CRUD Operations[2m > [22mgetNilaiByKelas[2m > [22mshould throw error on database error[32m 64[2mms[22m[39m
[31m   [31mÃ—[31m Nilai API - CRUD Operations[2m > [22mgetNilaiByMahasiswa[2m > [22mshould get all nilai for a mahasiswa[39m[32m 65[2mms[22m[39m
[31m     â†’ Invalid data format[39m
[31m   [31mÃ—[31m Nilai API - CRUD Operations[2m > [22mgetNilaiByMahasiswa[2m > [22mshould return empty array when no nilai found[39m[32m 73[2mms[22m[39m
[31m     â†’ Invalid data format[39m
   [32mâœ“[39m Nilai API - CRUD Operations[2m > [22mgetNilaiById[2m > [22mshould get nilai by ID[32m 1[2mms[22m[39m
   [32mâœ“[39m Nilai API - CRUD Operations[2m > [22mgetNilaiById[2m > [22mshould throw error when nilai not found[32m 3[2mms[22m[39m
[31m   [31mÃ—[31m Nilai API - Statistics[2m > [22mgetNilaiSummary[2m > [22mshould calculate summary statistics correctly[39m[32m 107[2mms[22m[39m
[31m     â†’ An unknown error occurred[39m
[31m   [31mÃ—[31m Nilai API - Statistics[2m > [22mgetNilaiSummary[2m > [22mshould handle empty nilai data[39m[32m 194[2mms[22m[39m
[31m     â†’ An unknown error occurred[39m
[31m   [31mÃ—[31m Nilai API - Statistics[2m > [22mgetNilaiSummary[2m > [22mshould filter out null nilai_akhir when calculating average[39m[32m 156[2mms[22m[39m
[31m     â†’ An unknown error occurred[39m
[31m   [31mÃ—[31m Nilai API - Statistics[2m > [22mgetNilaiSummary[2m > [22mshould round average to 2 decimal places[39m[32m 154[2mms[22m[39m
[31m     â†’ An unknown error occurred[39m
[31m   [31mÃ—[31m Nilai API - Statistics[2m > [22mgetMahasiswaForGrading[2m > [22mshould return mahasiswa with their nilai[39m[32m 155[2mms[22m[39m
[31m     â†’ Invalid data format[39m
[31m   [31mÃ—[31m Nilai API - Statistics[2m > [22mgetMahasiswaForGrading[2m > [22mshould return mahasiswa with default nilai when not graded yet[39m[32m 70[2mms[22m[39m
[31m     â†’ Invalid data format[39m
[31m   [31mÃ—[31m Nilai API - Statistics[2m > [22mgetMahasiswaForGrading[2m > [22mshould return empty array when no mahasiswa enrolled[39m[32m 65[2mms[22m[39m
[31m     â†’ Invalid data format[39m
[31m   [31mÃ—[31m Nilai API - Statistics[2m > [22mgetMahasiswaForGrading[2m > [22mshould handle multiple mahasiswa with mixed nilai status[39m[32m 63[2mms[22m[39m
[31m     â†’ Invalid data format[39m
[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mEdge Cases & Business Logic Validation[2m > [22m[2mshould handle single attendance record correctly
[22m[39mFailed to fetch kehadiran stats {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m,
    hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
    message: [32m"Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mEdge Cases & Business Logic Validation[2m > [22m[2mshould handle single attendance record correctly
[22m[39mFailed to calculate nilai kehadiran {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: ServerError: Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache
      at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:284:16[90m)[39m
      at getKehadiranStats [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:348:11[90m)[39m
  [90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
      at Module.calculateNilaiKehadiran [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:360:19[90m)[39m
      at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\kehadiran.api.test.ts:641:21
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
    code: [32m'INTERNAL_ERROR'[39m,
    statusCode: [33m500[39m,
    details: {
      hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
      details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m
    },
    timestamp: [32m'2026-01-14T05:57:47.957Z'[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mEdge Cases & Business Logic Validation[2m > [22m[2mshould handle all izin correctly (50% nilai)
[22m[39mFailed to fetch kehadiran stats {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m,
    hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
    message: [32m"Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mEdge Cases & Business Logic Validation[2m > [22m[2mshould handle all izin correctly (50% nilai)
[22m[39mFailed to calculate nilai kehadiran {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: ServerError: Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache
      at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:284:16[90m)[39m
      at getKehadiranStats [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:348:11[90m)[39m
  [90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
      at Module.calculateNilaiKehadiran [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:360:19[90m)[39m
      at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\kehadiran.api.test.ts:660:21
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
    code: [32m'INTERNAL_ERROR'[39m,
    statusCode: [33m500[39m,
    details: {
      hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
      details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m
    },
    timestamp: [32m'2026-01-14T05:57:48.021Z'[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mEdge Cases & Business Logic Validation[2m > [22m[2mshould handle all sakit correctly (50% nilai)
[22m[39mFailed to fetch kehadiran stats {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m,
    hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
    message: [32m"Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mEdge Cases & Business Logic Validation[2m > [22m[2mshould handle all sakit correctly (50% nilai)
[22m[39mFailed to calculate nilai kehadiran {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: ServerError: Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache
      at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:284:16[90m)[39m
      at getKehadiranStats [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:348:11[90m)[39m
  [90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
      at Module.calculateNilaiKehadiran [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:360:19[90m)[39m
      at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\kehadiran.api.test.ts:679:21
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
    code: [32m'INTERNAL_ERROR'[39m,
    statusCode: [33m500[39m,
    details: {
      hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
      details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m
    },
    timestamp: [32m'2026-01-14T05:57:48.085Z'[39m
  }
}

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mgetPaginated[2m > [22m[2mshould return paginated results with metadata
[22m[39mðŸ”´ API Error (getPaginated:test_table)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mgetPaginated[2m > [22m[2mshould return paginated results with metadata
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mEdge Cases & Business Logic Validation[2m > [22m[2mshould validate formula with large dataset
[22m[39mFailed to fetch kehadiran stats {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m,
    hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
    message: [32m"Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/kehadiran.api.test.ts[2m > [22m[2mKehadiran API[2m > [22m[2mEdge Cases & Business Logic Validation[2m > [22m[2mshould validate formula with large dataset
[22m[39mFailed to calculate nilai kehadiran {
  mahasiswaId: [32m'323e4567-e89b-12d3-a456-426614174002'[39m,
  kelasId: [32m'423e4567-e89b-12d3-a456-426614174003'[39m,
  error: ServerError: Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache
      at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:284:16[90m)[39m
      at getKehadiranStats [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:348:11[90m)[39m
  [90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
      at Module.calculateNilaiKehadiran [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\kehadiran.api.ts:360:19[90m)[39m
      at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\kehadiran.api.test.ts:705:21
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
    code: [32m'INTERNAL_ERROR'[39m,
    statusCode: [33m500[39m,
    details: {
      hint: [32m"Perhaps you meant 'jadwal_praktikum' instead of 'jadwal'."[39m,
      details: [32m"Searched for a foreign key relationship between 'kehadiran' and 'jadwal' in the schema 'public', but no matches were found."[39m
    },
    timestamp: [32m'2026-01-14T05:57:48.165Z'[39m
  }
}

 [31mâ¯[39m server/src/__tests__/unit/api/kehadiran.api.test.ts [2m([22m[2m30 tests[22m[2m | [22m[31m22 failed[39m[2m)[22m[33m 2522[2mms[22m[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mgetKehadiranByJadwal[2m > [22mshould fetch kehadiran by jadwal_id successfully[39m[33m 406[2mms[22m[39m
[31m     â†’ expected [] to deeply equal [ { â€¦(10) } ][39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mgetKehadiranByJadwal[2m > [22mshould order by mahasiswa NIM ascending[39m[32m 172[2mms[22m[39m
[31m     â†’ expected "spy" to be called with arguments: [ 'mahasiswa(nim)', â€¦(1) ][90m

Number of calls: [1m0[22m
[31m[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mgetKehadiranByJadwal[2m > [22mshould handle errors gracefully[39m[32m 70[2mms[22m[39m
[31m     â†’ promise resolved "[]" instead of rejecting[39m
   [32mâœ“[39m Kehadiran API[2m > [22mgetKehadiranByJadwal[2m > [22mshould return empty array when no data[32m 86[2mms[22m[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mgetKehadiranByKelas[2m > [22mshould fetch kehadiran by kelas_id successfully[39m[32m 74[2mms[22m[39m
[31m     â†’ expected [] to deeply equal [ { â€¦(10) } ][39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mgetKehadiranByKelas[2m > [22mshould apply date range filters when provided[39m[32m 72[2mms[22m[39m
[31m     â†’ expected "spy" to be called with arguments: [ 'jadwal.tanggal_praktikum', â€¦(1) ][90m

Number of calls: [1m0[22m
[31m[39m
   [32mâœ“[39m Kehadiran API[2m > [22mgetKehadiranByKelas[2m > [22mshould work without date filters[32m 70[2mms[22m[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mgetKehadiranByKelas[2m > [22mshould handle errors gracefully[39m[32m 64[2mms[22m[39m
[31m     â†’ promise resolved "[]" instead of rejecting[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mgetKehadiranStats[2m > [22mshould calculate stats correctly with all statuses[39m[32m 79[2mms[22m[39m
[31m     â†’ Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mgetKehadiranStats[2m > [22mshould return zero stats when no records[39m[32m 66[2mms[22m[39m
[31m     â†’ Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mgetKehadiranStats[2m > [22mshould calculate 100% when all hadir[39m[32m 72[2mms[22m[39m
[31m     â†’ Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mgetKehadiranStats[2m > [22mshould calculate 0% when all alpha[39m[32m 66[2mms[22m[39m
[31m     â†’ Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache[39m
   [32mâœ“[39m Kehadiran API[2m > [22mgetKehadiranStats[2m > [22mshould handle errors gracefully[32m 67[2mms[22m[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mgetKehadiranStats[2m > [22mshould round persentase to nearest integer[39m[32m 68[2mms[22m[39m
[31m     â†’ Could not find a relationship between 'kehadiran' and 'jadwal' in the schema cache[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mcalculateNilaiKehadiran[2m > [22mshould calculate nilai with hadir only (100)[39m[32m 66[2mms[22m[39m
[31m     â†’ expected +0 to be 100 // Object.is equality[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mcalculateNilaiKehadiran[2m > [22mshould calculate nilai with mixed statuses[39m[32m 67[2mms[22m[39m
[31m     â†’ expected +0 to be 75 // Object.is equality[39m
   [32mâœ“[39m Kehadiran API[2m > [22mcalculateNilaiKehadiran[2m > [22mshould give 0 nilai for all alpha[32m 64[2mms[22m[39m
   [32mâœ“[39m Kehadiran API[2m > [22mcalculateNilaiKehadiran[2m > [22mshould return 0 when no records[32m 62[2mms[22m[39m
   [32mâœ“[39m Kehadiran API[2m > [22mcalculateNilaiKehadiran[2m > [22mshould cap nilai at 100[32m 62[2mms[22m[39m
   [32mâœ“[39m Kehadiran API[2m > [22mcalculateNilaiKehadiran[2m > [22mshould return 0 on error[32m 63[2mms[22m[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mcalculateNilaiKehadiran[2m > [22mshould round nilai to nearest integer[39m[32m 66[2mms[22m[39m
[31m     â†’ expected +0 to be 83 // Object.is equality[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mgetMahasiswaKehadiran[2m > [22mshould fetch mahasiswa kehadiran records successfully[39m[32m 67[2mms[22m[39m
[31m     â†’ expected [] to deeply equal [ { â€¦(5) } ][39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mgetMahasiswaKehadiran[2m > [22mshould limit results to 100[39m[32m 63[2mms[22m[39m
[31m     â†’ expected "spy" to be called with arguments: [ 100 ][90m

Number of calls: [1m0[22m
[31m[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mgetMahasiswaKehadiran[2m > [22mshould order by tanggal descending[39m[32m 70[2mms[22m[39m
[31m     â†’ expected "spy" to be called with arguments: [ 'jadwal(tanggal_praktikum)', â€¦(1) ][90m

Number of calls: [1m0[22m
[31m[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mgetMahasiswaKehadiran[2m > [22mshould handle errors gracefully[39m[32m 68[2mms[22m[39m
[31m     â†’ promise resolved "[]" instead of rejecting[39m
   [32mâœ“[39m Kehadiran API[2m > [22mgetMahasiswaKehadiran[2m > [22mshould return empty array when no data[32m 72[2mms[22m[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mEdge Cases & Business Logic Validation[2m > [22mshould handle single attendance record correctly[39m[32m 85[2mms[22m[39m
[31m     â†’ expected +0 to be 100 // Object.is equality[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mEdge Cases & Business Logic Validation[2m > [22mshould handle all izin correctly (50% nilai)[39m[32m 64[2mms[22m[39m
[31m     â†’ expected +0 to be 50 // Object.is equality[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mEdge Cases & Business Logic Validation[2m > [22mshould handle all sakit correctly (50% nilai)[39m[32m 64[2mms[22m[39m
[31m     â†’ expected +0 to be 50 // Object.is equality[39m
[31m   [31mÃ—[31m Kehadiran API[2m > [22mEdge Cases & Business Logic Validation[2m > [22mshould validate formula with large dataset[39m[32m 80[2mms[22m[39m
[31m     â†’ expected +0 to be 82 // Object.is equality[39m
[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mgetPaginated[2m > [22m[2mshould calculate correct pagination for last page
[22m[39mðŸ”´ API Error (getPaginated:test_table)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mgetPaginated[2m > [22m[2mshould calculate correct pagination for last page
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mgetPaginated[2m > [22m[2mshould apply sorting
[22m[39mðŸ”´ API Error (getPaginated:test_table)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Query Functions[2m > [22m[2mgetPaginated[2m > [22m[2mshould apply sorting
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2minsert[2m > [22m[2mshould insert single record
[22m[39mðŸ” DEBUG: insert called with table: test_table data: { name: [32m'New Item'[39m }

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2minsert[2m > [22m[2mshould insert single record
[22m[39mâŒ DEBUG: insert error: {
  code: [32m'PGRST205'[39m,
  details: [1mnull[22m,
  hint: [1mnull[22m,
  message: [32m"Could not find the table 'public.test_table' in the schema cache"[39m
}
âŒ DEBUG: insert catch error: ServerError: Could not find the table 'public.test_table' in the schema cache
    at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:284:16[90m)[39m
    at handleError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:323:12[90m)[39m
    at Module.insert [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\base.api.ts:375:13[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\base.api.test.ts:368:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
  code: [32m'INTERNAL_ERROR'[39m,
  statusCode: [33m500[39m,
  details: { hint: [1mnull[22m, details: [1mnull[22m },
  timestamp: [32m'2026-01-14T05:57:48.708Z'[39m
}
  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2minsert[2m > [22m[2mshould insert single record
[22m[39mðŸ” DEBUG: insert result: {
  result: [1mnull[22m,
  error: {
    code: [32m'PGRST205'[39m,
    details: [1mnull[22m,
    hint: [1mnull[22m,
    message: [32m"Could not find the table 'public.test_table' in the schema cache"[39m
  }
}
ðŸ”´ API Error (insert:test_table)

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2minsert[2m > [22m[2mshould throw error when insert fails
[22m[39mðŸ” DEBUG: insert called with table: test_table data: { name: [32m'New Item'[39m }

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2minsert[2m > [22m[2mshould throw error when insert fails
[22m[39mâŒ DEBUG: insert error: {
  code: [32m'PGRST205'[39m,
  details: [1mnull[22m,
  hint: [1mnull[22m,
  message: [32m"Could not find the table 'public.test_table' in the schema cache"[39m
}
âŒ DEBUG: insert catch error: ServerError: Could not find the table 'public.test_table' in the schema cache
    at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:284:16[90m)[39m
    at handleError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:323:12[90m)[39m
    at Module.insert [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\base.api.ts:375:13[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\base.api.test.ts:383:7
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
  code: [32m'INTERNAL_ERROR'[39m,
  statusCode: [33m500[39m,
  details: { hint: [1mnull[22m, details: [1mnull[22m },
  timestamp: [32m'2026-01-14T05:57:48.777Z'[39m
}
  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2minsert[2m > [22m[2mshould throw error when insert fails
[22m[39mðŸ” DEBUG: insert result: {
  result: [1mnull[22m,
  error: {
    code: [32m'PGRST205'[39m,
    details: [1mnull[22m,
    hint: [1mnull[22m,
    message: [32m"Could not find the table 'public.test_table' in the schema cache"[39m
  }
}
ðŸ”´ API Error (insert:test_table)

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2minsertMany[2m > [22m[2mshould insert multiple records
[22m[39mðŸ”´ API Error (insertMany:test_table)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2minsertMany[2m > [22m[2mshould insert multiple records
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2mupdate[2m > [22m[2mshould update record by ID
[22m[39mðŸ”´ API Error (update:test_table:1)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2mupdate[2m > [22m[2mshould update record by ID
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2mupdate[2m > [22m[2mshould throw NotFoundError when record not found
[22m[39mðŸ”´ API Error (update:test_table:nonexistent)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2mupdate[2m > [22m[2mshould throw NotFoundError when record not found
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2mupdateMany[2m > [22m[2mshould update multiple records with filters
[22m[39mðŸ”´ API Error (updateMany:test_table)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2mupdateMany[2m > [22m[2mshould update multiple records with filters
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2mremove[2m > [22m[2mshould delete record by ID
[22m[39mðŸ—‘ï¸ Deleting from test_table where id = 1
ðŸ”§ Using hard delete for test_table

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2mremove[2m > [22m[2mshould delete record by ID
[22m[39mâŒ Delete failed for test_table:1: {
  code: [32m'PGRST205'[39m,
  details: [1mnull[22m,
  hint: [1mnull[22m,
  message: [32m"Could not find the table 'public.test_table' in the schema cache"[39m
}
  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2mremove[2m > [22m[2mshould delete record by ID
[22m[39mðŸ“Š Hard delete result: error=true, count=null
ðŸ”´ API Error (remove:test_table:1)

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2mremoveMany[2m > [22m[2mshould delete multiple records with filters
[22m[39mðŸ”´ API Error (removeMany:test_table)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - CRUD Operations[2m > [22m[2mremoveMany[2m > [22m[2mshould delete multiple records with filters
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Utility Functions[2m > [22m[2mexists[2m > [22m[2mshould return true when record exists
[22m[39mðŸ”´ API Error (exists:test_table:1)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Utility Functions[2m > [22m[2mexists[2m > [22m[2mshould return true when record exists
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Utility Functions[2m > [22m[2mexists[2m > [22m[2mshould return false when record does not exist
[22m[39mðŸ”´ API Error (exists:test_table:nonexistent)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Utility Functions[2m > [22m[2mexists[2m > [22m[2mshould return false when record does not exist
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Utility Functions[2m > [22m[2mexists[2m > [22m[2mshould return false on error
[22m[39mðŸ”´ API Error (exists:test_table:1)

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Utility Functions[2m > [22m[2mexists[2m > [22m[2mshould return false on error
[22m[39m  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Integration[2m > [22m[2mshould handle complete CRUD workflow
[22m[39mðŸ” DEBUG: insert called with table: test_table data: { name: [32m'Test'[39m }

[90mstderr[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Integration[2m > [22m[2mshould handle complete CRUD workflow
[22m[39mâŒ DEBUG: insert error: {
  code: [32m'PGRST205'[39m,
  details: [1mnull[22m,
  hint: [1mnull[22m,
  message: [32m"Could not find the table 'public.test_table' in the schema cache"[39m
}
âŒ DEBUG: insert catch error: ServerError: Could not find the table 'public.test_table' in the schema cache
    at handleSupabaseError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:284:16[90m)[39m
    at handleError [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\utils\errors.ts:323:12[90m)[39m
    at Module.insert [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\api\base.api.ts:375:13[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\base.api.test.ts:619:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20 {
  code: [32m'INTERNAL_ERROR'[39m,
  statusCode: [33m500[39m,
  details: { hint: [1mnull[22m, details: [1mnull[22m },
  timestamp: [32m'2026-01-14T05:57:49.859Z'[39m
}
  Message: Could not find the table 'public.test_table' in the schema cache
  Code: INTERNAL_ERROR
  Status: [33m500[39m
  Details: { hint: [1mnull[22m, details: [1mnull[22m }

[90mstdout[2m | server/src/__tests__/unit/api/base.api.test.ts[2m > [22m[2mBase API - Integration[2m > [22m[2mshould handle complete CRUD workflow
[22m[39mðŸ” DEBUG: insert result: {
  result: [1mnull[22m,
  error: {
    code: [32m'PGRST205'[39m,
    details: [1mnull[22m,
    hint: [1mnull[22m,
    message: [32m"Could not find the table 'public.test_table' in the schema cache"[39m
  }
}
ðŸ”´ API Error (insert:test_table)

 [31mâ¯[39m server/src/__tests__/unit/api/base.api.test.ts [2m([22m[2m32 tests[22m[2m | [22m[31m26 failed[39m[2m)[22m[33m 4495[2mms[22m[39m
[31m   [31mÃ—[31m Base API - Query Functions[2m > [22mquery[2m > [22mshould fetch all records from a table[39m[33m 638[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - Query Functions[2m > [22mquery[2m > [22mshould apply select option[39m[32m 88[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - Query Functions[2m > [22mquery[2m > [22mshould apply order option[39m[32m 96[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - Query Functions[2m > [22mquery[2m > [22mshould apply limit option[39m[32m 67[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - Query Functions[2m > [22mquery[2m > [22mshould apply offset with range[39m[32m 70[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - Query Functions[2m > [22mquery[2m > [22mshould throw NotFoundError when throwOnEmpty is true and no data[39m[32m 77[2mms[22m[39m
[31m     â†’ expected [Function] to throw error including 'No records found' but got 'Could not find the table \'public.tesâ€¦'[39m
   [32mâœ“[39m Base API - Query Functions[2m > [22mquery[2m > [22mshould return empty array when offline[32m 2[2mms[22m[39m
[31m   [31mÃ—[31m Base API - Query Functions[2m > [22mqueryWithFilters[2m > [22mshould apply eq filter[39m[32m 60[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - Query Functions[2m > [22mqueryWithFilters[2m > [22mshould apply multiple filters[39m[32m 66[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - Query Functions[2m > [22mqueryWithFilters[2m > [22mshould apply all filter operators[39m[32m 82[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - Query Functions[2m > [22mgetById[2m > [22mshould fetch single record by ID[39m[32m 93[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - Query Functions[2m > [22mgetById[2m > [22mshould throw NotFoundError when record not found[39m[32m 67[2mms[22m[39m
[31m     â†’ expected error to be instance of NotFoundError[39m
[31m   [31mÃ—[31m Base API - Query Functions[2m > [22mgetPaginated[2m > [22mshould return paginated results with metadata[39m[33m 1356[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - Query Functions[2m > [22mgetPaginated[2m > [22mshould calculate correct pagination for last page[39m[32m 216[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - Query Functions[2m > [22mgetPaginated[2m > [22mshould apply sorting[39m[32m 212[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - CRUD Operations[2m > [22minsert[2m > [22mshould insert single record[39m[32m 149[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - CRUD Operations[2m > [22minsert[2m > [22mshould throw error when insert fails[39m[32m 70[2mms[22m[39m
[31m     â†’ expected [Function] to throw error including 'Insert failed' but got 'Could not find the table \'public.tesâ€¦'[39m
[31m   [31mÃ—[31m Base API - CRUD Operations[2m > [22minsertMany[2m > [22mshould insert multiple records[39m[32m 72[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - CRUD Operations[2m > [22mupdate[2m > [22mshould update record by ID[39m[32m 66[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - CRUD Operations[2m > [22mupdate[2m > [22mshould throw NotFoundError when record not found[39m[32m 61[2mms[22m[39m
[31m     â†’ expected error to be instance of NotFoundError[39m
[31m   [31mÃ—[31m Base API - CRUD Operations[2m > [22mupdateMany[2m > [22mshould update multiple records with filters[39m[32m 70[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - CRUD Operations[2m > [22mremove[2m > [22mshould delete record by ID[39m[32m 65[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - CRUD Operations[2m > [22mremoveMany[2m > [22mshould delete multiple records with filters[39m[32m 60[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[31m   [31mÃ—[31m Base API - Utility Functions[2m > [22mexists[2m > [22mshould return true when record exists[39m[32m 69[2mms[22m[39m
[31m     â†’ expected false to be true // Object.is equality[39m
   [32mâœ“[39m Base API - Utility Functions[2m > [22mexists[2m > [22mshould return false when record does not exist[32m 72[2mms[22m[39m
   [32mâœ“[39m Base API - Utility Functions[2m > [22mexists[2m > [22mshould return false on error[32m 63[2mms[22m[39m
[31m   [31mÃ—[31m Base API - Utility Functions[2m > [22mcount[2m > [22mshould count all records[39m[32m 66[2mms[22m[39m
[31m     â†’ expected +0 to be 42 // Object.is equality[39m
[31m   [31mÃ—[31m Base API - Utility Functions[2m > [22mcount[2m > [22mshould count records with filters[39m[32m 113[2mms[22m[39m
[31m     â†’ expected +0 to be 10 // Object.is equality[39m
   [32mâœ“[39m Base API - Utility Functions[2m > [22mcount[2m > [22mshould return 0 when count is null[32m 146[2mms[22m[39m
   [32mâœ“[39m Base API - Utility Functions[2m > [22mwithApiResponse[2m > [22mshould wrap successful response[32m 2[2mms[22m[39m
   [32mâœ“[39m Base API - Utility Functions[2m > [22mwithApiResponse[2m > [22mshould wrap error response[32m 2[2mms[22m[39m
[31m   [31mÃ—[31m Base API - Integration[2m > [22mshould handle complete CRUD workflow[39m[32m 153[2mms[22m[39m
[31m     â†’ Could not find the table 'public.test_table' in the schema cache[39m
[90mstdout[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Dashboard Stats[2m > [22m[2mgetDosenStats[2m > [22m[2mshould return stats for authenticated dosen
[22m[39mðŸ”„ Upgrading IndexedDB from v0 to v2
âœ… Created store: kuis
âœ… Created store: kuis_soal
âœ… Created store: kuis_jawaban
âœ… Created store: nilai
âœ… Created store: materi
âœ… Created store: kelas
âœ… Created store: users
âœ… Created store: sync_queue
âœ… Created store: metadata
âœ… Created store: offline_quiz
âœ… Created store: offline_questions
âœ… Created store: offline_answers
âœ… Created store: offline_attempts

[90mstdout[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Dashboard Stats[2m > [22m[2mgetDosenStats[2m > [22m[2mshould return stats for authenticated dosen
[22m[39mâœ… IndexedDB initialized successfully

[90mstdout[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Dashboard Stats[2m > [22m[2mgetDosenStats[2m > [22m[2mshould return stats for authenticated dosen
[22m[39m[API Cache] MISS: dosen_stats (fetching...)

[90mstdout[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Dashboard Stats[2m > [22m[2mgetDosenStats[2m > [22m[2mshould return stats for authenticated dosen
[22m[39mðŸ” DEBUG getDosenId: user = [90mundefined[39m
âŒ DEBUG: No authenticated user

[90mstdout[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Dashboard Stats[2m > [22m[2mgetDosenStats[2m > [22m[2mshould return stats for authenticated dosen
[22m[39m[API Cache] Cached: dosen_stats (TTL: 300000ms)

[90mstdout[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Dashboard Stats[2m > [22m[2mgetDosenStats[2m > [22m[2mshould return zero stats when no dosen found
[22m[39m[API Cache] HIT: dosen_stats

[90mstdout[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Dashboard Stats[2m > [22m[2mgetDosenStats[2m > [22m[2mshould handle errors gracefully
[22m[39m[API Cache] HIT: dosen_stats

[90mstdout[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Dashboard Stats[2m > [22m[2mgetDosenStats[2m > [22m[2mshould use cached dosen ID on subsequent calls
[22m[39m[API Cache] HIT: dosen_stats

[90mstdout[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould return kelas with stats for dosen
[22m[39mðŸ” DEBUG getMyKelas: Getting ALL available kelas

[90mstdout[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould return kelas with stats for dosen
[22m[39mâš ï¸ DEBUG: No kelas found in database

[90mstdout[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould apply limit when provided
[22m[39mðŸ” DEBUG getMyKelas: Getting ALL available kelas

[90mstdout[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould apply limit when provided
[22m[39mâš ï¸ DEBUG: No kelas found in database

[90mstdout[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould return empty array when no dosen ID
[22m[39mðŸ” DEBUG getMyKelas: Getting ALL available kelas

[90mstdout[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould return empty array when no dosen ID
[22m[39mâš ï¸ DEBUG: No kelas found in database

[90mstdout[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould handle duplicate kelas correctly
[22m[39mðŸ” DEBUG getMyKelas: Getting ALL available kelas

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mgetLaboranStats[2m > [22m[2mshould return laboran statistics successfully
[22m[39mðŸ”„ Upgrading IndexedDB from v0 to v2
âœ… Created store: kuis
âœ… Created store: kuis_soal
âœ… Created store: kuis_jawaban
âœ… Created store: nilai
âœ… Created store: materi
âœ… Created store: kelas
âœ… Created store: users
âœ… Created store: sync_queue
âœ… Created store: metadata
âœ… Created store: offline_quiz
âœ… Created store: offline_questions
âœ… Created store: offline_answers
âœ… Created store: offline_attempts

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mgetLaboranStats[2m > [22m[2mshould return laboran statistics successfully
[22m[39mâœ… IndexedDB initialized successfully

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mgetLaboranStats[2m > [22m[2mshould return laboran statistics successfully
[22m[39m[API Cache] MISS: laboran_stats (fetching...)

[90mstdout[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould handle duplicate kelas correctly
[22m[39mâš ï¸ DEBUG: No kelas found in database

[90mstderr[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Student Management[2m > [22m[2mgetKelasStudents[2m > [22m[2mshould return students for a kelas
[22m[39mError fetching kelas students: {
  code: [32m'42703'[39m,
  details: [1mnull[22m,
  hint: [1mnull[22m,
  message: [32m'column users_2.nama does not exist'[39m
}

[90mstderr[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Student Management[2m > [22m[2mgetKelasStudents[2m > [22m[2mshould return empty array when no students
[22m[39mError fetching kelas students: {
  code: [32m'42703'[39m,
  details: [1mnull[22m,
  hint: [1mnull[22m,
  message: [32m'column users_2.nama does not exist'[39m
}

[90mstderr[2m | server/src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Student Management[2m > [22m[2mgetKelasStudents[2m > [22m[2mshould handle database errors gracefully
[22m[39mError fetching kelas students: {
  code: [32m'42703'[39m,
  details: [1mnull[22m,
  hint: [1mnull[22m,
  message: [32m'column users_2.nama does not exist'[39m
}

 [31mâ¯[39m server/src/__tests__/unit/api/dosen.api.test.ts [2m([22m[2m19 tests[22m[2m | [22m[31m12 failed[39m[2m | [22m[33m1 skipped[39m[2m)[22m[33m 1430[2mms[22m[39m
[31m   [31mÃ—[31m Dosen API - Dashboard Stats[2m > [22mgetDosenStats[2m > [22mshould return stats for authenticated dosen[39m[32m 73[2mms[22m[39m
[31m     â†’ expected { totalKelas: +0, â€¦(3) } to deeply equal { totalKelas: 5, â€¦(3) }[39m
   [32mâœ“[39m Dosen API - Dashboard Stats[2m > [22mgetDosenStats[2m > [22mshould return zero stats when no dosen found[32m 3[2mms[22m[39m
   [32mâœ“[39m Dosen API - Dashboard Stats[2m > [22mgetDosenStats[2m > [22mshould handle errors gracefully[32m 2[2mms[22m[39m
[31m   [31mÃ—[31m Dosen API - Dashboard Stats[2m > [22mgetDosenStats[2m > [22mshould use cached dosen ID on subsequent calls[39m[32m 16[2mms[22m[39m
[31m     â†’ expected "spy" to be called with arguments: [ 'cached_dosen_id', â€¦(1) ][90m

Number of calls: [1m0[22m
[31m[39m
[31m   [31mÃ—[31m Dosen API - Kelas Management[2m > [22mgetMyKelas[2m > [22mshould return kelas with stats for dosen[39m[32m 292[2mms[22m[39m
[31m     â†’ expected [] to have a length of 1 but got +0[39m
[31m   [31mÃ—[31m Dosen API - Kelas Management[2m > [22mgetMyKelas[2m > [22mshould apply limit when provided[39m[32m 160[2mms[22m[39m
[31m     â†’ expected [] to have a length of 2 but got +0[39m
   [32mâœ“[39m Dosen API - Kelas Management[2m > [22mgetMyKelas[2m > [22mshould return empty array when no dosen ID[32m 66[2mms[22m[39m
[31m   [31mÃ—[31m Dosen API - Kelas Management[2m > [22mgetMyKelas[2m > [22mshould handle duplicate kelas correctly[39m[32m 68[2mms[22m[39m
[31m     â†’ expected [] to have a length of 2 but got +0[39m
[31m   [31mÃ—[31m Dosen API - Kelas Management[2m > [22mgetMyMataKuliah[2m > [22mshould return mata kuliah with aggregated stats[39m[32m 72[2mms[22m[39m
[31m     â†’ expected [] to have a length of 1 but got +0[39m
[31m   [31mÃ—[31m Dosen API - Kelas Management[2m > [22mgetMyMataKuliah[2m > [22mshould apply limit when provided[39m[32m 80[2mms[22m[39m
[31m     â†’ expected [] to have a length of 2 but got +0[39m
[31m   [31mÃ—[31m Dosen API - Student Management[2m > [22mgetKelasStudents[2m > [22mshould return students for a kelas[39m[32m 85[2mms[22m[39m
[31m     â†’ expected [] to have a length of 1 but got +0[39m
   [32mâœ“[39m Dosen API - Student Management[2m > [22mgetKelasStudents[2m > [22mshould return empty array when no students[32m 62[2mms[22m[39m
   [32mâœ“[39m Dosen API - Student Management[2m > [22mgetKelasStudents[2m > [22mshould handle database errors gracefully[32m 65[2mms[22m[39m
   [2m[90mâ†“[39m[22m Dosen API - Student Management[2m > [22mgetStudentStats[2m > [22mshould return aggregated student statistics
   [32mâœ“[39m Dosen API - Student Management[2m > [22mgetStudentStats[2m > [22mshould handle no kelas scenario[32m 69[2mms[22m[39m
[31m   [31mÃ—[31m Dosen API - Grading Operations[2m > [22mgetPendingGrading[2m > [22mshould return pending grading items[39m[32m 79[2mms[22m[39m
[31m     â†’ expected [] to have a length of 1 but got +0[39m
[31m   [31mÃ—[31m Dosen API - Grading Operations[2m > [22mgetPendingGrading[2m > [22mshould apply limit when provided[39m[32m 71[2mms[22m[39m
[31m     â†’ expected "spy" to be called with arguments: [ 5 ][90m

Number of calls: [1m0[22m
[31m[39m
[31m   [31mÃ—[31m Dosen API - Grading Operations[2m > [22mgetActiveKuis[2m > [22mshould return active quizzes with stats[39m[32m 80[2mms[22m[39m
[31m     â†’ expected [] to have a length of 1 but got +0[39m
[31m   [31mÃ—[31m Dosen API - Grading Operations[2m > [22mgetActiveKuis[2m > [22mshould apply limit when provided[39m[32m 82[2mms[22m[39m
[31m     â†’ expected "spy" to be called with arguments: [ 10 ][90m

Number of calls: [1m0[22m
[31m[39m
[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mgetLaboranStats[2m > [22m[2mshould return laboran statistics successfully
[22m[39m[API Cache] Cached: laboran_stats (TTL: 300000ms)

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mgetLaboranStats[2m > [22m[2mshould handle empty data
[22m[39m[API Cache] HIT: laboran_stats

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mgetLaboranStats[2m > [22m[2mshould handle database errors
[22m[39m[API Cache] HIT: laboran_stats

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mapprovePeminjaman[2m > [22m[2mshould approve peminjaman and decrease stock
[22m[39mðŸ” DEBUG: checkPermission called: manage:peminjaman

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mapprovePeminjaman[2m > [22m[2mshould fail when stock is insufficient
[22m[39mðŸ” DEBUG: checkPermission called: manage:peminjaman

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mapprovePeminjaman[2m > [22m[2mshould fail when user not authenticated
[22m[39mðŸ” DEBUG: checkPermission called: manage:peminjaman

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mapprovePeminjaman[2m > [22m[2mshould fail when peminjaman not found
[22m[39mðŸ” DEBUG: checkPermission called: manage:peminjaman

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mrejectPeminjaman[2m > [22m[2mshould reject peminjaman with reason
[22m[39mðŸ” DEBUG: checkPermission called: manage:peminjaman

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mrejectPeminjaman[2m > [22m[2mshould fail when user not authenticated
[22m[39mðŸ” DEBUG: checkPermission called: manage:peminjaman

[90mstderr[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mInventaris CRUD[2m > [22m[2mgetInventarisList[2m > [22m[2mshould apply pagination
[22m[39mError fetching inventaris list: { message: [32m'{"'[39m }

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mInventaris CRUD[2m > [22m[2mcreateInventaris[2m > [22m[2mshould create new inventaris
[22m[39mðŸ” DEBUG: checkPermission called: manage:inventaris

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mInventaris CRUD[2m > [22m[2mcreateInventaris[2m > [22m[2mshould handle creation errors
[22m[39mðŸ” DEBUG: checkPermission called: manage:inventaris

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mInventaris CRUD[2m > [22m[2mupdateInventaris[2m > [22m[2mshould update inventaris
[22m[39mðŸ” DEBUG: checkPermission called: manage:inventaris

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mInventaris CRUD[2m > [22m[2mdeleteInventaris[2m > [22m[2mshould delete inventaris when no active borrowings
[22m[39mðŸ” DEBUG: checkPermission called: manage:inventaris

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mInventaris CRUD[2m > [22m[2mdeleteInventaris[2m > [22m[2mshould fail when active borrowings exist
[22m[39mðŸ” DEBUG: checkPermission called: manage:inventaris

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mLaboratorium Management[2m > [22m[2mcreateLaboratorium[2m > [22m[2mshould create new laboratorium
[22m[39mðŸ” DEBUG: checkPermission called: manage:laboratorium

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mLaboratorium Management[2m > [22m[2mdeleteLaboratorium[2m > [22m[2mshould delete laboratorium when no related data
[22m[39mðŸ” DEBUG: checkPermission called: manage:laboratorium

[90mstdout[2m | server/src/__tests__/unit/api/laboran.api.test.ts[2m > [22m[2mLaboran API[2m > [22m[2mLaboratorium Management[2m > [22m[2mdeleteLaboratorium[2m > [22m[2mshould fail when equipment exists
[22m[39mðŸ” DEBUG: checkPermission called: manage:laboratorium

 [31mâ¯[39m server/src/__tests__/unit/api/laboran.api.test.ts [2m([22m[2m27 tests[22m[2m | [22m[31m23 failed[39m[2m)[22m[33m 1931[2mms[22m[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mgetLaboranStats[2m > [22mshould return laboran statistics successfully[39m[33m 948[2mms[22m[39m
[31m     â†’ expected { totalLab: 11, â€¦(3) } to deeply equal { totalLab: 5, â€¦(3) }[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mgetLaboranStats[2m > [22mshould handle empty data[39m[32m 6[2mms[22m[39m
[31m     â†’ expected { totalLab: 11, â€¦(3) } to deeply equal { totalLab: +0, â€¦(3) }[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mgetLaboranStats[2m > [22mshould handle database errors[39m[32m 9[2mms[22m[39m
[31m     â†’ promise resolved "{ totalLab: 11, â€¦(3) }" instead of rejecting[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mgetPendingApprovals[2m > [22mshould return pending approval list[39m[32m 166[2mms[22m[39m
[31m     â†’ expected [] to have a length of 1 but got +0[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mgetPendingApprovals[2m > [22mshould handle missing related data gracefully[39m[32m 156[2mms[22m[39m
[31m     â†’ Cannot read properties of undefined (reading 'peminjam_nama')[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mgetPendingApprovals[2m > [22mshould respect limit parameter[39m[32m 68[2mms[22m[39m
[31m     â†’ expected "spy" to be called with arguments: [ 20 ][90m

Number of calls: [1m0[22m
[31m[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mgetInventoryAlerts[2m > [22mshould return low stock items[39m[32m 76[2mms[22m[39m
[31m     â†’ expected [] to have a length of 1 but got +0[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mgetInventoryAlerts[2m > [22mshould handle null category as "Umum"[39m[32m 73[2mms[22m[39m
[31m     â†’ Cannot read properties of undefined (reading 'kategori')[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mapprovePeminjaman[2m > [22mshould approve peminjaman and decrease stock[39m[32m 5[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mapprovePeminjaman[2m > [22mshould fail when stock is insufficient[39m[32m 9[2mms[22m[39m
[31m     â†’ expected [Function] to throw error including 'Stok tidak cukup' but got 'User not authenticated'[39m
   [32mâœ“[39m Laboran API[2m > [22mapprovePeminjaman[2m > [22mshould fail when user not authenticated[32m 2[2mms[22m[39m
   [32mâœ“[39m Laboran API[2m > [22mapprovePeminjaman[2m > [22mshould fail when peminjaman not found[32m 2[2mms[22m[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mrejectPeminjaman[2m > [22mshould reject peminjaman with reason[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
   [32mâœ“[39m Laboran API[2m > [22mrejectPeminjaman[2m > [22mshould fail when user not authenticated[32m 1[2mms[22m[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mInventaris CRUD[2m > [22mgetInventarisList[2m > [22mshould return inventaris list with filters[39m[32m 98[2mms[22m[39m
[31m     â†’ expected [ { â€¦(15) }, { â€¦(15) } ] to have a length of 1 but got 2[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mInventaris CRUD[2m > [22mgetInventarisList[2m > [22mshould apply search filter[39m[32m 70[2mms[22m[39m
[31m     â†’ expected "spy" to be called with arguments: [ Array(1) ][90m

Number of calls: [1m0[22m
[31m[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mInventaris CRUD[2m > [22mgetInventarisList[2m > [22mshould apply pagination[39m[32m 78[2mms[22m[39m
[31m     â†’ {"[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mInventaris CRUD[2m > [22mcreateInventaris[2m > [22mshould create new inventaris[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
   [32mâœ“[39m Laboran API[2m > [22mInventaris CRUD[2m > [22mcreateInventaris[2m > [22mshould handle creation errors[32m 3[2mms[22m[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mInventaris CRUD[2m > [22mupdateInventaris[2m > [22mshould update inventaris[39m[32m 4[2mms[22m[39m
[31m     â†’ promise rejected "AuthenticationError: User not authenticatâ€¦ { â€¦(2) }" instead of resolving[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mInventaris CRUD[2m > [22mdeleteInventaris[2m > [22mshould delete inventaris when no active borrowings[39m[32m 2[2mms[22m[39m
[31m     â†’ promise rejected "AuthenticationError: User not authenticatâ€¦ { â€¦(2) }" instead of resolving[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mInventaris CRUD[2m > [22mdeleteInventaris[2m > [22mshould fail when active borrowings exist[39m[32m 3[2mms[22m[39m
[31m     â†’ expected [Function] to throw error including 'Cannot delete inventaris with active â€¦' but got 'User not authenticated'[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mLaboratorium Management[2m > [22mgetLaboratoriumList[2m > [22mshould return laboratorium list[39m[32m 68[2mms[22m[39m
[31m     â†’ expected [ { â€¦(10) }, { â€¦(10) }, â€¦(9) ] to have a length of 1 but got 11[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mLaboratorium Management[2m > [22mgetLaboratoriumList[2m > [22mshould filter by is_active[39m[32m 66[2mms[22m[39m
[31m     â†’ expected "spy" to be called with arguments: [ 'is_active', true ][90m

Number of calls: [1m0[22m
[31m[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mLaboratorium Management[2m > [22mcreateLaboratorium[2m > [22mshould create new laboratorium[39m[32m 2[2mms[22m[39m
[31m     â†’ promise rejected "AuthenticationError: User not authenticatâ€¦ { â€¦(2) }" instead of resolving[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mLaboratorium Management[2m > [22mdeleteLaboratorium[2m > [22mshould delete laboratorium when no related data[39m[32m 2[2mms[22m[39m
[31m     â†’ promise rejected "AuthenticationError: User not authenticatâ€¦ { â€¦(2) }" instead of resolving[39m
[31m   [31mÃ—[31m Laboran API[2m > [22mLaboratorium Management[2m > [22mdeleteLaboratorium[2m > [22mshould fail when equipment exists[39m[32m 4[2mms[22m[39m
[31m     â†’ expected [Function] to throw error including 'Cannot delete laboratory that has equâ€¦' but got 'User not authenticated'[39m
 [31mâ¯[39m server/src/__tests__/unit/api/reports.api.test.ts [2m([22m[2m7 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[33m 942[2mms[22m[39m
[31m   [31mÃ—[31m Reports API[2m > [22mgetBorrowingStats[2m > [22mshould calculate borrowing statistics[39m[33m 314[2mms[22m[39m
[31m     â†’ expected { total_borrowings: +0, â€¦(6) } to have property "total_borrowings" with value 3[39m
[31m   [31mÃ—[31m Reports API[2m > [22mgetEquipmentStats[2m > [22mshould calculate equipment statistics[39m[32m 173[2mms[22m[39m
[31m     â†’ expected { total_items: 2, low_stock: +0, â€¦(4) } to have property "out_of_stock" with value 1[39m
   [32mâœ“[39m Reports API[2m > [22mgetLabUsageStats[2m > [22mshould calculate lab usage statistics[32m 153[2mms[22m[39m
[31m   [31mÃ—[31m Reports API[2m > [22mgetTopBorrowedItems[2m > [22mshould return top borrowed items[39m[32m 72[2mms[22m[39m
[31m     â†’ expected [] to have a length of 1 but got +0[39m
   [32mâœ“[39m Reports API[2m > [22mgetBorrowingTrends[2m > [22mshould return borrowing trends[32m 67[2mms[22m[39m
   [32mâœ“[39m Reports API[2m > [22mgetLabUtilization[2m > [22mshould calculate lab utilization[32m 72[2mms[22m[39m
[31m   [31mÃ—[31m Reports API[2m > [22mgetRecentActivities[2m > [22mshould return recent activities[39m[32m 87[2mms[22m[39m
[31m     â†’ expected [] to have a length of 1 but got +0[39m
[90mstderr[2m | server/src/__tests__/unit/api/kelas.api.test.ts
[22m[39mGoTrueClient@sb-rkyoifqbfcztnhevpnpx-auth-token:1 (2.86.0) 2026-01-14T05:57:57.713Z Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.

[90mstderr[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - CRUD Operations[2m > [22m[2mgetKelas[2m > [22m[2mshould handle errors gracefully
[22m[39mError fetching kelas: Error: DB Error
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\kelas.api.test.ts:239:53
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - CRUD Operations[2m > [22m[2mgetKelasById[2m > [22m[2mshould handle not found errors
[22m[39mError fetching kelas: Error: Not found
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\api\kelas.api.test.ts:260:44
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - CRUD Operations[2m > [22m[2mcreateKelas[2m > [22m[2mshould create new kelas and return with relations
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - CRUD Operations[2m > [22m[2mcreateKelas[2m > [22m[2mshould handle creation errors
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - CRUD Operations[2m > [22m[2mupdateKelas[2m > [22m[2mshould update kelas and return updated data
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - CRUD Operations[2m > [22m[2mdeleteKelas[2m > [22m[2mshould delete kelas by ID
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas

[90mstderr[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2mgetEnrolledStudents[2m > [22m[2mshould fetch enrolled students for a kelas
[22m[39mError fetching enrolled students: {
  code: [32m'22P02'[39m,
  details: [1mnull[22m,
  hint: [1mnull[22m,
  message: [32m'invalid input syntax for type uuid: "kelas-1"'[39m
}

[90mstderr[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2mgetEnrolledStudents[2m > [22m[2mshould handle empty enrollment
[22m[39mError fetching enrolled students: {
  code: [32m'22P02'[39m,
  details: [1mnull[22m,
  hint: [1mnull[22m,
  message: [32m'invalid input syntax for type uuid: "kelas-1"'[39m
}

[90mstderr[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2mgetEnrolledStudents[2m > [22m[2mshould handle database errors
[22m[39mError fetching enrolled students: {
  code: [32m'22P02'[39m,
  details: [1mnull[22m,
  hint: [1mnull[22m,
  message: [32m'invalid input syntax for type uuid: "kelas-1"'[39m
}

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2menrollStudent - CRITICAL VALIDATION[2m > [22m[2mshould enroll student successfully when quota available
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas_mahasiswa

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2menrollStudent - CRITICAL VALIDATION[2m > [22m[2mshould reject enrollment when kelas is full
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas_mahasiswa

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2menrollStudent - CRITICAL VALIDATION[2m > [22m[2mshould reject duplicate enrollment
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas_mahasiswa

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2menrollStudent - CRITICAL VALIDATION[2m > [22m[2mshould handle kelas not found
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas_mahasiswa

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2menrollStudent - CRITICAL VALIDATION[2m > [22m[2mshould handle null kuota (unlimited enrollment)
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas_mahasiswa

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2munenrollStudent[2m > [22m[2mshould remove student from kelas
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas_mahasiswa

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2munenrollStudent[2m > [22m[2mshould handle errors during unenrollment
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas_mahasiswa

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2mtoggleStudentStatus[2m > [22m[2mshould activate student in kelas
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas_mahasiswa

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2mtoggleStudentStatus[2m > [22m[2mshould deactivate student in kelas
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas_mahasiswa

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Management[2m > [22m[2mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22m[2mshould enroll existing mahasiswa to kelas
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas_mahasiswa

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Management[2m > [22m[2mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22m[2mshould create new mahasiswa and enroll
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas_mahasiswa

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Management[2m > [22m[2mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22m[2mshould reject if email already exists
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas_mahasiswa

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Management[2m > [22m[2mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22m[2mshould reject if already enrolled
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas_mahasiswa

[90mstdout[2m | server/src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Management[2m > [22m[2mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22m[2mshould handle NIM duplicate error
[22m[39mðŸ” DEBUG: checkPermission called: manage:kelas_mahasiswa

 [31mâ¯[39m server/src/__tests__/unit/api/kelas.api.test.ts [2m([22m[2m33 tests[22m[2m | [22m[31m21 failed[39m[2m)[22m[33m 942[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelas[2m > [22mshould fetch all kelas without filters[32m 12[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelas[2m > [22mshould apply dosen_id filter[32m 2[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelas[2m > [22mshould apply mata_kuliah_id filter[32m 1[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelas[2m > [22mshould apply semester and tahun filters[32m 2[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelas[2m > [22mshould allow filtering inactive kelas[32m 1[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelas[2m > [22mshould default to active kelas only[32m 2[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelas[2m > [22mshould handle errors gracefully[32m 30[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelasById[2m > [22mshould fetch kelas by ID with relations[32m 2[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelasById[2m > [22mshould handle not found errors[32m 16[2mms[22m[39m
[31m   [31mÃ—[31m Kelas API - CRUD Operations[2m > [22mcreateKelas[2m > [22mshould create new kelas and return with relations[39m[32m 7[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Kelas API - CRUD Operations[2m > [22mcreateKelas[2m > [22mshould handle creation errors[39m[32m 13[2mms[22m[39m
[31m     â†’ expected [Function] to throw error including 'Failed to create kelas' but got 'User not authenticated'[39m
[31m   [31mÃ—[31m Kelas API - CRUD Operations[2m > [22mupdateKelas[2m > [22mshould update kelas and return updated data[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Kelas API - CRUD Operations[2m > [22mdeleteKelas[2m > [22mshould delete kelas by ID[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Kelas API - Student Enrollment[2m > [22mgetEnrolledStudents[2m > [22mshould fetch enrolled students for a kelas[39m[33m 350[2mms[22m[39m
[31m     â†’ Failed to fetch enrolled students: invalid input syntax for type uuid: "kelas-1"[39m
[31m   [31mÃ—[31m Kelas API - Student Enrollment[2m > [22mgetEnrolledStudents[2m > [22mshould handle empty enrollment[39m[32m 72[2mms[22m[39m
[31m     â†’ Failed to fetch enrolled students: invalid input syntax for type uuid: "kelas-1"[39m
   [32mâœ“[39m Kelas API - Student Enrollment[2m > [22mgetEnrolledStudents[2m > [22mshould handle database errors[32m 74[2mms[22m[39m
[31m   [31mÃ—[31m Kelas API - Student Enrollment[2m > [22menrollStudent - CRITICAL VALIDATION[2m > [22mshould enroll student successfully when quota available[39m[32m 3[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Kelas API - Student Enrollment[2m > [22menrollStudent - CRITICAL VALIDATION[2m > [22mshould reject enrollment when kelas is full[39m[32m 3[2mms[22m[39m
[31m     â†’ expected [Function] to throw error including 'sudah penuh' but got 'User not authenticated'[39m
[31m   [31mÃ—[31m Kelas API - Student Enrollment[2m > [22menrollStudent - CRITICAL VALIDATION[2m > [22mshould reject duplicate enrollment[39m[32m 4[2mms[22m[39m
[31m     â†’ expected [Function] to throw error including 'sudah terdaftar' but got 'User not authenticated'[39m
[31m   [31mÃ—[31m Kelas API - Student Enrollment[2m > [22menrollStudent - CRITICAL VALIDATION[2m > [22mshould handle kelas not found[39m[32m 3[2mms[22m[39m
[31m     â†’ expected [Function] to throw error including 'tidak ditemukan' but got 'User not authenticated'[39m
[31m   [31mÃ—[31m Kelas API - Student Enrollment[2m > [22menrollStudent - CRITICAL VALIDATION[2m > [22mshould handle null kuota (unlimited enrollment)[39m[32m 3[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Kelas API - Student Enrollment[2m > [22munenrollStudent[2m > [22mshould remove student from kelas[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
   [32mâœ“[39m Kelas API - Student Enrollment[2m > [22munenrollStudent[2m > [22mshould handle errors during unenrollment[32m 1[2mms[22m[39m
[31m   [31mÃ—[31m Kelas API - Student Enrollment[2m > [22mtoggleStudentStatus[2m > [22mshould activate student in kelas[39m[32m 1[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Kelas API - Student Enrollment[2m > [22mtoggleStudentStatus[2m > [22mshould deactivate student in kelas[39m[32m 1[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Kelas API - Student Management[2m > [22mgetAllMahasiswa[2m > [22mshould fetch all mahasiswa with user info[39m[32m 68[2mms[22m[39m
[31m     â†’ expected [] to have a length of 1 but got +0[39m
   [32mâœ“[39m Kelas API - Student Management[2m > [22mgetAllMahasiswa[2m > [22mshould return empty array when no mahasiswa[32m 161[2mms[22m[39m
[31m   [31mÃ—[31m Kelas API - Student Management[2m > [22mgetAllMahasiswa[2m > [22mshould handle mahasiswa without users gracefully[39m[32m 75[2mms[22m[39m
[31m     â†’ Cannot read properties of undefined (reading 'users')[39m
[31m   [31mÃ—[31m Kelas API - Student Management[2m > [22mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22mshould enroll existing mahasiswa to kelas[39m[32m 4[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Kelas API - Student Management[2m > [22mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22mshould create new mahasiswa and enroll[39m[32m 6[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Kelas API - Student Management[2m > [22mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22mshould reject if email already exists[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Kelas API - Student Management[2m > [22mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22mshould reject if already enrolled[39m[32m 3[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Kelas API - Student Management[2m > [22mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22mshould handle NIM duplicate error[39m[32m 3[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[90mstderr[2m | server/src/__tests__/unit/api/peminjaman-extensions.test.ts[2m > [22m[2mPeminjaman Extensions API[2m > [22m[2mgetAllPeminjaman[2m > [22m[2mshould fetch all peminjaman with details
[22m[39mFailed to fetch peminjaman {
  params: [90mundefined[39m,
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'peminjaman' and 'mahasiswa' using the hint 'peminjaman_peminjam_id_fkey' in the schema 'public', but no matches were found."[39m,
    hint: [1mnull[22m,
    message: [32m"Could not find a relationship between 'peminjaman' and 'mahasiswa' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/peminjaman-extensions.test.ts[2m > [22m[2mPeminjaman Extensions API[2m > [22m[2mgetAllPeminjaman[2m > [22m[2mshould apply status filter
[22m[39mFailed to fetch peminjaman {
  params: { status: [32m'approved'[39m },
  error: {
    code: [32m'PGRST200'[39m,
    details: [32m"Searched for a foreign key relationship between 'peminjaman' and 'mahasiswa' using the hint 'peminjaman_peminjam_id_fkey' in the schema 'public', but no matches were found."[39m,
    hint: [1mnull[22m,
    message: [32m"Could not find a relationship between 'peminjaman' and 'mahasiswa' in the schema cache"[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/peminjaman-extensions.test.ts[2m > [22m[2mPeminjaman Extensions API[2m > [22m[2mmarkAsReturned[2m > [22m[2mshould mark peminjaman as returned
[22m[39mFailed to mark peminjaman as returned {
  peminjamanId: [32m'pinjam-1'[39m,
  error: {
    code: [32m'22P02'[39m,
    details: [1mnull[22m,
    hint: [1mnull[22m,
    message: [32m'invalid input syntax for type uuid: "pinjam-1"'[39m
  }
}

[90mstdout[2m | server/src/__tests__/unit/api/announcements.api.test.ts[2m > [22m[2mAnnouncements API[2m > [22m[2mcreateAnnouncement[2m > [22m[2mshould create announcement
[22m[39mðŸ” DEBUG: checkPermission called: manage:pengumuman

[90mstdout[2m | server/src/__tests__/unit/api/announcements.api.test.ts[2m > [22m[2mAnnouncements API[2m > [22m[2mdeleteAnnouncement[2m > [22m[2mshould delete announcement
[22m[39mðŸ” DEBUG: checkPermission called: manage:pengumuman

 [31mâ¯[39m server/src/__tests__/unit/api/announcements.api.test.ts [2m([22m[2m4 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 485[2mms[22m[39m
   [33m[2mâœ“[22m[39m Announcements API[2m > [22mgetAllAnnouncements[2m > [22mshould fetch all announcements [33m 382[2mms[22m[39m
   [32mâœ“[39m Announcements API[2m > [22mgetAnnouncementStats[2m > [22mshould calculate stats correctly[32m 79[2mms[22m[39m
[31m   [31mÃ—[31m Announcements API[2m > [22mcreateAnnouncement[2m > [22mshould create announcement[39m[32m 16[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Announcements API[2m > [22mdeleteAnnouncement[2m > [22mshould delete announcement[39m[32m 3[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[90mstderr[2m | server/src/__tests__/unit/api/peminjaman-extensions.test.ts[2m > [22m[2mPeminjaman Extensions API[2m > [22m[2mapproveRoomBooking[2m > [22m[2mshould approve room booking
[22m[39mFailed to approve room booking {
  jadwalId: [32m'jadwal-1'[39m,
  error: {
    code: [32m'22P02'[39m,
    details: [1mnull[22m,
    hint: [1mnull[22m,
    message: [32m'invalid input syntax for type uuid: "jadwal-1"'[39m
  }
}

[90mstderr[2m | server/src/__tests__/unit/api/peminjaman-extensions.test.ts[2m > [22m[2mPeminjaman Extensions API[2m > [22m[2mrejectRoomBooking[2m > [22m[2mshould reject and delete room booking
[22m[39mFailed to reject room booking {
  jadwalId: [32m'jadwal-1'[39m,
  reason: [32m'Not available'[39m,
  error: {
    code: [32m'22P02'[39m,
    details: [1mnull[22m,
    hint: [1mnull[22m,
    message: [32m'invalid input syntax for type uuid: "jadwal-1"'[39m
  }
}

 [31mâ¯[39m server/src/__tests__/unit/api/peminjaman-extensions.test.ts [2m([22m[2m6 tests[22m[2m | [22m[31m6 failed[39m[2m)[22m[33m 978[2mms[22m[39m
[31m   [31mÃ—[31m Peminjaman Extensions API[2m > [22mgetAllPeminjaman[2m > [22mshould fetch all peminjaman with details[39m[33m 443[2mms[22m[39m
[31m     â†’ Could not find a relationship between 'peminjaman' and 'mahasiswa' in the schema cache[39m
[31m   [31mÃ—[31m Peminjaman Extensions API[2m > [22mgetAllPeminjaman[2m > [22mshould apply status filter[39m[32m 101[2mms[22m[39m
[31m     â†’ Could not find a relationship between 'peminjaman' and 'mahasiswa' in the schema cache[39m
[31m   [31mÃ—[31m Peminjaman Extensions API[2m > [22mmarkAsReturned[2m > [22mshould mark peminjaman as returned[39m[32m 82[2mms[22m[39m
[31m     â†’ Invalid data format[39m
[31m   [31mÃ—[31m Peminjaman Extensions API[2m > [22mgetPendingRoomBookings[2m > [22mshould fetch pending room bookings[39m[32m 88[2mms[22m[39m
[31m     â†’ expected [] to have a length of 1 but got +0[39m
[31m   [31mÃ—[31m Peminjaman Extensions API[2m > [22mapproveRoomBooking[2m > [22mshould approve room booking[39m[32m 184[2mms[22m[39m
[31m     â†’ Invalid data format[39m
[31m   [31mÃ—[31m Peminjaman Extensions API[2m > [22mrejectRoomBooking[2m > [22mshould reject and delete room booking[39m[32m 74[2mms[22m[39m
[31m     â†’ Invalid data format[39m
[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - CRUD Operations[2m > [22m[2mgetKelas[2m > [22m[2mshould handle errors gracefully
[22m[39mError fetching kelas: Error: DB Error
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:239:53
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - CRUD Operations[2m > [22m[2mgetKelasById[2m > [22m[2mshould handle not found errors
[22m[39mError fetching kelas: Error: Not found
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:260:44
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - CRUD Operations[2m > [22m[2mcreateKelas[2m > [22m[2mshould handle creation errors
[22m[39mError creating kelas: Error: Insert failed
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:292:43
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstdout[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - CRUD Operations[2m > [22m[2mdeleteKelas[2m > [22m[2mshould delete kelas by ID
[22m[39mðŸ—‘ï¸ Attempting to delete kelas with id: kelas-1

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - CRUD Operations[2m > [22m[2mdeleteKelas[2m > [22m[2mshould delete kelas by ID
[22m[39mâŒ Error deleting kelas: TypeError: Cannot read properties of undefined (reading 'select')
    at Module.deleteKelasImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:220:20[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:322:13
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2mgetEnrolledStudents[2m > [22m[2mshould handle database errors
[22m[39mError fetching enrolled students: Error: DB Error
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:371:16
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2menrollStudent - CRITICAL VALIDATION[2m > [22m[2mshould enroll student successfully when quota available
[22m[39mError enrolling student: TypeError: Cannot destructure property 'data' of '(intermediate value)' as it is undefined.
    at Module.enrollStudentImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:395:13[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:415:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2menrollStudent - CRITICAL VALIDATION[2m > [22m[2mshould reject enrollment when kelas is full
[22m[39mError enrolling student: Error: Kelas Kelas A sudah penuh! (30/30 mahasiswa)
    at Module.enrollStudentImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:352:13[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:438:7
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2menrollStudent - CRITICAL VALIDATION[2m > [22m[2mshould reject duplicate enrollment
[22m[39mError enrolling student: Error: Mahasiswa sudah terdaftar di kelas ini
    at Module.enrollStudentImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:366:13[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:469:7
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2menrollStudent - CRITICAL VALIDATION[2m > [22m[2mshould handle kelas not found
[22m[39mError enrolling student: Error: Kelas tidak ditemukan
    at Module.enrollStudentImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:334:13[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2menrollStudent - CRITICAL VALIDATION[2m > [22m[2mshould handle null kuota (unlimited enrollment)
[22m[39mError enrolling student: TypeError: Cannot destructure property 'data' of '(intermediate value)' as it is undefined.
    at Module.enrollStudentImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:395:13[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:516:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Enrollment[2m > [22m[2munenrollStudent[2m > [22m[2mshould handle errors during unenrollment
[22m[39mError unenrolling student: Error: Delete failed
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:543:37
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Management[2m > [22m[2mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22m[2mshould enroll existing mahasiswa to kelas
[22m[39mCould not fetch semester data: TypeError: __vite_ssr_import_1__.supabase.from(...).select(...).eq is not a function
    at enrollStudentImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:376:10[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at Module.createOrEnrollMahasiswaImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:667:5[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:720:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Management[2m > [22m[2mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22m[2mshould enroll existing mahasiswa to kelas
[22m[39mError enrolling student: TypeError: Cannot destructure property 'data' of '(intermediate value)' as it is undefined.
    at enrollStudentImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:395:13[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at Module.createOrEnrollMahasiswaImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:667:5[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:720:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Management[2m > [22m[2mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22m[2mshould enroll existing mahasiswa to kelas
[22m[39mError creating/enrolling mahasiswa: Error: Failed to enroll student: Cannot destructure property 'data' of '(intermediate value)' as it is undefined.
    at enrollStudentImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:405:11[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at Module.createOrEnrollMahasiswaImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:667:5[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:720:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Management[2m > [22m[2mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22m[2mshould create new mahasiswa and enroll
[22m[39mCould not fetch semester data: TypeError: __vite_ssr_import_1__.supabase.from(...).select(...).eq is not a function
    at enrollStudentImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:376:10[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at Module.createOrEnrollMahasiswaImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:667:5[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:805:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Management[2m > [22m[2mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22m[2mshould create new mahasiswa and enroll
[22m[39mError enrolling student: TypeError: Cannot destructure property 'data' of '(intermediate value)' as it is undefined.
    at enrollStudentImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:395:13[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at Module.createOrEnrollMahasiswaImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:667:5[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:805:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Management[2m > [22m[2mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22m[2mshould create new mahasiswa and enroll
[22m[39mError creating/enrolling mahasiswa: Error: Failed to enroll student: Cannot destructure property 'data' of '(intermediate value)' as it is undefined.
    at enrollStudentImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:405:11[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at Module.createOrEnrollMahasiswaImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:667:5[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:805:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Management[2m > [22m[2mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22m[2mshould reject if email already exists
[22m[39mError creating/enrolling mahasiswa: Error: Email existing@example.com sudah terdaftar di sistem. Gunakan email lain atau hubungi admin.
    at Module.createOrEnrollMahasiswaImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:564:15[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:837:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20

[90mstderr[2m | src/__tests__/unit/api/kelas.api.test.ts[2m > [22m[2mKelas API - Student Management[2m > [22m[2mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22m[2mshould handle NIM duplicate error
[22m[39mError creating/enrolling mahasiswa: Error: NIM BD2321001 sudah terdaftar di sistem
    at Module.createOrEnrollMahasiswaImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\kelas.api.ts:631:17[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\kelas.api.test.ts:928:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20

 [31mâ¯[39m src/__tests__/unit/api/kelas.api.test.ts [2m([22m[2m33 tests[22m[2m | [22m[31m5 failed[39m[2m)[22m[32m 230[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelas[2m > [22mshould fetch all kelas without filters[32m 10[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelas[2m > [22mshould apply dosen_id filter[32m 1[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelas[2m > [22mshould apply mata_kuliah_id filter[32m 1[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelas[2m > [22mshould apply semester and tahun filters[32m 1[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelas[2m > [22mshould allow filtering inactive kelas[32m 9[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelas[2m > [22mshould default to active kelas only[32m 1[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelas[2m > [22mshould handle errors gracefully[32m 16[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelasById[2m > [22mshould fetch kelas by ID with relations[32m 1[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mgetKelasById[2m > [22mshould handle not found errors[32m 2[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mcreateKelas[2m > [22mshould create new kelas and return with relations[32m 2[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mcreateKelas[2m > [22mshould handle creation errors[32m 2[2mms[22m[39m
   [32mâœ“[39m Kelas API - CRUD Operations[2m > [22mupdateKelas[2m > [22mshould update kelas and return updated data[32m 2[2mms[22m[39m
[31m   [31mÃ—[31m Kelas API - CRUD Operations[2m > [22mdeleteKelas[2m > [22mshould delete kelas by ID[39m[32m 8[2mms[22m[39m
[31m     â†’ Failed to delete kelas: Cannot read properties of undefined (reading 'select')[39m
   [32mâœ“[39m Kelas API - Student Enrollment[2m > [22mgetEnrolledStudents[2m > [22mshould fetch enrolled students for a kelas[32m 18[2mms[22m[39m
   [32mâœ“[39m Kelas API - Student Enrollment[2m > [22mgetEnrolledStudents[2m > [22mshould handle empty enrollment[32m 1[2mms[22m[39m
   [32mâœ“[39m Kelas API - Student Enrollment[2m > [22mgetEnrolledStudents[2m > [22mshould handle database errors[32m 3[2mms[22m[39m
[31m   [31mÃ—[31m Kelas API - Student Enrollment[2m > [22menrollStudent - CRITICAL VALIDATION[2m > [22mshould enroll student successfully when quota available[39m[32m 9[2mms[22m[39m
[31m     â†’ Failed to enroll student: Cannot destructure property 'data' of '(intermediate value)' as it is undefined.[39m
   [32mâœ“[39m Kelas API - Student Enrollment[2m > [22menrollStudent - CRITICAL VALIDATION[2m > [22mshould reject enrollment when kelas is full[32m 38[2mms[22m[39m
   [32mâœ“[39m Kelas API - Student Enrollment[2m > [22menrollStudent - CRITICAL VALIDATION[2m > [22mshould reject duplicate enrollment[32m 5[2mms[22m[39m
   [32mâœ“[39m Kelas API - Student Enrollment[2m > [22menrollStudent - CRITICAL VALIDATION[2m > [22mshould handle kelas not found[32m 3[2mms[22m[39m
[31m   [31mÃ—[31m Kelas API - Student Enrollment[2m > [22menrollStudent - CRITICAL VALIDATION[2m > [22mshould handle null kuota (unlimited enrollment)[39m[32m 4[2mms[22m[39m
[31m     â†’ Failed to enroll student: Cannot destructure property 'data' of '(intermediate value)' as it is undefined.[39m
   [32mâœ“[39m Kelas API - Student Enrollment[2m > [22munenrollStudent[2m > [22mshould remove student from kelas[32m 1[2mms[22m[39m
   [32mâœ“[39m Kelas API - Student Enrollment[2m > [22munenrollStudent[2m > [22mshould handle errors during unenrollment[32m 27[2mms[22m[39m
   [32mâœ“[39m Kelas API - Student Enrollment[2m > [22mtoggleStudentStatus[2m > [22mshould activate student in kelas[32m 2[2mms[22m[39m
   [32mâœ“[39m Kelas API - Student Enrollment[2m > [22mtoggleStudentStatus[2m > [22mshould deactivate student in kelas[32m 1[2mms[22m[39m
   [32mâœ“[39m Kelas API - Student Management[2m > [22mgetAllMahasiswa[2m > [22mshould fetch all mahasiswa with user info[32m 3[2mms[22m[39m
   [32mâœ“[39m Kelas API - Student Management[2m > [22mgetAllMahasiswa[2m > [22mshould return empty array when no mahasiswa[32m 1[2mms[22m[39m
   [32mâœ“[39m Kelas API - Student Management[2m > [22mgetAllMahasiswa[2m > [22mshould handle mahasiswa without users gracefully[32m 9[2mms[22m[39m
[31m   [31mÃ—[31m Kelas API - Student Management[2m > [22mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22mshould enroll existing mahasiswa to kelas[39m[32m 14[2mms[22m[39m
[31m     â†’ expected false to be true // Object.is equality[39m
[31m   [31mÃ—[31m Kelas API - Student Management[2m > [22mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22mshould create new mahasiswa and enroll[39m[32m 12[2mms[22m[39m
[31m     â†’ expected false to be true // Object.is equality[39m
   [32mâœ“[39m Kelas API - Student Management[2m > [22mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22mshould reject if email already exists[32m 4[2mms[22m[39m
   [32mâœ“[39m Kelas API - Student Management[2m > [22mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22mshould reject if already enrolled[32m 1[2mms[22m[39m
   [32mâœ“[39m Kelas API - Student Management[2m > [22mcreateOrEnrollMahasiswa - COMPLEX BUSINESS LOGIC[2m > [22mshould handle NIM duplicate error[32m 8[2mms[22m[39m
 [31mâ¯[39m src/__tests__/unit/validations/jadwal.schema.test.ts [2m([22m[2m31 tests[22m[2m | [22m[31m11 failed[39m[2m)[22m[32m 169[2mms[22m[39m
[31m   [31mÃ—[31m Jadwal Schema Validation[2m > [22mjadwalSchema - Valid Cases[2m > [22mshould accept valid jadwal data[39m[32m 62[2mms[22m[39m
[31m     â†’ expected false to be true // Object.is equality[39m
[31m   [31mÃ—[31m Jadwal Schema Validation[2m > [22mjadwalSchema - Valid Cases[2m > [22mshould accept kelas with uppercase letters and numbers[39m[32m 3[2mms[22m[39m
[31m     â†’ expected false to be true // Object.is equality[39m
[31m   [31mÃ—[31m Jadwal Schema Validation[2m > [22mjadwalSchema - Valid Cases[2m > [22mshould accept minimum duration of 30 minutes[39m[32m 4[2mms[22m[39m
[31m     â†’ expected false to be true // Object.is equality[39m
[31m   [31mÃ—[31m Jadwal Schema Validation[2m > [22mjadwalSchema - Valid Cases[2m > [22mshould accept topik with minimum 10 characters[39m[32m 2[2mms[22m[39m
[31m     â†’ expected false to be true // Object.is equality[39m
[31m   [31mÃ—[31m Jadwal Schema Validation[2m > [22mjadwalSchema - Valid Cases[2m > [22mshould accept empty topik[39m[32m 4[2mms[22m[39m
[31m     â†’ expected false to be true // Object.is equality[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mjadwalSchema - Invalid Cases[2m > [22mshould reject kelas with lowercase letters[32m 16[2mms[22m[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mjadwalSchema - Invalid Cases[2m > [22mshould reject kelas longer than 10 characters[32m 1[2mms[22m[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mjadwalSchema - Invalid Cases[2m > [22mshould reject invalid UUID for laboratorium_id[32m 1[2mms[22m[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mjadwalSchema - Invalid Cases[2m > [22mshould reject past dates[32m 13[2mms[22m[39m
[31m   [31mÃ—[31m Jadwal Schema Validation[2m > [22mjadwalSchema - Invalid Cases[2m > [22mshould reject invalid time format[39m[32m 5[2mms[22m[39m
[31m     â†’ expected 'Tanggal praktikum tidak boleh di masaâ€¦' to contain 'HH:MM'[39m
[31m   [31mÃ—[31m Jadwal Schema Validation[2m > [22mjadwalSchema - Invalid Cases[2m > [22mshould reject when jam_selesai <= jam_mulai[39m[32m 4[2mms[22m[39m
[31m     â†’ expected 'Tanggal praktikum tidak boleh di masaâ€¦' to contain 'lebih besar'[39m
[31m   [31mÃ—[31m Jadwal Schema Validation[2m > [22mjadwalSchema - Invalid Cases[2m > [22mshould reject duration less than 30 minutes[39m[32m 2[2mms[22m[39m
[31m     â†’ expected 'Tanggal praktikum tidak boleh di masaâ€¦' to contain 'minimal 30 menit'[39m
[31m   [31mÃ—[31m Jadwal Schema Validation[2m > [22mjadwalSchema - Invalid Cases[2m > [22mshould reject topik less than 10 characters when provided[39m[32m 4[2mms[22m[39m
[31m     â†’ expected 'Tanggal praktikum tidak boleh di masaâ€¦' to contain 'minimal 10 karakter'[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mjadwalSchema - Invalid Cases[2m > [22mshould reject topik longer than 200 characters[32m 1[2mms[22m[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mjadwalSchema - Invalid Cases[2m > [22mshould reject catatan longer than 500 characters[32m 1[2mms[22m[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mupdateJadwalSchema[2m > [22mshould accept partial updates[32m 3[2mms[22m[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mupdateJadwalSchema[2m > [22mshould accept empty update[32m 0[2mms[22m[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mjadwalFilterSchema[2m > [22mshould accept valid filters[32m 2[2mms[22m[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mjadwalFilterSchema[2m > [22mshould use default sortBy and sortOrder[32m 1[2mms[22m[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mjadwalFilterSchema[2m > [22mshould reject invalid hari enum[32m 3[2mms[22m[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mjadwalConflictCheckSchema[2m > [22mshould accept valid conflict check data[32m 1[2mms[22m[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mjadwalConflictCheckSchema[2m > [22mshould accept exclude_id for update operations[32m 0[2mms[22m[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mTime Utilities[2m > [22mtimeToMinutes[2m > [22mshould convert time to minutes correctly[32m 1[2mms[22m[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mTime Utilities[2m > [22mcalculateDuration[2m > [22mshould calculate duration correctly[32m 0[2mms[22m[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mTime Utilities[2m > [22mcalculateDuration[2m > [22mshould return negative for invalid order[32m 0[2mms[22m[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mTime Utilities[2m > [22misTimeOverlap[2m > [22mshould detect overlap correctly[32m 1[2mms[22m[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mTime Utilities[2m > [22misTimeOverlap[2m > [22mshould not detect overlap for non-overlapping times[32m 0[2mms[22m[39m
[31m   [31mÃ—[31m Jadwal Schema Validation[2m > [22mHelper Functions[2m > [22mparseCreateJadwalForm[2m > [22mshould parse valid data[39m[32m 22[2mms[22m[39m
[31m     â†’ expected [Function] to not throw an error but '[\n  {\n    "code": "custom",\n    "pâ€¦' was thrown[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mHelper Functions[2m > [22mparseCreateJadwalForm[2m > [22mshould throw on invalid data[32m 1[2mms[22m[39m
[31m   [31mÃ—[31m Jadwal Schema Validation[2m > [22mHelper Functions[2m > [22msafeParseCreateJadwal[2m > [22mshould return success for valid data[39m[32m 2[2mms[22m[39m
[31m     â†’ expected false to be true // Object.is equality[39m
   [32mâœ“[39m Jadwal Schema Validation[2m > [22mHelper Functions[2m > [22msafeParseCreateJadwal[2m > [22mshould return error for invalid data[32m 1[2mms[22m[39m
[90mstdout[2m | server/src/__tests__/unit/middleware/permission.middleware.test.ts[2m > [22m[2mPermission Middleware[2m > [22m[2mcheckPermission[2m > [22m[2mshould allow admin to bypass permission check
[22m[39mðŸ” DEBUG: checkPermission called: create:kuis

[90mstdout[2m | server/src/__tests__/unit/middleware/permission.middleware.test.ts[2m > [22m[2mPermission Middleware[2m > [22m[2mcheckPermission[2m > [22m[2mshould allow user with permission
[22m[39mðŸ” DEBUG: checkPermission called: create:kuis

[90mstdout[2m | server/src/__tests__/unit/middleware/permission.middleware.test.ts[2m > [22m[2mPermission Middleware[2m > [22m[2mcheckPermission[2m > [22m[2mshould throw PermissionError if user lacks permission
[22m[39mðŸ” DEBUG: checkPermission called: create:kuis

[90mstdout[2m | server/src/__tests__/unit/middleware/permission.middleware.test.ts[2m > [22m[2mPermission Middleware[2m > [22m[2mcheckPermission[2m > [22m[2mshould include role in error message
[22m[39mðŸ” DEBUG: checkPermission called: manage:user

[90mstdout[2m | server/src/__tests__/unit/middleware/permission.middleware.test.ts[2m > [22m[2mPermission Middleware[2m > [22m[2mrequirePermission[2m > [22m[2mshould execute function if permission granted
[22m[39mðŸ” DEBUG: checkPermission called: create:kuis

[90mstdout[2m | server/src/__tests__/unit/middleware/permission.middleware.test.ts[2m > [22m[2mPermission Middleware[2m > [22m[2mrequirePermission[2m > [22m[2mshould not execute function if permission denied
[22m[39mðŸ” DEBUG: checkPermission called: create:kuis

[90mstdout[2m | server/src/__tests__/unit/middleware/permission.middleware.test.ts[2m > [22m[2mPermission Middleware[2m > [22m[2mrequirePermission[2m > [22m[2mshould pass arguments to wrapped function
[22m[39mðŸ” DEBUG: checkPermission called: update:kuis

[90mstdout[2m | server/src/__tests__/unit/middleware/permission.middleware.test.ts[2m > [22m[2mPermission Middleware[2m > [22m[2mrequirePermission[2m > [22m[2mshould allow admin bypass
[22m[39mðŸ” DEBUG: checkPermission called: create:kuis

[90mstdout[2m | server/src/__tests__/unit/middleware/permission.middleware.test.ts[2m > [22m[2mPermission Middleware[2m > [22m[2mrequirePermissionAndOwnership[2m > [22m[2mshould check both permission and ownership
[22m[39mðŸ” DEBUG: checkPermission called: update:kuis

[90mstdout[2m | server/src/__tests__/unit/middleware/permission.middleware.test.ts[2m > [22m[2mPermission Middleware[2m > [22m[2mrequirePermissionAndOwnership[2m > [22m[2mshould fail if permission denied
[22m[39mðŸ” DEBUG: checkPermission called: delete:kuis

[90mstdout[2m | server/src/__tests__/unit/middleware/permission.middleware.test.ts[2m > [22m[2mPermission Middleware[2m > [22m[2mrequirePermissionAndOwnership[2m > [22m[2mshould fail if ownership denied
[22m[39mðŸ” DEBUG: checkPermission called: update:kuis

 [31mâ¯[39m server/src/__tests__/unit/middleware/permission.middleware.test.ts [2m([22m[2m33 tests[22m[2m | [22m[31m26 failed[39m[2m)[22m[32m 212[2mms[22m[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mgetCurrentUserWithRole[2m > [22mshould return user with role from database[39m[32m 23[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mgetCurrentUserWithRole[2m > [22mshould throw AuthenticationError if user not authenticated[39m[32m 10[2mms[22m[39m
[31m     â†’ expected error to be instance of AuthenticationError[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mgetCurrentUserWithRole[2m > [22mshould throw RoleNotFoundError if user role not found in database[39m[32m 3[2mms[22m[39m
[31m     â†’ expected error to be instance of RoleNotFoundError[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mgetCurrentUserWithRole[2m > [22mshould get role for admin user[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mgetCurrentUserWithRole[2m > [22mshould get role for mahasiswa user[39m[32m 1[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mgetCurrentDosenId[2m > [22mshould return dosen ID for dosen user[39m[32m 27[2mms[22m[39m
[31m     â†’ expected null to be 'dosen-456' // Object.is equality[39m
   [32mâœ“[39m Permission Middleware[2m > [22mgetCurrentDosenId[2m > [22mshould return null if user is not a dosen[32m 4[2mms[22m[39m
   [32mâœ“[39m Permission Middleware[2m > [22mgetCurrentDosenId[2m > [22mshould return null on error[32m 1[2mms[22m[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mgetCurrentMahasiswaId[2m > [22mshould return mahasiswa ID for mahasiswa user[39m[32m 2[2mms[22m[39m
[31m     â†’ expected null to be 'mhs-456' // Object.is equality[39m
   [32mâœ“[39m Permission Middleware[2m > [22mgetCurrentMahasiswaId[2m > [22mshould return null if user is not a mahasiswa[32m 1[2mms[22m[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mcheckPermission[2m > [22mshould allow admin to bypass permission check[39m[32m 9[2mms[22m[39m
[31m     â†’ promise rejected "AuthenticationError: User not authenticatâ€¦ { â€¦(2) }" instead of resolving[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mcheckPermission[2m > [22mshould allow user with permission[39m[32m 3[2mms[22m[39m
[31m     â†’ promise rejected "AuthenticationError: User not authenticatâ€¦ { â€¦(2) }" instead of resolving[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mcheckPermission[2m > [22mshould throw PermissionError if user lacks permission[39m[32m 3[2mms[22m[39m
[31m     â†’ expected error to be instance of PermissionError[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mcheckPermission[2m > [22mshould include role in error message[39m[32m 3[2mms[22m[39m
[31m     â†’ expected AuthenticationError: User not authenticatâ€¦ { â€¦(2) } to be an instance of PermissionError[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mrequirePermission[2m > [22mshould execute function if permission granted[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mrequirePermission[2m > [22mshould not execute function if permission denied[39m[32m 24[2mms[22m[39m
[31m     â†’ expected error to be instance of PermissionError[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mrequirePermission[2m > [22mshould pass arguments to wrapped function[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mrequirePermission[2m > [22mshould allow admin bypass[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mrequireOwnership[2m > [22mshould allow admin bypass by default[39m[32m 18[2mms[22m[39m
[31m     â†’ promise rejected "AuthenticationError: User not authenticatâ€¦ { â€¦(2) }" instead of resolving[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mrequireOwnership[2m > [22mshould allow owner to access their resource (user_id)[39m[32m 4[2mms[22m[39m
[31m     â†’ promise rejected "AuthenticationError: User not authenticatâ€¦ { â€¦(2) }" instead of resolving[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mrequireOwnership[2m > [22mshould allow dosen to access their own kuis[39m[32m 5[2mms[22m[39m
[31m     â†’ promise rejected "AuthenticationError: User not authenticatâ€¦ { â€¦(2) }" instead of resolving[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mrequireOwnership[2m > [22mshould throw OwnershipError if not owner[39m[32m 2[2mms[22m[39m
[31m     â†’ expected error to be instance of OwnershipError[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mrequireOwnership[2m > [22mshould throw error if resource not found[39m[32m 12[2mms[22m[39m
[31m     â†’ expected [Function] to throw error including 'Resource not found' but got 'User not authenticated'[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mrequireOwnership[2m > [22mshould respect allowAdmin option[39m[32m 8[2mms[22m[39m
[31m     â†’ expected error to be instance of OwnershipError[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mrequirePermissionAndOwnership[2m > [22mshould check both permission and ownership[39m[32m 13[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mrequirePermissionAndOwnership[2m > [22mshould fail if permission denied[39m[32m 3[2mms[22m[39m
[31m     â†’ expected error to be instance of PermissionError[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mrequirePermissionAndOwnership[2m > [22mshould fail if ownership denied[39m[32m 2[2mms[22m[39m
[31m     â†’ expected error to be instance of OwnershipError[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22misCurrentUserAdmin[2m > [22mshould return true for admin user[39m[32m 4[2mms[22m[39m
[31m     â†’ expected false to be true // Object.is equality[39m
   [32mâœ“[39m Permission Middleware[2m > [22misCurrentUserAdmin[2m > [22mshould return false for non-admin user[32m 10[2mms[22m[39m
   [32mâœ“[39m Permission Middleware[2m > [22misCurrentUserAdmin[2m > [22mshould return false on error[32m 1[2mms[22m[39m
[31m   [31mÃ—[31m Permission Middleware[2m > [22mhasRole[2m > [22mshould return true if user has specified role[39m[32m 2[2mms[22m[39m
[31m     â†’ expected false to be true // Object.is equality[39m
   [32mâœ“[39m Permission Middleware[2m > [22mhasRole[2m > [22mshould return false if user has different role[32m 1[2mms[22m[39m
   [32mâœ“[39m Permission Middleware[2m > [22mhasRole[2m > [22mshould return false on error[32m 1[2mms[22m[39m
[90mstdout[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2minitStorage[2m > [22m[2mshould initialize IndexedDB successfully
[22m[39mStorage systems initialized successfully

[90mstdout[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2minitStorage[2m > [22m[2mshould warn if localStorage is not available
[22m[39mStorage systems initialized successfully

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2minitStorage[2m > [22m[2mshould warn if localStorage is not available
[22m[39mlocalStorage is not available

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2minitStorage[2m > [22m[2mshould handle initialization errors
[22m[39mFailed to initialize storage: Error: Init error
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:155:9
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2mgetItem[2m > [22m[2mwith ID (IndexedDB)[2m > [22m[2mshould handle IndexedDB read errors
[22m[39mFailed to get item users: Error: Read error
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:188:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2mgetItem[2m > [22m[2mwithout ID (localStorage)[2m > [22m[2mshould get JSON object from localStorage
[22m[39mFailed to get item test-key: TypeError: Cannot read properties of undefined (reading 'getItem')
    at Module.getItem [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:56:31[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:206:30
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2mgetItem[2m > [22m[2mwithout ID (localStorage)[2m > [22m[2mshould get string from localStorage
[22m[39mFailed to get item string-key: TypeError: Cannot read properties of undefined (reading 'getItem')
    at Module.getItem [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:56:31[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:215:30
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2mgetItem[2m > [22m[2mwithout ID (localStorage)[2m > [22m[2mshould return undefined when key not found
[22m[39mFailed to get item non-existent: TypeError: Cannot read properties of undefined (reading 'getItem')
    at Module.getItem [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:56:31[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:223:30
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2mgetItem[2m > [22m[2mwithout ID (localStorage)[2m > [22m[2mshould handle invalid JSON gracefully
[22m[39mFailed to get item bad-json: TypeError: Cannot read properties of undefined (reading 'getItem')
    at Module.getItem [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:56:31[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:231:30
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2mgetItem[2m > [22m[2mwithout ID (localStorage)[2m > [22m[2mshould handle localStorage errors
[22m[39mFailed to get item error-key: TypeError: Cannot read properties of undefined (reading 'getItem')
    at Module.getItem [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:56:31[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:242:30
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2msetItem[2m > [22m[2mshould store string in localStorage
[22m[39mFailed to set item string-key: TypeError: Cannot read properties of undefined (reading 'setItem')
    at Module.setItem [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:83:18[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:255:13
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2msetItem[2m > [22m[2mshould serialize and store object in localStorage
[22m[39mFailed to set item object-key: TypeError: Cannot read properties of undefined (reading 'setItem')
    at Module.setItem [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:83:18[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:266:13
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2msetItem[2m > [22m[2mshould serialize and store array in localStorage
[22m[39mFailed to set item array-key: TypeError: Cannot read properties of undefined (reading 'setItem')
    at Module.setItem [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:83:18[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:277:13
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2msetItem[2m > [22m[2mshould store number in localStorage
[22m[39mFailed to set item number-key: TypeError: Cannot read properties of undefined (reading 'setItem')
    at Module.setItem [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:83:18[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:286:13
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2msetItem[2m > [22m[2mshould store boolean in localStorage
[22m[39mFailed to set item bool-key: TypeError: Cannot read properties of undefined (reading 'setItem')
    at Module.setItem [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:83:18[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:292:13
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2msetItem[2m > [22m[2mshould handle storage quota errors
[22m[39mFailed to set item key: TypeError: Cannot read properties of undefined (reading 'setItem')
    at Module.setItem [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:83:18[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:302:20
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2mremoveItem[2m > [22m[2mshould remove item from localStorage
[22m[39mFailed to remove item test-key: TypeError: Cannot read properties of undefined (reading 'removeItem')
    at Module.removeItem [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:99:18[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:312:13
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2mremoveItem[2m > [22m[2mshould handle removal errors
[22m[39mFailed to remove item error-key: TypeError: Cannot read properties of undefined (reading 'removeItem')
    at Module.removeItem [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:99:18[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:322:20
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2mclear[2m > [22m[2mshould clear both localStorage and IndexedDB
[22m[39mFailed to clear storage: TypeError: Cannot read properties of undefined (reading 'clear')
    at Module.clear [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:114:18[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:332:13
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2mclear[2m > [22m[2mshould handle clear errors
[22m[39mFailed to clear storage: TypeError: Cannot read properties of undefined (reading 'clear')
    at Module.clear [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:114:18[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:344:20
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2mclear[2m > [22m[2mshould call localStorage.clear before IndexedDB
[22m[39mFailed to clear storage: TypeError: Cannot read properties of undefined (reading 'clear')
    at Module.clear [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:114:18[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:362:13
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2mgetStorageInfo[2m > [22m[2mshould handle errors getting storage info
[22m[39mFailed to get storage info: Error: Info error
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:482:9
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2mIntegration[2m > [22m[2mshould work with getItem and setItem together
[22m[39mFailed to set item integration-key: TypeError: Cannot read properties of undefined (reading 'setItem')
    at Module.setItem [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:83:18[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:548:13
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2mIntegration[2m > [22m[2mshould work with setItem and removeItem together
[22m[39mFailed to set item temp-key: TypeError: Cannot read properties of undefined (reading 'setItem')
    at Module.setItem [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:83:18[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:558:13
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/offline/storage-manager.test.ts[2m > [22m[2mStorage Manager[2m > [22m[2mType Safety[2m > [22m[2mshould preserve type information for getItem
[22m[39mFailed to get item user-key: TypeError: Cannot read properties of undefined (reading 'getItem')
    at Module.getItem [90m(F:\tes 9\sistem-praktikum-pwa\[39mserver\src\lib\offline\storage-manager.ts:56:31[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\offline\storage-manager.test.ts:582:28
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

 [31mâ¯[39m server/src/__tests__/unit/offline/storage-manager.test.ts [2m([22m[2m32 tests[22m[2m | [22m[31m27 failed[39m[2m)[22m[32m 164[2mms[22m[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22minitStorage[2m > [22mshould initialize IndexedDB successfully[39m[32m 22[2mms[22m[39m
[31m     â†’ expected "spy" to be called with arguments: [ Array(1) ][90m

Number of calls: [1m0[22m
[31m[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22minitStorage[2m > [22mshould warn if localStorage is not available[39m[32m 3[2mms[22m[39m
[31m     â†’ expected "spy" to be called with arguments: [ 'localStorage is not available' ][90m

Number of calls: [1m0[22m
[31m[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22minitStorage[2m > [22mshould handle initialization errors[39m[32m 9[2mms[22m[39m
[31m     â†’ expected "spy" to be called with arguments: [ â€¦(2) ][90m

Number of calls: [1m0[22m
[31m[39m
   [32mâœ“[39m Storage Manager[2m > [22mgetItem[2m > [22mwith ID (IndexedDB)[2m > [22mshould fetch from IndexedDB when ID is provided[32m 3[2mms[22m[39m
   [32mâœ“[39m Storage Manager[2m > [22mgetItem[2m > [22mwith ID (IndexedDB)[2m > [22mshould return undefined when IndexedDB item not found[32m 1[2mms[22m[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22mgetItem[2m > [22mwith ID (IndexedDB)[2m > [22mshould handle IndexedDB read errors[39m[32m 3[2mms[22m[39m
[31m     â†’ expected "spy" to be called with arguments: [ 'Failed to get item users:', â€¦(1) ][90m

Number of calls: [1m0[22m
[31m[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22mgetItem[2m > [22mwithout ID (localStorage)[2m > [22mshould get JSON object from localStorage[39m[32m 8[2mms[22m[39m
[31m     â†’ expected undefined to deeply equal { id: 1, name: 'Test' }[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22mgetItem[2m > [22mwithout ID (localStorage)[2m > [22mshould get string from localStorage[39m[32m 6[2mms[22m[39m
[31m     â†’ expected undefined to be 'simple-string' // Object.is equality[39m
   [32mâœ“[39m Storage Manager[2m > [22mgetItem[2m > [22mwithout ID (localStorage)[2m > [22mshould return undefined when key not found[32m 2[2mms[22m[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22mgetItem[2m > [22mwithout ID (localStorage)[2m > [22mshould handle invalid JSON gracefully[39m[32m 4[2mms[22m[39m
[31m     â†’ expected undefined to be 'invalid-json{' // Object.is equality[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22mgetItem[2m > [22mwithout ID (localStorage)[2m > [22mshould handle localStorage errors[39m[32m 3[2mms[22m[39m
[31m     â†’ expected "spy" to be called with arguments: [ â€¦(2) ][90m

Number of calls: [1m0[22m
[31m[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22msetItem[2m > [22mshould store string in localStorage[39m[32m 2[2mms[22m[39m
[31m     â†’ Cannot read properties of undefined (reading 'setItem')[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22msetItem[2m > [22mshould serialize and store object in localStorage[39m[32m 4[2mms[22m[39m
[31m     â†’ Cannot read properties of undefined (reading 'setItem')[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22msetItem[2m > [22mshould serialize and store array in localStorage[39m[32m 2[2mms[22m[39m
[31m     â†’ Cannot read properties of undefined (reading 'setItem')[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22msetItem[2m > [22mshould store number in localStorage[39m[32m 2[2mms[22m[39m
[31m     â†’ Cannot read properties of undefined (reading 'setItem')[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22msetItem[2m > [22mshould store boolean in localStorage[39m[32m 2[2mms[22m[39m
[31m     â†’ Cannot read properties of undefined (reading 'setItem')[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22msetItem[2m > [22mshould handle storage quota errors[39m[32m 9[2mms[22m[39m
[31m     â†’ expected [Function] to throw error including 'Quota exceeded' but got 'Cannot read properties of undefined (â€¦'[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22mremoveItem[2m > [22mshould remove item from localStorage[39m[32m 42[2mms[22m[39m
[31m     â†’ Cannot read properties of undefined (reading 'removeItem')[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22mremoveItem[2m > [22mshould handle removal errors[39m[32m 7[2mms[22m[39m
[31m     â†’ expected [Function] to throw error including 'Remove error' but got 'Cannot read properties of undefined (â€¦'[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22mclear[2m > [22mshould clear both localStorage and IndexedDB[39m[32m 1[2mms[22m[39m
[31m     â†’ Cannot read properties of undefined (reading 'clear')[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22mclear[2m > [22mshould handle clear errors[39m[32m 3[2mms[22m[39m
[31m     â†’ expected [Function] to throw error including 'Clear error' but got 'Cannot read properties of undefined (â€¦'[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22mclear[2m > [22mshould call localStorage.clear before IndexedDB[39m[32m 1[2mms[22m[39m
[31m     â†’ Cannot read properties of undefined (reading 'clear')[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22misStorageAvailable[2m > [22mshould return true when both storages are available[39m[32m 3[2mms[22m[39m
[31m     â†’ expected false to be true // Object.is equality[39m
   [32mâœ“[39m Storage Manager[2m > [22misStorageAvailable[2m > [22mshould return false when localStorage throws error[32m 1[2mms[22m[39m
   [32mâœ“[39m Storage Manager[2m > [22misStorageAvailable[2m > [22mshould return false when IndexedDB is not ready[32m 0[2mms[22m[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22mgetStorageInfo[2m > [22mshould return storage usage information[39m[32m 1[2mms[22m[39m
[31m     â†’ Object.defineProperty called on non-object[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22mgetStorageInfo[2m > [22mshould handle empty localStorage[39m[32m 1[2mms[22m[39m
[31m     â†’ Cannot convert undefined or null to object[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22mgetStorageInfo[2m > [22mshould handle errors getting storage info[39m[32m 3[2mms[22m[39m
[31m     â†’ expected "spy" to be called with arguments: [ 'Failed to get storage info:', â€¦(1) ][90m

Number of calls: [1m0[22m
[31m[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22mgetStorageInfo[2m > [22mshould calculate localStorage size correctly[39m[32m 1[2mms[22m[39m
[31m     â†’ Cannot convert undefined or null to object[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22mIntegration[2m > [22mshould work with getItem and setItem together[39m[32m 1[2mms[22m[39m
[31m     â†’ Cannot read properties of undefined (reading 'setItem')[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22mIntegration[2m > [22mshould work with setItem and removeItem together[39m[32m 1[2mms[22m[39m
[31m     â†’ Cannot read properties of undefined (reading 'setItem')[39m
[31m   [31mÃ—[31m Storage Manager[2m > [22mType Safety[2m > [22mshould preserve type information for getItem[39m[32m 3[2mms[22m[39m
[31m     â†’ expected undefined to deeply equal { id: 1, name: 'Test User', â€¦(1) }[39m
[90mstdout[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Dashboard Stats[2m > [22m[2mgetDosenStats[2m > [22m[2mshould return stats for authenticated dosen
[22m[39mðŸ” DEBUG getDosenId: user = user-1

[90mstdout[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Dashboard Stats[2m > [22m[2mgetDosenStats[2m > [22m[2mshould return stats for authenticated dosen
[22m[39mðŸ” DEBUG getDosenId: dosen query result = {
  data: { id: [32m'dosen-1'[39m, user_id: [32m'user-1'[39m, nidn: [32m'1234567890'[39m },
  error: [1mnull[22m
}

[90mstderr[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Dashboard Stats[2m > [22m[2mgetDosenStats[2m > [22m[2mshould return stats for authenticated dosen
[22m[39mError fetching dosen stats: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).eq is not a function
    at ttl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\dosen.api.ts:275:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m

[90mstderr[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Dashboard Stats[2m > [22m[2mgetDosenStats[2m > [22m[2mshould handle errors gracefully
[22m[39mError fetching dosen stats: TypeError: Cannot read properties of undefined (reading 'select')
    at ttl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\dosen.api.ts:245:35[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m

[90mstdout[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Dashboard Stats[2m > [22m[2mgetDosenStats[2m > [22m[2mshould use cached dosen ID on subsequent calls
[22m[39mðŸ” DEBUG getDosenId: user = user-1

[90mstdout[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Dashboard Stats[2m > [22m[2mgetDosenStats[2m > [22m[2mshould use cached dosen ID on subsequent calls
[22m[39mðŸ” DEBUG getDosenId: dosen query result = {
  data: { id: [32m'dosen-1'[39m, user_id: [32m'user-1'[39m, nidn: [32m'1234567890'[39m },
  error: [1mnull[22m
}

[90mstdout[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould return kelas with stats for dosen
[22m[39mðŸ” DEBUG getMyKelas: Getting ALL available kelas

[90mstderr[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould return kelas with stats for dosen
[22m[39mError fetching my kelas: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).in is not a function
    at Module.getMyKelas [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\dosen.api.ts:358:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\dosen.api.test.ts:335:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20

[90mstdout[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould return kelas with stats for dosen
[22m[39mðŸ“š DEBUG: Found 1 total active kelas
ðŸ” DEBUG: Extracting 0 unique mata_kuliah_ids: []

[90mstdout[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould apply limit when provided
[22m[39mðŸ” DEBUG getMyKelas: Getting ALL available kelas

[90mstdout[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould apply limit when provided
[22m[39mðŸ“š DEBUG: Found 3 total active kelas
ðŸ” DEBUG: Extracting 0 unique mata_kuliah_ids: []

[90mstderr[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould apply limit when provided
[22m[39mError fetching my kelas: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).in is not a function
    at Module.getMyKelas [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\dosen.api.ts:358:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\dosen.api.test.ts:393:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20

[90mstdout[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould return empty array when no dosen ID
[22m[39mðŸ” DEBUG getMyKelas: Getting ALL available kelas

[90mstdout[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould return empty array when no dosen ID
[22m[39mâš ï¸ DEBUG: No kelas found in database

[90mstdout[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould handle duplicate kelas correctly
[22m[39mðŸ” DEBUG getMyKelas: Getting ALL available kelas

[90mstdout[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould handle duplicate kelas correctly
[22m[39mðŸ“š DEBUG: Found 3 total active kelas
ðŸ” DEBUG: Extracting 0 unique mata_kuliah_ids: []

[90mstderr[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Kelas Management[2m > [22m[2mgetMyKelas[2m > [22m[2mshould handle duplicate kelas correctly
[22m[39mError fetching my kelas: TypeError: __vite_ssr_import_0__.supabase.from(...).select(...).in is not a function
    at Module.getMyKelas [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\dosen.api.ts:358:8[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\dosen.api.test.ts:453:22
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20

[90mstderr[2m | src/__tests__/unit/api/dosen.api.test.ts[2m > [22m[2mDosen API - Student Management[2m > [22m[2mgetKelasStudents[2m > [22m[2mshould handle database errors gracefully
[22m[39mError fetching kelas students: Error: DB Error
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\dosen.api.test.ts:653:18
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

 [31mâ¯[39m src/__tests__/unit/api/dosen.api.test.ts [2m([22m[2m19 tests[22m[2m | [22m[31m4 failed[39m[2m | [22m[33m1 skipped[39m[2m)[22m[32m 157[2mms[22m[39m
[31m   [31mÃ—[31m Dosen API - Dashboard Stats[2m > [22mgetDosenStats[2m > [22mshould return stats for authenticated dosen[39m[32m 39[2mms[22m[39m
[31m     â†’ expected { totalKelas: +0, â€¦(3) } to deeply equal { totalKelas: 5, â€¦(3) }[39m
   [32mâœ“[39m Dosen API - Dashboard Stats[2m > [22mgetDosenStats[2m > [22mshould return zero stats when no dosen found[32m 2[2mms[22m[39m
   [32mâœ“[39m Dosen API - Dashboard Stats[2m > [22mgetDosenStats[2m > [22mshould handle errors gracefully[32m 2[2mms[22m[39m
   [32mâœ“[39m Dosen API - Dashboard Stats[2m > [22mgetDosenStats[2m > [22mshould use cached dosen ID on subsequent calls[32m 33[2mms[22m[39m
[31m   [31mÃ—[31m Dosen API - Kelas Management[2m > [22mgetMyKelas[2m > [22mshould return kelas with stats for dosen[39m[32m 10[2mms[22m[39m
[31m     â†’ expected [] to have a length of 1 but got +0[39m
[31m   [31mÃ—[31m Dosen API - Kelas Management[2m > [22mgetMyKelas[2m > [22mshould apply limit when provided[39m[32m 5[2mms[22m[39m
[31m     â†’ expected [] to have a length of 2 but got +0[39m
   [32mâœ“[39m Dosen API - Kelas Management[2m > [22mgetMyKelas[2m > [22mshould return empty array when no dosen ID[32m 2[2mms[22m[39m
[31m   [31mÃ—[31m Dosen API - Kelas Management[2m > [22mgetMyKelas[2m > [22mshould handle duplicate kelas correctly[39m[32m 6[2mms[22m[39m
[31m     â†’ expected [] to have a length of 2 but got +0[39m
   [32mâœ“[39m Dosen API - Kelas Management[2m > [22mgetMyMataKuliah[2m > [22mshould return mata kuliah with aggregated stats[32m 5[2mms[22m[39m
   [32mâœ“[39m Dosen API - Kelas Management[2m > [22mgetMyMataKuliah[2m > [22mshould apply limit when provided[32m 24[2mms[22m[39m
   [32mâœ“[39m Dosen API - Student Management[2m > [22mgetKelasStudents[2m > [22mshould return students for a kelas[32m 3[2mms[22m[39m
   [32mâœ“[39m Dosen API - Student Management[2m > [22mgetKelasStudents[2m > [22mshould return empty array when no students[32m 1[2mms[22m[39m
   [32mâœ“[39m Dosen API - Student Management[2m > [22mgetKelasStudents[2m > [22mshould handle database errors gracefully[32m 3[2mms[22m[39m
   [2m[90mâ†“[39m[22m Dosen API - Student Management[2m > [22mgetStudentStats[2m > [22mshould return aggregated student statistics
   [32mâœ“[39m Dosen API - Student Management[2m > [22mgetStudentStats[2m > [22mshould handle no kelas scenario[32m 2[2mms[22m[39m
   [32mâœ“[39m Dosen API - Grading Operations[2m > [22mgetPendingGrading[2m > [22mshould return pending grading items[32m 2[2mms[22m[39m
   [32mâœ“[39m Dosen API - Grading Operations[2m > [22mgetPendingGrading[2m > [22mshould apply limit when provided[32m 2[2mms[22m[39m
   [32mâœ“[39m Dosen API - Grading Operations[2m > [22mgetActiveKuis[2m > [22mshould return active quizzes with stats[32m 7[2mms[22m[39m
   [32mâœ“[39m Dosen API - Grading Operations[2m > [22mgetActiveKuis[2m > [22mshould apply limit when provided[32m 4[2mms[22m[39m
[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould fetch all users with role-specific data
[22m[39mðŸ” DEBUG: checkPermission called: view:all_users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould map mahasiswa NIM correctly
[22m[39mðŸ” DEBUG: checkPermission called: view:all_users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould map dosen NIP and NIDN correctly
[22m[39mðŸ” DEBUG: checkPermission called: view:all_users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould handle empty users list
[22m[39mðŸ” DEBUG: checkPermission called: view:all_users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould handle null users data
[22m[39mðŸ” DEBUG: checkPermission called: view:all_users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould provide default values for missing data
[22m[39mðŸ” DEBUG: checkPermission called: view:all_users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould handle database errors gracefully
[22m[39mðŸ” DEBUG: checkPermission called: view:all_users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Statistics[2m > [22m[2mgetUserStats[2m > [22m[2mshould calculate user statistics correctly
[22m[39mðŸ” DEBUG: checkPermission called: view:all_users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Statistics[2m > [22m[2mgetUserStats[2m > [22m[2mshould return zero stats when no users
[22m[39mðŸ” DEBUG: checkPermission called: view:all_users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Statistics[2m > [22m[2mgetUserStats[2m > [22m[2mshould handle errors and return zero stats
[22m[39mðŸ” DEBUG: checkPermission called: view:all_users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mtoggleUserStatus[2m > [22m[2mshould activate user
[22m[39mðŸ” DEBUG: checkPermission called: manage:users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mtoggleUserStatus[2m > [22m[2mshould deactivate user
[22m[39mðŸ” DEBUG: checkPermission called: manage:users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mtoggleUserStatus[2m > [22m[2mshould handle errors
[22m[39mðŸ” DEBUG: checkPermission called: manage:users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mupdateUser[2m > [22m[2mshould update user data
[22m[39mðŸ” DEBUG: checkPermission called: manage:users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mupdateUser[2m > [22m[2mshould update user role
[22m[39mðŸ” DEBUG: checkPermission called: manage:users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mcreateUser - COMPLEX FLOW[2m > [22m[2mshould create admin user successfully
[22m[39mðŸ” DEBUG: checkPermission called: manage:users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mcreateUser - COMPLEX FLOW[2m > [22m[2mshould create mahasiswa with role-specific data
[22m[39mðŸ” DEBUG: checkPermission called: manage:users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mcreateUser - COMPLEX FLOW[2m > [22m[2mshould create dosen with NIP and NIDN
[22m[39mðŸ” DEBUG: checkPermission called: manage:users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mcreateUser - COMPLEX FLOW[2m > [22m[2mshould handle signup errors
[22m[39mðŸ” DEBUG: checkPermission called: manage:users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mcreateUser - COMPLEX FLOW[2m > [22m[2mshould handle missing user data after signup
[22m[39mðŸ” DEBUG: checkPermission called: manage:users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete mahasiswa from role table then users table
[22m[39mðŸ” DEBUG: checkPermission called: manage:users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete dosen from role table then users table
[22m[39mðŸ” DEBUG: checkPermission called: manage:users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete laboran from role table then users table
[22m[39mðŸ” DEBUG: checkPermission called: manage:users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould fail if role-specific delete fails
[22m[39mðŸ” DEBUG: checkPermission called: manage:users

[90mstdout[2m | server/src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould handle user not found
[22m[39mðŸ” DEBUG: checkPermission called: manage:users

 [31mâ¯[39m server/src/__tests__/unit/api/users.api.test.ts [2m([22m[2m25 tests[22m[2m | [22m[31m21 failed[39m[2m)[22m[32m 155[2mms[22m[39m
[31m   [31mÃ—[31m Users API - Get All Users[2m > [22mgetAllUsers[2m > [22mshould fetch all users with role-specific data[39m[32m 21[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Users API - Get All Users[2m > [22mgetAllUsers[2m > [22mshould map mahasiswa NIM correctly[39m[32m 4[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Users API - Get All Users[2m > [22mgetAllUsers[2m > [22mshould map dosen NIP and NIDN correctly[39m[32m 3[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Users API - Get All Users[2m > [22mgetAllUsers[2m > [22mshould handle empty users list[39m[32m 3[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Users API - Get All Users[2m > [22mgetAllUsers[2m > [22mshould handle null users data[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Users API - Get All Users[2m > [22mgetAllUsers[2m > [22mshould provide default values for missing data[39m[32m 3[2mms[22m[39m
[31m     â†’ User not authenticated[39m
   [32mâœ“[39m Users API - Get All Users[2m > [22mgetAllUsers[2m > [22mshould handle database errors gracefully[32m 6[2mms[22m[39m
[31m   [31mÃ—[31m Users API - Statistics[2m > [22mgetUserStats[2m > [22mshould calculate user statistics correctly[39m[32m 5[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Users API - Statistics[2m > [22mgetUserStats[2m > [22mshould return zero stats when no users[39m[32m 6[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Users API - Statistics[2m > [22mgetUserStats[2m > [22mshould handle errors and return zero stats[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Users API - CRUD Operations[2m > [22mtoggleUserStatus[2m > [22mshould activate user[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Users API - CRUD Operations[2m > [22mtoggleUserStatus[2m > [22mshould deactivate user[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
   [32mâœ“[39m Users API - CRUD Operations[2m > [22mtoggleUserStatus[2m > [22mshould handle errors[32m 3[2mms[22m[39m
[31m   [31mÃ—[31m Users API - CRUD Operations[2m > [22mupdateUser[2m > [22mshould update user data[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Users API - CRUD Operations[2m > [22mupdateUser[2m > [22mshould update user role[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Users API - CRUD Operations[2m > [22mcreateUser - COMPLEX FLOW[2m > [22mshould create admin user successfully[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Users API - CRUD Operations[2m > [22mcreateUser - COMPLEX FLOW[2m > [22mshould create mahasiswa with role-specific data[39m[32m 5[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Users API - CRUD Operations[2m > [22mcreateUser - COMPLEX FLOW[2m > [22mshould create dosen with NIP and NIDN[39m[32m 3[2mms[22m[39m
[31m     â†’ User not authenticated[39m
   [32mâœ“[39m Users API - CRUD Operations[2m > [22mcreateUser - COMPLEX FLOW[2m > [22mshould handle signup errors[32m 6[2mms[22m[39m
[31m   [31mÃ—[31m Users API - CRUD Operations[2m > [22mcreateUser - COMPLEX FLOW[2m > [22mshould handle missing user data after signup[39m[32m 45[2mms[22m[39m
[31m     â†’ expected [Function] to throw error including 'Failed to create user' but got 'User not authenticated'[39m
[31m   [31mÃ—[31m Users API - CRUD Operations[2m > [22mdeleteUser - CASCADE DELETE[2m > [22mshould delete mahasiswa from role table then users table[39m[32m 7[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Users API - CRUD Operations[2m > [22mdeleteUser - CASCADE DELETE[2m > [22mshould delete dosen from role table then users table[39m[32m 3[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Users API - CRUD Operations[2m > [22mdeleteUser - CASCADE DELETE[2m > [22mshould delete laboran from role table then users table[39m[32m 3[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Users API - CRUD Operations[2m > [22mdeleteUser - CASCADE DELETE[2m > [22mshould fail if role-specific delete fails[39m[32m 5[2mms[22m[39m
[31m     â†’ expected [Function] to throw error including 'Failed to delete mahasiswa record' but got 'User not authenticated'[39m
   [32mâœ“[39m Users API - CRUD Operations[2m > [22mdeleteUser - CASCADE DELETE[2m > [22mshould handle user not found[32m 2[2mms[22m[39m
[90mstdout[2m | server/src/__tests__/unit/api/mahasiswa.api.test.ts[2m > [22m[2mMahasiswa API[2m > [22m[2mgetMahasiswaStats[2m > [22m[2mshould return mahasiswa statistics successfully
[22m[39mðŸ”„ Upgrading IndexedDB from v0 to v2
âœ… Created store: kuis
âœ… Created store: kuis_soal
âœ… Created store: kuis_jawaban
âœ… Created store: nilai
âœ… Created store: materi
âœ… Created store: kelas
âœ… Created store: users
âœ… Created store: sync_queue
âœ… Created store: metadata
âœ… Created store: offline_quiz
âœ… Created store: offline_questions
âœ… Created store: offline_answers
âœ… Created store: offline_attempts

[90mstdout[2m | server/src/__tests__/unit/api/mahasiswa.api.test.ts[2m > [22m[2mMahasiswa API[2m > [22m[2mgetMahasiswaStats[2m > [22m[2mshould return mahasiswa statistics successfully
[22m[39mâœ… IndexedDB initialized successfully

[90mstdout[2m | server/src/__tests__/unit/api/mahasiswa.api.test.ts[2m > [22m[2mMahasiswa API[2m > [22m[2mgetMahasiswaStats[2m > [22m[2mshould return mahasiswa statistics successfully
[22m[39m[API Cache] MISS: mahasiswa_stats (fetching...)

[90mstdout[2m | server/src/__tests__/unit/api/mahasiswa.api.test.ts[2m > [22m[2mMahasiswa API[2m > [22m[2mgetMahasiswaStats[2m > [22m[2mshould return mahasiswa statistics successfully
[22m[39m[API Cache] Cached: mahasiswa_stats (TTL: 300000ms)

[90mstdout[2m | server/src/__tests__/unit/api/mahasiswa.api.test.ts[2m > [22m[2mMahasiswa API[2m > [22m[2mgetMahasiswaStats[2m > [22m[2mshould return zero stats when mahasiswa not found
[22m[39m[API Cache] HIT: mahasiswa_stats

[90mstdout[2m | server/src/__tests__/unit/api/mahasiswa.api.test.ts[2m > [22m[2mMahasiswa API[2m > [22m[2mgetMahasiswaStats[2m > [22m[2mshould calculate average score correctly
[22m[39m[API Cache] HIT: mahasiswa_stats

[90mstdout[2m | server/src/__tests__/unit/api/mahasiswa.api.test.ts[2m > [22m[2mMahasiswa API[2m > [22m[2mgetMahasiswaStats[2m > [22m[2mshould handle errors gracefully
[22m[39m[API Cache] HIT: mahasiswa_stats

 [31mâ¯[39m server/src/__tests__/unit/api/mahasiswa.api.test.ts [2m([22m[2m19 tests[22m[2m | [22m[31m8 failed[39m[2m)[22m[32m 123[2mms[22m[39m
[31m   [31mÃ—[31m Mahasiswa API[2m > [22mgetMahasiswaStats[2m > [22mshould return mahasiswa statistics successfully[39m[32m 65[2mms[22m[39m
[31m     â†’ expected { totalKelasPraktikum: +0, â€¦(3) } to deeply equal { totalKelasPraktikum: 2, â€¦(3) }[39m
   [32mâœ“[39m Mahasiswa API[2m > [22mgetMahasiswaStats[2m > [22mshould return zero stats when mahasiswa not found[32m 3[2mms[22m[39m
[31m   [31mÃ—[31m Mahasiswa API[2m > [22mgetMahasiswaStats[2m > [22mshould calculate average score correctly[39m[32m 4[2mms[22m[39m
[31m     â†’ expected null to be 80 // Object.is equality[39m
   [32mâœ“[39m Mahasiswa API[2m > [22mgetMahasiswaStats[2m > [22mshould handle errors gracefully[32m 3[2mms[22m[39m
   [32mâœ“[39m Mahasiswa API[2m > [22mgetAvailableKelas[2m > [22mshould return available kelas for enrollment[32m 2[2mms[22m[39m
   [32mâœ“[39m Mahasiswa API[2m > [22mgetAvailableKelas[2m > [22mshould return empty array when mahasiswa not found[32m 1[2mms[22m[39m
   [32mâœ“[39m Mahasiswa API[2m > [22mgetAvailableKelas[2m > [22mshould handle database errors[32m 1[2mms[22m[39m
[31m   [31mÃ—[31m Mahasiswa API[2m > [22menrollToKelas[2m > [22mshould enroll mahasiswa to kelas successfully[39m[32m 3[2mms[22m[39m
[31m     â†’ expected false to be true // Object.is equality[39m
   [32mâœ“[39m Mahasiswa API[2m > [22menrollToKelas[2m > [22mshould fail when mahasiswa not found[32m 1[2mms[22m[39m
[31m   [31mÃ—[31m Mahasiswa API[2m > [22menrollToKelas[2m > [22mshould fail when already enrolled[39m[32m 6[2mms[22m[39m
[31m     â†’ expected 'Mahasiswa tidak ditemukan' to be 'Anda sudah terdaftar di kelas ini' // Object.is equality[39m
[31m   [31mÃ—[31m Mahasiswa API[2m > [22menrollToKelas[2m > [22mshould fail when kelas is full[39m[32m 2[2mms[22m[39m
[31m     â†’ expected 'Mahasiswa tidak ditemukan' to be 'Kelas sudah penuh' // Object.is equality[39m
[31m   [31mÃ—[31m Mahasiswa API[2m > [22munenrollFromKelas[2m > [22mshould unenroll mahasiswa from kelas successfully[39m[32m 2[2mms[22m[39m
[31m     â†’ expected false to be true // Object.is equality[39m
   [32mâœ“[39m Mahasiswa API[2m > [22munenrollFromKelas[2m > [22mshould fail when mahasiswa not found[32m 1[2mms[22m[39m
   [32mâœ“[39m Mahasiswa API[2m > [22munenrollFromKelas[2m > [22mshould handle database errors[32m 1[2mms[22m[39m
[31m   [31mÃ—[31m Mahasiswa API[2m > [22mgetMyKelas[2m > [22mshould return enrolled kelas list[39m[32m 18[2mms[22m[39m
[31m     â†’ expected [] to have a length of 1 but got +0[39m
   [32mâœ“[39m Mahasiswa API[2m > [22mgetMyKelas[2m > [22mshould return empty array when mahasiswa not found[32m 1[2mms[22m[39m
   [32mâœ“[39m Mahasiswa API[2m > [22mgetMyJadwal[2m > [22mshould return jadwal for next 7 days[32m 2[2mms[22m[39m
   [32mâœ“[39m Mahasiswa API[2m > [22mgetMyJadwal[2m > [22mshould return empty array when not enrolled in any kelas[32m 1[2mms[22m[39m
[31m   [31mÃ—[31m Mahasiswa API[2m > [22mgetMyJadwal[2m > [22mshould respect limit parameter[39m[32m 2[2mms[22m[39m
[31m     â†’ expected "spy" to be called with arguments: [ 5 ][90m

Number of calls: [1m0[22m
[31m[39m
[90mstdout[2m | server/src/__tests__/unit/api/sync.api.test.ts[2m > [22m[2mSync API[2m > [22m[2mgetSyncManagementStats[2m > [22m[2mshould return sync statistics
[22m[39mðŸ”„ Upgrading IndexedDB from v0 to v2
âœ… Created store: kuis
âœ… Created store: kuis_soal
âœ… Created store: kuis_jawaban
âœ… Created store: nilai
âœ… Created store: materi
âœ… Created store: kelas
âœ… Created store: users
âœ… Created store: sync_queue
âœ… Created store: metadata
âœ… Created store: offline_quiz
âœ… Created store: offline_questions
âœ… Created store: offline_answers
âœ… Created store: offline_attempts

[90mstdout[2m | server/src/__tests__/unit/api/sync.api.test.ts[2m > [22m[2mSync API[2m > [22m[2mgetSyncManagementStats[2m > [22m[2mshould return sync statistics
[22m[39mâœ… IndexedDB initialized successfully

[90mstdout[2m | server/src/__tests__/unit/api/sync.api.test.ts[2m > [22m[2mSync API[2m > [22m[2mgetSyncManagementStats[2m > [22m[2mshould return sync statistics
[22m[39mâœ… QueueManager initialized

[90mstdout[2m | server/src/__tests__/unit/api/sync.api.test.ts[2m > [22m[2mSync API[2m > [22m[2mforceSyncNow[2m > [22m[2mshould trigger sync process
[22m[39mðŸ” DEBUG: checkPermission called: manage:sync

[90mstdout[2m | server/src/__tests__/unit/api/sync.api.test.ts[2m > [22m[2mSync API[2m > [22m[2mforceSyncNow[2m > [22m[2mshould handle sync errors
[22m[39mðŸ” DEBUG: checkPermission called: manage:sync

 [31mâ¯[39m server/src/__tests__/unit/api/sync.api.test.ts [2m([22m[2m4 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 59[2mms[22m[39m
[31m   [31mÃ—[31m Sync API[2m > [22mgetSyncManagementStats[2m > [22mshould return sync statistics[39m[32m 43[2mms[22m[39m
[31m     â†’ expected { pendingSync: +0, synced: +0, â€¦(5) } to have property "pendingSync" with value 10[39m
   [32mâœ“[39m Sync API[2m > [22mgetSyncManagementStats[2m > [22mshould handle errors gracefully[32m 1[2mms[22m[39m
[31m   [31mÃ—[31m Sync API[2m > [22mforceSyncNow[2m > [22mshould trigger sync process[39m[32m 5[2mms[22m[39m
[31m     â†’ User not authenticated[39m
   [32mâœ“[39m Sync API[2m > [22mforceSyncNow[2m > [22mshould handle sync errors[32m 5[2mms[22m[39m
 [31mâ¯[39m src/__tests__/unit/validations/kuis.schema.test.ts [2m([22m[2m31 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 96[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mcreateKuisSchema[2m > [22mshould validate correct quiz data[32m 10[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mcreateKuisSchema[2m > [22mshould reject judul shorter than 5 characters[32m 2[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mcreateKuisSchema[2m > [22mshould reject durasi below minimum[32m 1[2mms[22m[39m
[31m   [31mÃ—[31m Kuis Validation Schemas[2m > [22mcreateKuisSchema[2m > [22mshould reject durasi above maximum[39m[32m 19[2mms[22m[39m
[31m     â†’ expected true to be false // Object.is equality[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mcreateKuisSchema[2m > [22mshould reject invalid UUID for kelas_id[32m 32[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mcreateKuisSchema[2m > [22mshould accept optional fields as null[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mupdateKuisSchema[2m > [22mshould validate quiz update[32m 3[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mupdateKuisSchema[2m > [22mshould validate tanggal_selesai after tanggal_mulai[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mupdateKuisSchema[2m > [22mshould allow partial updates[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mcreateSoalPilihanGandaSchema[2m > [22mshould validate multiple choice question[32m 3[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mcreateSoalPilihanGandaSchema[2m > [22mshould reject with less than 2 options[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mcreateSoalPilihanGandaSchema[2m > [22mshould reject with no correct answer[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mcreateSoalPilihanGandaSchema[2m > [22mshould reject with multiple correct answers[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mcreateSoalBenarSalahSchema[2m > [22mshould validate true/false question[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mcreateSoalBenarSalahSchema[2m > [22mshould reject invalid jawaban_benar[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mcreateSoalEssaySchema[2m > [22mshould validate essay question[32m 2[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mcreateSoalEssaySchema[2m > [22mshould allow empty jawaban_benar for essay[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mcreateSoalJawabanSingkatSchema[2m > [22mshould validate short answer question[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mcreateSoalJawabanSingkatSchema[2m > [22mshould reject empty jawaban_benar[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mstartAttemptSchema[2m > [22mshould validate start attempt data[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mstartAttemptSchema[2m > [22mshould reject invalid UUID[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22msubmitAnswerSchema[2m > [22mshould validate submit answer data[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22msubmitAnswerSchema[2m > [22mshould reject empty jawaban[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22msubmitAnswerSchema[2m > [22mshould reject jawaban longer than 5000 characters[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22msubmitQuizSchema[2m > [22mshould validate submit quiz data[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22msubmitQuizSchema[2m > [22mshould reject negative time_spent[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22msubmitQuizSchema[2m > [22mshould reject non-integer time_spent[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mVALIDATION_CONSTANTS[2m > [22mshould export all validation constants[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mEdge Cases[2m > [22mshould handle pertanyaan at minimum length[32m 0[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mEdge Cases[2m > [22mshould reject pertanyaan shorter than minimum[32m 1[2mms[22m[39m
   [32mâœ“[39m Kuis Validation Schemas[2m > [22mEdge Cases[2m > [22mshould handle poin at boundaries[32m 1[2mms[22m[39m
[90mstdout[2m | server/src/__tests__/unit/api/mata-kuliah.api.test.ts[2m > [22m[2mMata Kuliah API[2m > [22m[2mcreateMataKuliah[2m > [22m[2mshould create new mata kuliah
[22m[39mðŸ” DEBUG: checkPermission called: manage:mata_kuliah

[90mstdout[2m | server/src/__tests__/unit/api/mata-kuliah.api.test.ts[2m > [22m[2mMata Kuliah API[2m > [22m[2mcreateMataKuliah[2m > [22m[2mshould reject duplicate kode_mk
[22m[39mðŸ” DEBUG: checkPermission called: manage:mata_kuliah

[90mstdout[2m | server/src/__tests__/unit/api/mata-kuliah.api.test.ts[2m > [22m[2mMata Kuliah API[2m > [22m[2mupdateMataKuliah[2m > [22m[2mshould update mata kuliah
[22m[39mðŸ” DEBUG: checkPermission called: manage:mata_kuliah

[90mstdout[2m | server/src/__tests__/unit/api/mata-kuliah.api.test.ts[2m > [22m[2mMata Kuliah API[2m > [22m[2mdeleteMataKuliah[2m > [22m[2mshould delete when no kelas
[22m[39mðŸ” DEBUG: checkPermission called: manage:mata_kuliah

[90mstdout[2m | server/src/__tests__/unit/api/mata-kuliah.api.test.ts[2m > [22m[2mMata Kuliah API[2m > [22m[2mdeleteMataKuliah[2m > [22m[2mshould detach kelas and delete when kelas exist by default
[22m[39mðŸ” DEBUG: checkPermission called: manage:mata_kuliah

 [31mâ¯[39m server/src/__tests__/unit/api/mata-kuliah.api.test.ts [2m([22m[2m9 tests[22m[2m | [22m[31m5 failed[39m[2m)[22m[32m 61[2mms[22m[39m
   [32mâœ“[39m Mata Kuliah API[2m > [22mgetMataKuliah[2m > [22mshould fetch all mata kuliah[32m 5[2mms[22m[39m
   [32mâœ“[39m Mata Kuliah API[2m > [22mgetMataKuliah[2m > [22mshould apply filters[32m 1[2mms[22m[39m
   [32mâœ“[39m Mata Kuliah API[2m > [22mgetMataKuliahById[2m > [22mshould fetch single mata kuliah[32m 2[2mms[22m[39m
[31m   [31mÃ—[31m Mata Kuliah API[2m > [22mcreateMataKuliah[2m > [22mshould create new mata kuliah[39m[32m 15[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Mata Kuliah API[2m > [22mcreateMataKuliah[2m > [22mshould reject duplicate kode_mk[39m[32m 27[2mms[22m[39m
[31m     â†’ expected [Function] to throw error including 'sudah ada' but got 'User not authenticated'[39m
[31m   [31mÃ—[31m Mata Kuliah API[2m > [22mupdateMataKuliah[2m > [22mshould update mata kuliah[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Mata Kuliah API[2m > [22mdeleteMataKuliah[2m > [22mshould delete when no kelas[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Mata Kuliah API[2m > [22mdeleteMataKuliah[2m > [22mshould detach kelas and delete when kelas exist by default[39m[32m 1[2mms[22m[39m
[31m     â†’ User not authenticated[39m
   [32mâœ“[39m Mata Kuliah API[2m > [22mgetMataKuliahStats[2m > [22mshould calculate statistics[32m 2[2mms[22m[39m
 [31mâ¯[39m server/src/__tests__/unit/api/admin.api.test.ts [2m([22m[2m27 tests[22m[2m | [22m[31m27 failed[39m[2m)[22m[32m 95[2mms[22m[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetDashboardStats[2m > [22mshould return dashboard statistics successfully[39m[32m 20[2mms[22m[39m
[31m     â†’ supabase.from.mockImplementation is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetDashboardStats[2m > [22mshould handle empty data gracefully[39m[32m 4[2mms[22m[39m
[31m     â†’ supabase.from.mockImplementation is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetDashboardStats[2m > [22mshould handle database errors[39m[32m 6[2mms[22m[39m
[31m     â†’ supabase.from.mockImplementation is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetDashboardStats[2m > [22mshould handle null data from database[39m[32m 2[2mms[22m[39m
[31m     â†’ supabase.from.mockImplementation is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetUserGrowth[2m > [22mshould return user growth data for last 6 months[39m[32m 3[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetUserGrowth[2m > [22mshould initialize all months with zero users[39m[32m 2[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetUserGrowth[2m > [22mshould handle users without created_at[39m[32m 6[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetUserGrowth[2m > [22mshould handle database errors[39m[32m 5[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetUserDistribution[2m > [22mshould return user distribution by role[39m[32m 4[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetUserDistribution[2m > [22mshould capitalize role names[39m[32m 1[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetUserDistribution[2m > [22mshould handle empty data[39m[32m 7[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetUserDistribution[2m > [22mshould calculate percentage correctly[39m[32m 1[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetUserDistribution[2m > [22mshould handle database errors[39m[32m 1[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetLabUsage[2m > [22mshould return lab usage data[39m[32m 1[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetLabUsage[2m > [22mshould limit to 5 labs[39m[32m 2[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetLabUsage[2m > [22mshould handle empty lab data[39m[32m 1[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetLabUsage[2m > [22mshould handle database errors[39m[32m 1[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetRecentUsers[2m > [22mshould return recent users with default limit[39m[32m 1[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetRecentUsers[2m > [22mshould accept custom limit parameter[39m[32m 2[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetRecentUsers[2m > [22mshould handle users without created_at[39m[32m 2[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetRecentUsers[2m > [22mshould handle empty data[39m[32m 2[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetRecentUsers[2m > [22mshould handle database errors[39m[32m 2[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetRecentAnnouncements[2m > [22mshould return recent announcements with author names[39m[32m 2[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetRecentAnnouncements[2m > [22mshould handle announcements with null users[39m[32m 3[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetRecentAnnouncements[2m > [22mshould accept custom limit parameter[39m[32m 2[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetRecentAnnouncements[2m > [22mshould handle empty data[39m[32m 2[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
[31m   [31mÃ—[31m Admin API[2m > [22mgetRecentAnnouncements[2m > [22mshould handle database errors[39m[32m 5[2mms[22m[39m
[31m     â†’ supabase.from.mockReturnValue is not a function[39m
 [31mâ¯[39m server/src/__tests__/unit/hooks/useSync.test.ts [2m([22m[2m34 tests[22m[2m | [22m[31m34 failed[39m[2m)[22m[32m 52[2mms[22m[39m
[31m   [31mÃ—[31m useSync[2m > [22mInitialization[2m > [22mshould initialize with default state[39m[32m 14[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mInitialization[2m > [22mshould initialize queue manager if not ready[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mInitialization[2m > [22mshould not re-initialize if already ready[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mInitialization[2m > [22mshould subscribe to queue events[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mInitialization[2m > [22mshould load initial stats[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mInitialization[2m > [22mshould mark as ready after initialization[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mInitialization[2m > [22mshould get initial processing state[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22maddToQueue[2m > [22mshould add item to queue[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22maddToQueue[2m > [22mshould refresh stats after adding[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22maddToQueue[2m > [22mshould handle different entity types[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22maddToQueue[2m > [22mshould handle different operations[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22maddToQueue[2m > [22mshould throw error on enqueue failure[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mprocessQueue[2m > [22mshould process the queue[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mprocessQueue[2m > [22mshould set processing state during queue processing[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mprocessQueue[2m > [22mshould refresh stats after processing[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mprocessQueue[2m > [22mshould reset processing state on error[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mretryFailed[2m > [22mshould retry failed items[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mretryFailed[2m > [22mshould refresh stats after retrying[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mretryFailed[2m > [22mshould return 0 on retry failure[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mclearCompleted[2m > [22mshould clear completed items[39m[32m 0[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mclearCompleted[2m > [22mshould refresh stats after clearing[39m[32m 0[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mclearCompleted[2m > [22mshould return 0 on clear failure[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mgetAllItems[2m > [22mshould get all items without filter[39m[32m 0[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mgetAllItems[2m > [22mshould get items with status filter[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mgetAllItems[2m > [22mshould return empty array on error[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mQueue Events[2m > [22mshould update processing state on processing event[39m[32m 7[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mQueue Events[2m > [22mshould update processing state on completed event[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mQueue Events[2m > [22mshould update processing state on failed event[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mQueue Events[2m > [22mshould refresh stats on queue events[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mStats[2m > [22mshould expose queue statistics[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mStats[2m > [22mshould refresh stats manually[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mCleanup[2m > [22mshould unsubscribe from queue events on unmount[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mIntegration[2m > [22mshould handle complete sync workflow[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[31m   [31mÃ—[31m useSync[2m > [22mIntegration[2m > [22mshould maintain consistent state across re-renders[39m[32m 1[2mms[22m[39m
[31m     â†’ queueManager._reset is not a function[39m
[90mstdout[2m | server/src/__tests__/unit/api/materi.api.test.ts[2m > [22m[2mMateri API[2m > [22m[2mcreateMateri[2m > [22m[2mshould upload file and create materi
[22m[39mðŸ” DEBUG: checkPermission called: manage:materi

[90mstdout[2m | server/src/__tests__/unit/api/materi.api.test.ts[2m > [22m[2mMateri API[2m > [22m[2mdeleteMateri[2m > [22m[2mshould delete file and materi record
[22m[39mðŸ” DEBUG: checkPermission called: manage:materi

 [31mâ¯[39m server/src/__tests__/unit/api/materi.api.test.ts [2m([22m[2m7 tests[22m[2m | [22m[31m2 failed[39m[2m | [22m[33m1 skipped[39m[2m)[22m[32m 40[2mms[22m[39m
   [32mâœ“[39m Materi API[2m > [22mgetMateri[2m > [22mshould fetch materi with filters[32m 6[2mms[22m[39m
   [32mâœ“[39m Materi API[2m > [22mgetMateriById[2m > [22mshould fetch single materi[32m 2[2mms[22m[39m
[31m   [31mÃ—[31m Materi API[2m > [22mcreateMateri[2m > [22mshould upload file and create materi[39m[32m 22[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Materi API[2m > [22mdeleteMateri[2m > [22mshould delete file and materi record[39m[32m 3[2mms[22m[39m
[31m     â†’ User not authenticated[39m
   [2m[90mâ†“[39m[22m Materi API[2m > [22mdownloadMateri[2m > [22mshould download file
   [32mâœ“[39m Materi API[2m > [22mpublishMateri[2m > [22mshould set is_active to true[32m 2[2mms[22m[39m
   [32mâœ“[39m Materi API[2m > [22munpublishMateri[2m > [22mshould set is_active to false[32m 1[2mms[22m[39m
[90mstdout[2m | server/src/__tests__/unit/api/analytics.api.test.ts[2m > [22m[2mAnalytics API - System Metrics[2m > [22m[2mgetSystemMetrics[2m > [22m[2mshould fetch all system metrics successfully
[22m[39mðŸ” DEBUG: checkPermission called: view:analytics

[90mstdout[2m | server/src/__tests__/unit/api/analytics.api.test.ts[2m > [22m[2mAnalytics API - System Metrics[2m > [22m[2mgetSystemMetrics[2m > [22m[2mshould determine Good health when borrowings < 50
[22m[39mðŸ” DEBUG: checkPermission called: view:analytics

[90mstdout[2m | server/src/__tests__/unit/api/analytics.api.test.ts[2m > [22m[2mAnalytics API - System Metrics[2m > [22m[2mgetSystemMetrics[2m > [22m[2mshould determine Warning health when borrowings 51-100
[22m[39mðŸ” DEBUG: checkPermission called: view:analytics

[90mstdout[2m | server/src/__tests__/unit/api/analytics.api.test.ts[2m > [22m[2mAnalytics API - System Metrics[2m > [22m[2mgetSystemMetrics[2m > [22m[2mshould determine Critical health when borrowings > 100
[22m[39mðŸ” DEBUG: checkPermission called: view:analytics

[90mstdout[2m | server/src/__tests__/unit/api/analytics.api.test.ts[2m > [22m[2mAnalytics API - System Metrics[2m > [22m[2mgetSystemMetrics[2m > [22m[2mshould handle null counts as 0
[22m[39mðŸ” DEBUG: checkPermission called: view:analytics

[90mstdout[2m | server/src/__tests__/unit/api/analytics.api.test.ts[2m > [22m[2mAnalytics API - System Metrics[2m > [22m[2mgetSystemMetrics[2m > [22m[2mshould return zero metrics on error
[22m[39mðŸ” DEBUG: checkPermission called: view:analytics

[90mstdout[2m | server/src/__tests__/unit/api/analytics.api.test.ts[2m > [22m[2mAnalytics API - System Metrics[2m > [22m[2mgetSystemMetrics[2m > [22m[2mshould filter active classes correctly
[22m[39mðŸ” DEBUG: checkPermission called: view:analytics

[90mstdout[2m | server/src/__tests__/unit/api/analytics.api.test.ts[2m > [22m[2mAnalytics API - System Metrics[2m > [22m[2mgetSystemMetrics[2m > [22m[2mshould filter pending and approved borrowings
[22m[39mðŸ” DEBUG: checkPermission called: view:analytics

 [31mâ¯[39m server/src/__tests__/unit/api/analytics.api.test.ts [2m([22m[2m8 tests[22m[2m | [22m[31m8 failed[39m[2m)[22m[32m 49[2mms[22m[39m
[31m   [31mÃ—[31m Analytics API - System Metrics[2m > [22mgetSystemMetrics[2m > [22mshould fetch all system metrics successfully[39m[32m 20[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Analytics API - System Metrics[2m > [22mgetSystemMetrics[2m > [22mshould determine Good health when borrowings < 50[39m[32m 4[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Analytics API - System Metrics[2m > [22mgetSystemMetrics[2m > [22mshould determine Warning health when borrowings 51-100[39m[32m 3[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Analytics API - System Metrics[2m > [22mgetSystemMetrics[2m > [22mshould determine Critical health when borrowings > 100[39m[32m 3[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Analytics API - System Metrics[2m > [22mgetSystemMetrics[2m > [22mshould handle null counts as 0[39m[32m 3[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Analytics API - System Metrics[2m > [22mgetSystemMetrics[2m > [22mshould return zero metrics on error[39m[32m 7[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Analytics API - System Metrics[2m > [22mgetSystemMetrics[2m > [22mshould filter active classes correctly[39m[32m 3[2mms[22m[39m
[31m     â†’ User not authenticated[39m
[31m   [31mÃ—[31m Analytics API - System Metrics[2m > [22mgetSystemMetrics[2m > [22mshould filter pending and approved borrowings[39m[32m 2[2mms[22m[39m
[31m     â†’ User not authenticated[39m
 [32mâœ“[39m src/__tests__/unit/hooks/useSync.test.ts [2m([22m[2m34 tests[22m[2m)[22m[33m 3092[2mms[22m[39m
[90mstdout[2m | server/src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould save answers online
[22m[39mâœ… Loaded soal securely (jawaban_benar hidden)
ðŸ”µ Starting new attempt for kuis: quiz-1

[90mstdout[2m | server/src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould save answers online
[22m[39mâœ… Attempt loaded: attempt-1

[90mstdout[2m | src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould save answers online
[22m[39mâœ… Loaded soal securely (jawaban_benar hidden)
ðŸ”µ Starting new attempt for kuis: quiz-1

[90mstdout[2m | src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould save answers online
[22m[39mâœ… Attempt loaded: attempt-1

[90mstdout[2m | server/src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould save answers online
[22m[39mâœ… Auto-saved (offline): soal-1

[90mstdout[2m | server/src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould detect offline status and show alert
[22m[39mâœ… Loaded soal securely (jawaban_benar hidden)
ðŸ”µ Starting new attempt for kuis: quiz-1

[90mstdout[2m | server/src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould detect offline status and show alert
[22m[39mâœ… Attempt loaded: attempt-1

[90mstdout[2m | server/src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould persist data after refresh when offline
[22m[39mâœ… Loaded soal securely (jawaban_benar hidden)
ðŸ”µ Resuming attempt: attempt-1

[90mstdout[2m | server/src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould persist data after refresh when offline
[22m[39mâœ… Attempt loaded: attempt-1

[90mstdout[2m | server/src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould automatically sync when coming back online
[22m[39mâœ… Loaded soal securely (jawaban_benar hidden)
ðŸ”µ Starting new attempt for kuis: quiz-1

[90mstdout[2m | server/src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould automatically sync when coming back online
[22m[39mâœ… Attempt loaded: attempt-1

[90mstdout[2m | src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould save answers online
[22m[39mâœ… Auto-saved (offline): soal-1

[90mstdout[2m | src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould detect offline status and show alert
[22m[39mâœ… Loaded soal securely (jawaban_benar hidden)
ðŸ”µ Starting new attempt for kuis: quiz-1

[90mstdout[2m | src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould detect offline status and show alert
[22m[39mâœ… Attempt loaded: attempt-1

[90mstdout[2m | src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould persist data after refresh when offline
[22m[39mâœ… Loaded soal securely (jawaban_benar hidden)
ðŸ”µ Resuming attempt: attempt-1

[90mstdout[2m | src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould persist data after refresh when offline
[22m[39mâœ… Attempt loaded: attempt-1

[90mstdout[2m | src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould automatically sync when coming back online
[22m[39mâœ… Loaded soal securely (jawaban_benar hidden)
ðŸ”µ Starting new attempt for kuis: quiz-1

[90mstdout[2m | src/__tests__/integration/kuis-attempt-offline.test.tsx[2m > [22m[2mKuis Attempt Offline Integration[2m > [22m[2mshould automatically sync when coming back online
[22m[39mâœ… Attempt loaded: attempt-1

 [32mâœ“[39m server/src/__tests__/integration/kuis-attempt-offline.test.tsx [2m([22m[2m7 tests[22m[2m | [22m[33m3 skipped[39m[2m)[22m[33m 3010[2mms[22m[39m
   [33m[2mâœ“[22m[39m Kuis Attempt Offline Integration[2m > [22mshould save answers online [33m 1136[2mms[22m[39m
   [33m[2mâœ“[22m[39m Kuis Attempt Offline Integration[2m > [22mshould automatically sync when coming back online [33m 1388[2mms[22m[39m
 [32mâœ“[39m src/__tests__/integration/kuis-attempt-offline.test.tsx [2m([22m[2m7 tests[22m[2m | [22m[33m3 skipped[39m[2m)[22m[33m 2804[2mms[22m[39m
   [33m[2mâœ“[22m[39m Kuis Attempt Offline Integration[2m > [22mshould save answers online [33m 1040[2mms[22m[39m
   [33m[2mâœ“[22m[39m Kuis Attempt Offline Integration[2m > [22mshould automatically sync when coming back online [33m 1393[2mms[22m[39m
 [32mâœ“[39m src/__tests__/unit/hooks/useLocalData.test.ts [2m([22m[2m30 tests[22m[2m | [22m[33m2 skipped[39m[2m)[22m[33m 2531[2mms[22m[39m
 [32mâœ“[39m src/__tests__/integration/network-reconnect.test.tsx [2m([22m[2m8 tests[22m[2m)[22m[33m 854[2mms[22m[39m
 [32mâœ“[39m server/src/__tests__/unit/hooks/useLocalData.test.ts [2m([22m[2m30 tests[22m[2m | [22m[33m2 skipped[39m[2m)[22m[33m 2186[2mms[22m[39m
 [32mâœ“[39m server/src/__tests__/integration/network-reconnect.test.tsx [2m([22m[2m8 tests[22m[2m)[22m[33m 898[2mms[22m[39m
[90mstdout[2m | src/__tests__/unit/providers/SyncProvider.test.tsx[2m > [22m[2mSyncProvider[2m > [22m[2mInitialization[2m > [22m[2mshould render children immediately
[22m[39mAuto-syncing 5 pending items...

[90mstdout[2m | src/__tests__/unit/providers/SyncProvider.test.tsx[2m > [22m[2mSyncProvider[2m > [22m[2mInitialization[2m > [22m[2mshould provide sync context to children
[22m[39mAuto-syncing 5 pending items...

[90mstdout[2m | src/__tests__/unit/providers/SyncProvider.test.tsx[2m > [22m[2mSyncProvider[2m > [22m[2mInitialization[2m > [22m[2mshould provide stats to children
[22m[39mAuto-syncing 5 pending items...

 [32mâœ“[39m src/__tests__/unit/providers/SyncProvider.test.tsx [2m([22m[2m20 tests[22m[2m | [22m[33m6 skipped[39m[2m)[22m[33m 782[2mms[22m[39m
 [32mâœ“[39m server/src/__tests__/unit/hooks/useNetworkStatus.test.ts [2m([22m[2m23 tests[22m[2m)[22m[33m 948[2mms[22m[39m
 [32mâœ“[39m src/__tests__/unit/hooks/useNetworkStatus.test.ts [2m([22m[2m23 tests[22m[2m)[22m[33m 997[2mms[22m[39m
[90mstdout[2m | src/__tests__/unit/providers/OfflineProvider.test.tsx[2m > [22m[2mOfflineProvider[2m > [22m[2mInitialization[2m > [22m[2mshould initialize IndexedDB on mount
[22m[39mâœ… OfflineProvider: IndexedDB initialized

[90mstdout[2m | src/__tests__/unit/providers/OfflineProvider.test.tsx[2m > [22m[2mOfflineProvider[2m > [22m[2mInitialization[2m > [22m[2mshould render children after IndexedDB is ready
[22m[39mâœ… OfflineProvider: IndexedDB initialized

[90mstdout[2m | src/__tests__/unit/providers/OfflineProvider.test.tsx[2m > [22m[2mOfflineProvider[2m > [22m[2mContext[2m > [22m[2mshould provide offline context to children
[22m[39mâœ… OfflineProvider: IndexedDB initialized

[90mstdout[2m | src/__tests__/unit/providers/OfflineProvider.test.tsx[2m > [22m[2mOfflineProvider[2m > [22m[2mContext[2m > [22m[2mshould provide all offline methods
[22m[39mâœ… OfflineProvider: IndexedDB initialized

[90mstdout[2m | src/__tests__/unit/providers/OfflineProvider.test.tsx[2m > [22m[2mOfflineProvider[2m > [22m[2mContext[2m > [22m[2mshould provide quality metrics
[22m[39mâœ… OfflineProvider: IndexedDB initialized

[90mstdout[2m | src/__tests__/unit/providers/OfflineProvider.test.tsx[2m > [22m[2mOfflineProvider[2m > [22m[2mCleanup[2m > [22m[2mshould cleanup on unmount
[22m[39mâœ… OfflineProvider: IndexedDB initialized

[90mstdout[2m | src/__tests__/unit/providers/OfflineProvider.test.tsx[2m > [22m[2mOfflineProvider[2m > [22m[2mIntegration[2m > [22m[2mshould work with multiple children
[22m[39mâœ… OfflineProvider: IndexedDB initialized

[90mstdout[2m | src/__tests__/unit/providers/OfflineProvider.test.tsx[2m > [22m[2mOfflineProvider[2m > [22m[2mIntegration[2m > [22m[2mshould initialize only once with multiple children
[22m[39mâœ… OfflineProvider: IndexedDB initialized

[90mstdout[2m | src/__tests__/unit/providers/OfflineProvider.test.tsx[2m > [22m[2mOfflineProvider[2m > [22m[2mIntegration[2m > [22m[2mshould handle nested components accessing context
[22m[39mâœ… OfflineProvider: IndexedDB initialized

[90mstdout[2m | src/__tests__/unit/providers/OfflineProvider.test.tsx[2m > [22m[2mOfflineProvider[2m > [22m[2mError Handling[2m > [22m[2mshould not throw when initialization takes long time
[22m[39mâœ… OfflineProvider: IndexedDB initialized

 [32mâœ“[39m src/__tests__/unit/providers/OfflineProvider.test.tsx [2m([22m[2m16 tests[22m[2m)[22m[33m 1140[2mms[22m[39m
[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mInitialization[2m > [22m[2mshould setup global error handlers
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogReactError[2m > [22m[2mshould log React error boundary errors
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogReactError[2m > [22m[2mshould include custom metadata
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogReactError[2m > [22m[2mshould capture error stack trace
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogReactError[2m > [22m[2mshould handle error without component stack
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogJSError[2m > [22m[2mshould log JavaScript Error objects
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogJSError[2m > [22m[2mshould log ErrorEvent objects
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogJSError[2m > [22m[2mshould handle ErrorEvent without error object
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogJSError[2m > [22m[2mshould include custom metadata
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogPromiseRejection[2m > [22m[2mshould log promise rejection with Error object
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogPromiseRejection[2m > [22m[2mshould log promise rejection with string reason
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogPromiseRejection[2m > [22m[2mshould log promise rejection with no reason
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogPromiseRejection[2m > [22m[2mshould include custom metadata
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogError[2m > [22m[2mshould log Error objects
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogError[2m > [22m[2mshould log string errors
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogError[2m > [22m[2mshould include custom metadata
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Queue Management[2m > [22m[2mshould add errors to queue
[22m[39mðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Queue Management[2m > [22m[2mshould maintain max queue size of 50
[22m[39mðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Queue Management[2m > [22m[2mshould store last 10 errors in localStorage
[22m[39mðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Queue Management[2m > [22m[2mshould clear error logs
[22m[39mðŸ”´ Error Logged
ðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Queue Management[2m > [22m[2mshould handle localStorage errors gracefully
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Log Structure[2m > [22m[2mshould include timestamp
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Log Structure[2m > [22m[2mshould include user agent
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Log Structure[2m > [22m[2mshould include current URL
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Log Structure[2m > [22m[2mshould include stack trace when available
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mbeforeSend Hook[2m > [22m[2mshould apply beforeSend transformation
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mbeforeSend Hook[2m > [22m[2mshould skip logging when beforeSend returns null
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mbeforeSend Hook[2m > [22m[2mshould filter sensitive data in beforeSend
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mSample Rate[2m > [22m[2mshould log all errors with sampleRate 1.0
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mSample Rate[2m > [22m[2mshould log no errors with sampleRate 0.0
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mSample Rate[2m > [22m[2mshould sample errors at approximately 50% with sampleRate 0.5
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mExternal Service Integration[2m > [22m[2mshould send to custom endpoint when DSN provided
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mExternal Service Integration[2m > [22m[2mshould handle fetch errors gracefully
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mExternal Service Integration[2m > [22m[2mshould not send to external service when disabled
[22m[39mâœ… Error Logger initialized { enabled: [33mfalse[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mExternal Service Integration[2m > [22m[2mshould not send to external service without DSN
[22m[39mâœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mIntegration Scenarios[2m > [22m[2mshould handle complete error logging lifecycle
[22m[39mâœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mIntegration Scenarios[2m > [22m[2mshould handle error logging with transformations
[22m[39mâœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle errors with circular references in metadata
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle very long error messages
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle errors without stack traces
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle undefined metadata values
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | server/src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle rapid error logging
[22m[39mðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged

 [32mâœ“[39m server/src/__tests__/unit/utils/error-logger.test.ts [2m([22m[2m51 tests[22m[2m)[22m[33m 707[2mms[22m[39m
[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mInitialization[2m > [22m[2mshould setup global error handlers
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogReactError[2m > [22m[2mshould log React error boundary errors
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogReactError[2m > [22m[2mshould include custom metadata
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogReactError[2m > [22m[2mshould capture error stack trace
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogReactError[2m > [22m[2mshould handle error without component stack
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogJSError[2m > [22m[2mshould log JavaScript Error objects
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogJSError[2m > [22m[2mshould log ErrorEvent objects
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogJSError[2m > [22m[2mshould handle ErrorEvent without error object
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogJSError[2m > [22m[2mshould include custom metadata
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogPromiseRejection[2m > [22m[2mshould log promise rejection with Error object
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogPromiseRejection[2m > [22m[2mshould log promise rejection with string reason
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogPromiseRejection[2m > [22m[2mshould log promise rejection with no reason
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogPromiseRejection[2m > [22m[2mshould include custom metadata
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogError[2m > [22m[2mshould log Error objects
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogError[2m > [22m[2mshould log string errors
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mlogError[2m > [22m[2mshould include custom metadata
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Queue Management[2m > [22m[2mshould add errors to queue
[22m[39mðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Queue Management[2m > [22m[2mshould maintain max queue size of 50
[22m[39mðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Queue Management[2m > [22m[2mshould store last 10 errors in localStorage
[22m[39mðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Queue Management[2m > [22m[2mshould clear error logs
[22m[39mðŸ”´ Error Logged
ðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Queue Management[2m > [22m[2mshould handle localStorage errors gracefully
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Log Structure[2m > [22m[2mshould include timestamp
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Log Structure[2m > [22m[2mshould include user agent
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Log Structure[2m > [22m[2mshould include current URL
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mError Log Structure[2m > [22m[2mshould include stack trace when available
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mbeforeSend Hook[2m > [22m[2mshould apply beforeSend transformation
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mbeforeSend Hook[2m > [22m[2mshould skip logging when beforeSend returns null
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mbeforeSend Hook[2m > [22m[2mshould filter sensitive data in beforeSend
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mSample Rate[2m > [22m[2mshould log all errors with sampleRate 1.0
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mSample Rate[2m > [22m[2mshould log no errors with sampleRate 0.0
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mSample Rate[2m > [22m[2mshould sample errors at approximately 50% with sampleRate 0.5
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mExternal Service Integration[2m > [22m[2mshould send to custom endpoint when DSN provided
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mExternal Service Integration[2m > [22m[2mshould handle fetch errors gracefully
[22m[39mðŸ“¡ External error service configured (not yet implemented)
âœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mExternal Service Integration[2m > [22m[2mshould not send to external service when disabled
[22m[39mâœ… Error Logger initialized { enabled: [33mfalse[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mExternal Service Integration[2m > [22m[2mshould not send to external service without DSN
[22m[39mâœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mIntegration Scenarios[2m > [22m[2mshould handle complete error logging lifecycle
[22m[39mâœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mIntegration Scenarios[2m > [22m[2mshould handle error logging with transformations
[22m[39mâœ… Error Logger initialized { enabled: [33mtrue[39m, environment: [32m'production'[39m }
ðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle errors with circular references in metadata
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle very long error messages
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle errors without stack traces
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle undefined metadata values
[22m[39mðŸ”´ Error Logged

[90mstdout[2m | src/__tests__/unit/utils/error-logger.test.ts[2m > [22m[2mError Logger[2m > [22m[2mEdge Cases[2m > [22m[2mshould handle rapid error logging
[22m[39mðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged
ðŸ”´ Error Logged

 [32mâœ“[39m src/__tests__/unit/utils/error-logger.test.ts [2m([22m[2m51 tests[22m[2m)[22m[33m 710[2mms[22m[39m
[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould fetch all users with role-specific data
[22m[39m[getAllUsersImpl] Fetching all users from database...

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould fetch all users with role-specific data
[22m[39m[getAllUsersImpl] Query result: { count: [33m4[39m, error: [1mnull[22m }

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould map mahasiswa NIM correctly
[22m[39m[getAllUsersImpl] Fetching all users from database...

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould map mahasiswa NIM correctly
[22m[39m[getAllUsersImpl] Query result: { count: [33m4[39m, error: [1mnull[22m }

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould map dosen NIP and NIDN correctly
[22m[39m[getAllUsersImpl] Fetching all users from database...

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould map dosen NIP and NIDN correctly
[22m[39m[getAllUsersImpl] Query result: { count: [33m4[39m, error: [1mnull[22m }

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould handle empty users list
[22m[39m[getAllUsersImpl] Fetching all users from database...

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould handle empty users list
[22m[39m[getAllUsersImpl] Query result: { count: [33m0[39m, error: [1mnull[22m }
[getAllUsersImpl] No users found

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould handle null users data
[22m[39m[getAllUsersImpl] Fetching all users from database...

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould handle null users data
[22m[39m[getAllUsersImpl] Query result: { count: [90mundefined[39m, error: [1mnull[22m }
[getAllUsersImpl] No users found

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould provide default values for missing data
[22m[39m[getAllUsersImpl] Fetching all users from database...

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould provide default values for missing data
[22m[39m[getAllUsersImpl] Query result: { count: [33m1[39m, error: [1mnull[22m }

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould handle database errors gracefully
[22m[39m[getAllUsersImpl] Fetching all users from database...

[90mstderr[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould handle database errors gracefully
[22m[39mError fetching users: Error: Database connection failed
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\users.api.test.ts:295:16
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Get All Users[2m > [22m[2mgetAllUsers[2m > [22m[2mshould handle database errors gracefully
[22m[39m[getAllUsersImpl] Query result: {
  count: [90mundefined[39m,
  error: Error: Database connection failed
      at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\users.api.test.ts:295:16
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
      at new Promise (<anonymous>)
      at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
      at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
  [90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
      at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
      at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
}

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Statistics[2m > [22m[2mgetUserStats[2m > [22m[2mshould calculate user statistics correctly
[22m[39m[getAllUsersImpl] Fetching all users from database...

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Statistics[2m > [22m[2mgetUserStats[2m > [22m[2mshould calculate user statistics correctly
[22m[39m[getAllUsersImpl] Query result: { count: [33m4[39m, error: [1mnull[22m }

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Statistics[2m > [22m[2mgetUserStats[2m > [22m[2mshould return zero stats when no users
[22m[39m[getAllUsersImpl] Fetching all users from database...

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Statistics[2m > [22m[2mgetUserStats[2m > [22m[2mshould return zero stats when no users
[22m[39m[getAllUsersImpl] Query result: { count: [33m0[39m, error: [1mnull[22m }
[getAllUsersImpl] No users found

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Statistics[2m > [22m[2mgetUserStats[2m > [22m[2mshould handle errors and return zero stats
[22m[39m[getAllUsersImpl] Fetching all users from database...

[90mstderr[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Statistics[2m > [22m[2mgetUserStats[2m > [22m[2mshould handle errors and return zero stats
[22m[39mError fetching users: Error: DB Error
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\users.api.test.ts:372:16
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Statistics[2m > [22m[2mgetUserStats[2m > [22m[2mshould handle errors and return zero stats
[22m[39m[getAllUsersImpl] Query result: {
  count: [90mundefined[39m,
  error: Error: DB Error
      at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\users.api.test.ts:372:16
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
      at new Promise (<anonymous>)
      at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
      at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
  [90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
      at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
      at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
}

[90mstderr[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - Statistics[2m > [22m[2mgetUserStats[2m > [22m[2mshould handle errors and return zero stats
[22m[39mError fetching user stats: Error: DB Error
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\users.api.test.ts:372:16
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mtoggleUserStatus[2m > [22m[2mshould handle errors
[22m[39mError toggling user status: Error: Update failed
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\users.api.test.ts:425:45
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mcreateUser - COMPLEX FLOW[2m > [22m[2mshould handle signup errors
[22m[39mError creating user: Error: Email already exists
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\users.api.test.ts:565:16
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mcreateUser - COMPLEX FLOW[2m > [22m[2mshould handle missing user data after signup
[22m[39mError creating user: Error: Failed to create user
    at Module.createUserImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\users.api.ts:216:31[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete mahasiswa from role table then users table
[22m[39m[deleteUserImpl] Current authenticated user: { id: [32m'admin-user-id'[39m, email: [32m'admin@test.com'[39m, role: [32m'admin'[39m }
[deleteUserImpl] Step 1: Getting user info for user-3

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete mahasiswa from role table then users table
[22m[39m[deleteUserImpl] Step 1 result: { user: { role: [32m'mahasiswa'[39m }, error: [1mnull[22m }
[deleteUserImpl] Step 2: Deleting from role table: mahasiswa

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete mahasiswa from role table then users table
[22m[39m[deleteUserImpl] Deleted from mahasiswa table
[deleteUserImpl] Step 3: Deleting from users table

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete mahasiswa from role table then users table
[22m[39m[deleteUserImpl] Step 3 result: { error: [1mnull[22m, deletedData: [ { id: [32m'user-3'[39m } ], count: [33m1[39m }
[deleteUserImpl] Successfully deleted from users table, rows affected: [33m1[39m

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete mahasiswa from role table then users table
[22m[39m[deleteUserImpl] Database commit delay completed

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete mahasiswa from role table then users table
[22m[39m[Delete User] Cache invalidated for user user-3
[deleteUserImpl] Step 5: Calling edge function to delete from auth.users

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete mahasiswa from role table then users table
[22m[39m[deleteUserImpl] Successfully deleted user from auth.users: user-3

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete dosen from role table then users table
[22m[39m[deleteUserImpl] Current authenticated user: { id: [32m'admin-user-id'[39m, email: [32m'admin@test.com'[39m, role: [32m'admin'[39m }
[deleteUserImpl] Step 1: Getting user info for user-2

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete dosen from role table then users table
[22m[39m[deleteUserImpl] Step 1 result: { user: { role: [32m'dosen'[39m }, error: [1mnull[22m }
[deleteUserImpl] Step 2: Deleting from role table: dosen

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete dosen from role table then users table
[22m[39m[deleteUserImpl] Deleted from dosen table
[deleteUserImpl] Step 3: Deleting from users table

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete dosen from role table then users table
[22m[39m[deleteUserImpl] Step 3 result: { error: [1mnull[22m, deletedData: [ { id: [32m'user-2'[39m } ], count: [33m1[39m }
[deleteUserImpl] Successfully deleted from users table, rows affected: [33m1[39m

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete dosen from role table then users table
[22m[39m[deleteUserImpl] Database commit delay completed

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete dosen from role table then users table
[22m[39m[Delete User] Cache invalidated for user user-2
[deleteUserImpl] Step 5: Calling edge function to delete from auth.users

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete dosen from role table then users table
[22m[39m[deleteUserImpl] Successfully deleted user from auth.users: user-2

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete laboran from role table then users table
[22m[39m[deleteUserImpl] Current authenticated user: { id: [32m'admin-user-id'[39m, email: [32m'admin@test.com'[39m, role: [32m'admin'[39m }
[deleteUserImpl] Step 1: Getting user info for user-4

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete laboran from role table then users table
[22m[39m[deleteUserImpl] Step 1 result: { user: { role: [32m'laboran'[39m }, error: [1mnull[22m }
[deleteUserImpl] Step 2: Deleting from role table: laboran

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete laboran from role table then users table
[22m[39m[deleteUserImpl] Deleted from laboran table
[deleteUserImpl] Step 3: Deleting from users table

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete laboran from role table then users table
[22m[39m[deleteUserImpl] Step 3 result: { error: [1mnull[22m, deletedData: [ { id: [32m'user-4'[39m } ], count: [33m1[39m }
[deleteUserImpl] Successfully deleted from users table, rows affected: [33m1[39m

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete laboran from role table then users table
[22m[39m[deleteUserImpl] Database commit delay completed

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete laboran from role table then users table
[22m[39m[Delete User] Cache invalidated for user user-4
[deleteUserImpl] Step 5: Calling edge function to delete from auth.users

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould delete laboran from role table then users table
[22m[39m[deleteUserImpl] Successfully deleted user from auth.users: user-4

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould fail if role-specific delete fails
[22m[39m[deleteUserImpl] Current authenticated user: { id: [32m'admin-user-id'[39m, email: [32m'admin@test.com'[39m, role: [32m'admin'[39m }
[deleteUserImpl] Step 1: Getting user info for user-3

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould fail if role-specific delete fails
[22m[39m[deleteUserImpl] Step 1 result: { user: { role: [32m'mahasiswa'[39m }, error: [1mnull[22m }
[deleteUserImpl] Step 2: Deleting from role table: mahasiswa

[90mstderr[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould fail if role-specific delete fails
[22m[39mFailed to delete from mahasiswa table: Error: Foreign key constraint
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\users.api.test.ts:724:16
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
[deleteUserImpl] ERROR: Error: Failed to delete mahasiswa record: Foreign key constraint
    at Module.deleteUserImpl [90m(F:\tes 9\sistem-praktikum-pwa\[39msrc\lib\api\users.api.ts:317:15[90m)[39m
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\users.api.test.ts:732:7
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:20
[deleteUserImpl] Error details: {
  message: [32m'Failed to delete mahasiswa record: Foreign key constraint'[39m,
  code: [90mundefined[39m,
  details: [90mundefined[39m,
  hint: [90mundefined[39m,
  status: [90mundefined[39m
}

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould handle user not found
[22m[39m[deleteUserImpl] Current authenticated user: { id: [32m'admin-user-id'[39m, email: [32m'admin@test.com'[39m, role: [32m'admin'[39m }
[deleteUserImpl] Step 1: Getting user info for nonexistent

[90mstderr[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould handle user not found
[22m[39m[deleteUserImpl] Failed to get user: Error: Not found
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\users.api.test.ts:741:16
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
[deleteUserImpl] ERROR: Error: Not found
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\users.api.test.ts:741:16
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
[deleteUserImpl] Error details: {
  message: [32m'Not found'[39m,
  code: [90mundefined[39m,
  details: [90mundefined[39m,
  hint: [90mundefined[39m,
  status: [90mundefined[39m
}

[90mstdout[2m | src/__tests__/unit/api/users.api.test.ts[2m > [22m[2mUsers API - CRUD Operations[2m > [22m[2mdeleteUser - CASCADE DELETE[2m > [22m[2mshould handle user not found
[22m[39m[deleteUserImpl] Step 1 result: {
  user: [1mnull[22m,
  error: Error: Not found
      at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\users.api.test.ts:741:16
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
      at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
      at new Promise (<anonymous>)
      at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
      at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
      at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
      at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
      at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
}

 [32mâœ“[39m src/__tests__/unit/api/users.api.test.ts [2m([22m[2m25 tests[22m[2m)[22m[33m 475[2mms[22m[39m
[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mMahasiswa Role Access[2m > [22m[2mshould allow mahasiswa to access mahasiswa routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/mahasiswa/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.146Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/mahasiswa/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'mahasiswa'[39m,
  allowedRoles: [ [32m'mahasiswa'[39m ],
  hasPermission: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.149Z'[39m
}
âœ… RoleGuard: AUTHORIZED, rendering children { userRole: [32m'mahasiswa'[39m, allowedRoles: [ [32m'mahasiswa'[39m ] }

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mMahasiswa Role Access[2m > [22m[2mshould prevent mahasiswa from accessing dosen routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/dosen/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.230Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/dosen/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'mahasiswa'[39m,
  allowedRoles: [ [32m'dosen'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:58:56.231Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 { userRole: [32m'mahasiswa'[39m, allowedRoles: [ [32m'dosen'[39m ] }

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mMahasiswa Role Access[2m > [22m[2mshould prevent mahasiswa from accessing admin routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/admin/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.273Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/admin/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'mahasiswa'[39m,
  allowedRoles: [ [32m'admin'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:58:56.274Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 { userRole: [32m'mahasiswa'[39m, allowedRoles: [ [32m'admin'[39m ] }

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mMahasiswa Role Access[2m > [22m[2mshould prevent mahasiswa from accessing laboran routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/laboran/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.297Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/laboran/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'mahasiswa'[39m,
  allowedRoles: [ [32m'laboran'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:58:56.298Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 { userRole: [32m'mahasiswa'[39m, allowedRoles: [ [32m'laboran'[39m ] }

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mDosen Role Access[2m > [22m[2mshould allow dosen to access dosen routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/dosen/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.310Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/dosen/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'dosen'[39m,
  allowedRoles: [ [32m'dosen'[39m ],
  hasPermission: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.311Z'[39m
}
âœ… RoleGuard: AUTHORIZED, rendering children { userRole: [32m'dosen'[39m, allowedRoles: [ [32m'dosen'[39m ] }

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mDosen Role Access[2m > [22m[2mshould prevent dosen from accessing mahasiswa routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/mahasiswa/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.347Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/mahasiswa/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'dosen'[39m,
  allowedRoles: [ [32m'mahasiswa'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:58:56.347Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 { userRole: [32m'dosen'[39m, allowedRoles: [ [32m'mahasiswa'[39m ] }

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mDosen Role Access[2m > [22m[2mshould prevent dosen from accessing admin routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/admin/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.364Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/admin/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'dosen'[39m,
  allowedRoles: [ [32m'admin'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:58:56.364Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 { userRole: [32m'dosen'[39m, allowedRoles: [ [32m'admin'[39m ] }

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mLaboran Role Access[2m > [22m[2mshould allow laboran to access laboran routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/laboran/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.373Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/laboran/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'laboran'[39m,
  allowedRoles: [ [32m'laboran'[39m ],
  hasPermission: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.373Z'[39m
}
âœ… RoleGuard: AUTHORIZED, rendering children { userRole: [32m'laboran'[39m, allowedRoles: [ [32m'laboran'[39m ] }

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mLaboran Role Access[2m > [22m[2mshould prevent laboran from accessing mahasiswa routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/mahasiswa/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.398Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/mahasiswa/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'laboran'[39m,
  allowedRoles: [ [32m'mahasiswa'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:58:56.398Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 { userRole: [32m'laboran'[39m, allowedRoles: [ [32m'mahasiswa'[39m ] }

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mLaboran Role Access[2m > [22m[2mshould prevent laboran from accessing dosen routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/dosen/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.415Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/dosen/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'laboran'[39m,
  allowedRoles: [ [32m'dosen'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:58:56.416Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 { userRole: [32m'laboran'[39m, allowedRoles: [ [32m'dosen'[39m ] }

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mAdmin Role Access[2m > [22m[2mshould allow admin to access admin routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/admin/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.440Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/admin/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'admin'[39m,
  allowedRoles: [ [32m'admin'[39m ],
  hasPermission: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.440Z'[39m
}
âœ… RoleGuard: AUTHORIZED, rendering children { userRole: [32m'admin'[39m, allowedRoles: [ [32m'admin'[39m ] }

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mAdmin Role Access[2m > [22m[2mshould prevent admin from accessing mahasiswa routes (if not multi-role)
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/mahasiswa/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.449Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/mahasiswa/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'admin'[39m,
  allowedRoles: [ [32m'mahasiswa'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:58:56.449Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 { userRole: [32m'admin'[39m, allowedRoles: [ [32m'mahasiswa'[39m ] }

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mUnauthenticated Access[2m > [22m[2mshould redirect unauthenticated users to login
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/mahasiswa/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:58:56.482Z'[39m
}
âŒ ProtectedRoute: NOT AUTHENTICATED, redirecting to login { attemptedPath: [32m'/mahasiswa/dashboard'[39m, redirectTo: [32m'/login'[39m }

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mUnauthenticated Access[2m > [22m[2mshould redirect from protected admin routes to login when not authenticated
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/admin/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:58:56.511Z'[39m
}
âŒ ProtectedRoute: NOT AUTHENTICATED, redirecting to login { attemptedPath: [32m'/admin/dashboard'[39m, redirectTo: [32m'/login'[39m }

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mLoading States[2m > [22m[2mshould show loading state when auth is initializing
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/mahasiswa/dashboard'[39m,
  loading: [33mtrue[39m,
  initialized: [33mfalse[39m,
  isAuthenticated: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:58:56.529Z'[39m
}
â³ ProtectedRoute: LOADING STATE (should be fast with cache!) { loading: [33mtrue[39m, initialized: [33mfalse[39m }

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mLoading States[2m > [22m[2mshould show loading state in RoleGuard when verifying permissions
[22m[39mðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mtrue[39m,
  initialized: [33mfalse[39m,
  userRole: [90mundefined[39m,
  allowedRoles: [ [32m'mahasiswa'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:58:56.550Z'[39m
}
â³ RoleGuard: LOADING STATE { loading: [33mtrue[39m, initialized: [33mfalse[39m }

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mMulti-Role Access[2m > [22m[2mshould allow access when user role matches any allowed role
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/shared/resource'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.561Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/shared/resource'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'dosen'[39m,
  allowedRoles: [ [32m'dosen'[39m, [32m'admin'[39m ],
  hasPermission: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.561Z'[39m
}
âœ… RoleGuard: AUTHORIZED, rendering children { userRole: [32m'dosen'[39m, allowedRoles: [ [32m'dosen'[39m, [32m'admin'[39m ] }

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mMulti-Role Access[2m > [22m[2mshould deny access when user role does not match any allowed roles
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/shared/resource'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:58:56.576Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/shared/resource'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'mahasiswa'[39m,
  allowedRoles: [ [32m'dosen'[39m, [32m'admin'[39m, [32m'laboran'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:58:56.577Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 {
  userRole: [32m'mahasiswa'[39m,
  allowedRoles: [ [32m'dosen'[39m, [32m'admin'[39m, [32m'laboran'[39m ]
}

[90mstdout[2m | server/src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mRoleGuard without ProtectedRoute[2m > [22m[2mshould redirect to login when user is null in RoleGuard
[22m[39mðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [90mundefined[39m,
  allowedRoles: [ [32m'mahasiswa'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:58:56.600Z'[39m
}
âŒ RoleGuard: NO USER, redirecting to login

 [32mâœ“[39m server/src/__tests__/integration/role-access.test.tsx [2m([22m[2m19 tests[22m[2m)[22m[33m 497[2mms[22m[39m
 [32mâœ“[39m server/src/__tests__/unit/lib/offline/indexeddb.test.ts [2m([22m[2m54 tests[22m[2m)[22m[33m 894[2mms[22m[39m
 [32mâœ“[39m src/__tests__/unit/lib/offline/indexeddb.test.ts [2m([22m[2m54 tests[22m[2m)[22m[33m 1358[2mms[22m[39m
 [32mâœ“[39m src/__tests__/unit/lib/offline/queue-manager.test.ts [2m([22m[2m47 tests[22m[2m)[22m[33m 700[2mms[22m[39m
 [32mâœ“[39m server/src/__tests__/unit/lib/offline/queue-manager.test.ts [2m([22m[2m47 tests[22m[2m)[22m[33m 1185[2mms[22m[39m
[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mMahasiswa Role Access[2m > [22m[2mshould allow mahasiswa to access mahasiswa routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/mahasiswa/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.206Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/mahasiswa/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'mahasiswa'[39m,
  allowedRoles: [ [32m'mahasiswa'[39m ],
  hasPermission: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.209Z'[39m
}
âœ… RoleGuard: AUTHORIZED, rendering children { userRole: [32m'mahasiswa'[39m, allowedRoles: [ [32m'mahasiswa'[39m ] }

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mMahasiswa Role Access[2m > [22m[2mshould prevent mahasiswa from accessing dosen routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/dosen/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.267Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/dosen/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'mahasiswa'[39m,
  allowedRoles: [ [32m'dosen'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:59:10.268Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 { userRole: [32m'mahasiswa'[39m, allowedRoles: [ [32m'dosen'[39m ] }

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mMahasiswa Role Access[2m > [22m[2mshould prevent mahasiswa from accessing admin routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/admin/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.303Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/admin/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'mahasiswa'[39m,
  allowedRoles: [ [32m'admin'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:59:10.304Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 { userRole: [32m'mahasiswa'[39m, allowedRoles: [ [32m'admin'[39m ] }

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mMahasiswa Role Access[2m > [22m[2mshould prevent mahasiswa from accessing laboran routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/laboran/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.321Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/laboran/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'mahasiswa'[39m,
  allowedRoles: [ [32m'laboran'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:59:10.321Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 { userRole: [32m'mahasiswa'[39m, allowedRoles: [ [32m'laboran'[39m ] }

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mDosen Role Access[2m > [22m[2mshould allow dosen to access dosen routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/dosen/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.344Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/dosen/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'dosen'[39m,
  allowedRoles: [ [32m'dosen'[39m ],
  hasPermission: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.345Z'[39m
}
âœ… RoleGuard: AUTHORIZED, rendering children { userRole: [32m'dosen'[39m, allowedRoles: [ [32m'dosen'[39m ] }

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mDosen Role Access[2m > [22m[2mshould prevent dosen from accessing mahasiswa routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/mahasiswa/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.366Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/mahasiswa/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'dosen'[39m,
  allowedRoles: [ [32m'mahasiswa'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:59:10.367Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 { userRole: [32m'dosen'[39m, allowedRoles: [ [32m'mahasiswa'[39m ] }

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mDosen Role Access[2m > [22m[2mshould prevent dosen from accessing admin routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/admin/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.384Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/admin/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'dosen'[39m,
  allowedRoles: [ [32m'admin'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:59:10.385Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 { userRole: [32m'dosen'[39m, allowedRoles: [ [32m'admin'[39m ] }

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mLaboran Role Access[2m > [22m[2mshould allow laboran to access laboran routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/laboran/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.416Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/laboran/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'laboran'[39m,
  allowedRoles: [ [32m'laboran'[39m ],
  hasPermission: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.417Z'[39m
}
âœ… RoleGuard: AUTHORIZED, rendering children { userRole: [32m'laboran'[39m, allowedRoles: [ [32m'laboran'[39m ] }

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mLaboran Role Access[2m > [22m[2mshould prevent laboran from accessing mahasiswa routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/mahasiswa/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.433Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/mahasiswa/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'laboran'[39m,
  allowedRoles: [ [32m'mahasiswa'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:59:10.433Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 { userRole: [32m'laboran'[39m, allowedRoles: [ [32m'mahasiswa'[39m ] }

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mLaboran Role Access[2m > [22m[2mshould prevent laboran from accessing dosen routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/dosen/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.454Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/dosen/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'laboran'[39m,
  allowedRoles: [ [32m'dosen'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:59:10.454Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 { userRole: [32m'laboran'[39m, allowedRoles: [ [32m'dosen'[39m ] }

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mAdmin Role Access[2m > [22m[2mshould allow admin to access admin routes
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/admin/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.476Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/admin/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'admin'[39m,
  allowedRoles: [ [32m'admin'[39m ],
  hasPermission: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.476Z'[39m
}
âœ… RoleGuard: AUTHORIZED, rendering children { userRole: [32m'admin'[39m, allowedRoles: [ [32m'admin'[39m ] }

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mAdmin Role Access[2m > [22m[2mshould prevent admin from accessing mahasiswa routes (if not multi-role)
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/mahasiswa/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.502Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/mahasiswa/dashboard'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'admin'[39m,
  allowedRoles: [ [32m'mahasiswa'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:59:10.502Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 { userRole: [32m'admin'[39m, allowedRoles: [ [32m'mahasiswa'[39m ] }

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mUnauthenticated Access[2m > [22m[2mshould redirect unauthenticated users to login
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/mahasiswa/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:59:10.517Z'[39m
}
âŒ ProtectedRoute: NOT AUTHENTICATED, redirecting to login { attemptedPath: [32m'/mahasiswa/dashboard'[39m, redirectTo: [32m'/login'[39m }

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mUnauthenticated Access[2m > [22m[2mshould redirect from protected admin routes to login when not authenticated
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/admin/dashboard'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:59:10.532Z'[39m
}
âŒ ProtectedRoute: NOT AUTHENTICATED, redirecting to login { attemptedPath: [32m'/admin/dashboard'[39m, redirectTo: [32m'/login'[39m }

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mLoading States[2m > [22m[2mshould show loading state when auth is initializing
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/mahasiswa/dashboard'[39m,
  loading: [33mtrue[39m,
  initialized: [33mfalse[39m,
  isAuthenticated: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:59:10.556Z'[39m
}
â³ ProtectedRoute: LOADING STATE (should be fast with cache!) { loading: [33mtrue[39m, initialized: [33mfalse[39m }

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mLoading States[2m > [22m[2mshould show loading state in RoleGuard when verifying permissions
[22m[39mðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mtrue[39m,
  initialized: [33mfalse[39m,
  userRole: [90mundefined[39m,
  allowedRoles: [ [32m'mahasiswa'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:59:10.565Z'[39m
}
â³ RoleGuard: LOADING STATE { loading: [33mtrue[39m, initialized: [33mfalse[39m }

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mMulti-Role Access[2m > [22m[2mshould allow access when user role matches any allowed role
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/shared/resource'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.570Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/shared/resource'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'dosen'[39m,
  allowedRoles: [ [32m'dosen'[39m, [32m'admin'[39m ],
  hasPermission: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.570Z'[39m
}
âœ… RoleGuard: AUTHORIZED, rendering children { userRole: [32m'dosen'[39m, allowedRoles: [ [32m'dosen'[39m, [32m'admin'[39m ] }

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mMulti-Role Access[2m > [22m[2mshould deny access when user role does not match any allowed roles
[22m[39mðŸ” ProtectedRoute Check: {
  path: [32m'/shared/resource'[39m,
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  isAuthenticated: [33mtrue[39m,
  timestamp: [32m'2026-01-14T05:59:10.576Z'[39m
}
âœ… ProtectedRoute: AUTHENTICATED, rendering children { path: [32m'/shared/resource'[39m }
ðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [32m'mahasiswa'[39m,
  allowedRoles: [ [32m'dosen'[39m, [32m'admin'[39m, [32m'laboran'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:59:10.576Z'[39m
}
ðŸš« RoleGuard: UNAUTHORIZED, redirecting to 403 {
  userRole: [32m'mahasiswa'[39m,
  allowedRoles: [ [32m'dosen'[39m, [32m'admin'[39m, [32m'laboran'[39m ]
}

[90mstdout[2m | src/__tests__/integration/role-access.test.tsx[2m > [22m[2mRole-based Access Control - CORE LOGIC[2m > [22m[2mRoleGuard without ProtectedRoute[2m > [22m[2mshould redirect to login when user is null in RoleGuard
[22m[39mðŸ›¡ï¸ RoleGuard Check: {
  loading: [33mfalse[39m,
  initialized: [33mtrue[39m,
  userRole: [90mundefined[39m,
  allowedRoles: [ [32m'mahasiswa'[39m ],
  hasPermission: [33mfalse[39m,
  timestamp: [32m'2026-01-14T05:59:10.597Z'[39m
}
âŒ RoleGuard: NO USER, redirecting to login

 [32mâœ“[39m src/__tests__/integration/role-access.test.tsx [2m([22m[2m19 tests[22m[2m)[22m[33m 726[2mms[22m[39m
   [33m[2mâœ“[22m[39m Role-based Access Control - CORE LOGIC[2m > [22mMahasiswa Role Access[2m > [22mshould allow mahasiswa to access mahasiswa routes [33m 370[2mms[22m[39m
[90mstderr[2m | src/__tests__/unit/api/sync.api.test.ts[2m > [22m[2mSync API[2m > [22m[2mgetSyncManagementStats[2m > [22m[2mshould handle errors gracefully
[22m[39mError fetching sync stats: Error: Sync error
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\sync.api.test.ts:58:9
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | src/__tests__/unit/api/sync.api.test.ts[2m > [22m[2mSync API[2m > [22m[2mforceSyncNow[2m > [22m[2mshould handle sync errors
[22m[39mError forcing sync: Error: Sync failed
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\api\sync.api.test.ts:83:9
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

 [32mâœ“[39m src/__tests__/unit/api/sync.api.test.ts [2m([22m[2m4 tests[22m[2m)[22m[33m 3197[2mms[22m[39m
   [33m[2mâœ“[22m[39m Sync API[2m > [22mgetSyncManagementStats[2m > [22mshould return sync statistics [33m 3114[2mms[22m[39m
[90mstderr[2m | server/src/__tests__/unit/hooks/useOffline.test.ts[2m > [22m[2museOffline[2m > [22m[2msaveOffline[2m > [22m[2mshould throw error when save fails
[22m[39mFailed to save offline data to kuis: Error: Save failed
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\hooks\useOffline.test.ts:138:21
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | server/src/__tests__/unit/hooks/useOffline.test.ts[2m > [22m[2museOffline[2m > [22m[2mdeleteOffline[2m > [22m[2mshould throw error when delete fails
[22m[39mFailed to delete offline data from kuis: Error: Delete failed
    at [90mF:\tes 9\sistem-praktikum-pwa\[39mserver\src\__tests__\unit\hooks\useOffline.test.ts:317:21
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

 [32mâœ“[39m server/src/__tests__/unit/hooks/useOffline.test.ts [2m([22m[2m26 tests[22m[2m)[22m[33m 378[2mms[22m[39m
 [32mâœ“[39m server/src/__tests__/unit/lib/pwa/cache-strategies.test.ts [2m([22m[2m35 tests[22m[2m)[22m[33m 308[2mms[22m[39m
[90mstderr[2m | src/__tests__/unit/hooks/useOffline.test.ts[2m > [22m[2museOffline[2m > [22m[2msaveOffline[2m > [22m[2mshould throw error when save fails
[22m[39mFailed to save offline data to kuis: Error: Save failed
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\hooks\useOffline.test.ts:138:21
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

[90mstderr[2m | src/__tests__/unit/hooks/useOffline.test.ts[2m > [22m[2museOffline[2m > [22m[2mdeleteOffline[2m > [22m[2mshould throw error when delete fails
[22m[39mFailed to delete offline data from kuis: Error: Delete failed
    at [90mF:\tes 9\sistem-praktikum-pwa\[39msrc\__tests__\unit\hooks\useOffline.test.ts:317:21
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:155:11
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:752:26
    at [90mfile:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1863:10[90m)[39m
    at runTest [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1574:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m
    at runSuite [90m(file:///F:/tes%209/sistem-praktikum-pwa/[39mnode_modules/[4m@vitest/runner[24m/dist/chunk-hooks.js:1729:8[90m)[39m

 [32mâœ“[39m src/__tests__/unit/hooks/useOffline.test.ts [2m([22m[2m26 tests[22m[2m)[22m[32m 227[2mms[22m[39m
 [32mâœ“[39m src/__tests__/unit/lib/pwa/cache-strategies.test.ts [2m([22m[2m35 tests[22m[2m)[22m[32m 256[2mms[22m[39m
