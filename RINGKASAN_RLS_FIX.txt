â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                              â•‘
â•‘                   RINGKASAN RLS POLICY FIX - PEMINJAMAN                      â•‘
â•‘                                                                              â•‘
â•‘                    Error 403 - Row Level Security Blocking                   â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ğŸ“Œ PROBLEM:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Saat dosen membuat permintaan peminjaman alat, muncul error:

  âŒ 403 Forbidden
  âŒ code: 42501
  âŒ message: "new row violates row-level security policy for table peminjaman"

Penyebab: RLS policy di table peminjaman block dosen dari INSERT


âœ… SOLUSI:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Update RLS policy dengan SQL code yang sudah disediakan


ğŸ“‹ FILE-FILE PANDUAN YANG TERSEDIA:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. SQL_COPY_PASTE.txt              â­ TERCEPAT (2 menit)
   â””â”€ 3 opsi SQL code siap copy-paste
   â””â”€ Langsung kode, no explanation
   â””â”€ Pick one, paste, run, done!

2. FIX_RLS_STEP_BY_STEP.txt        ğŸ“‹ STEP-BY-STEP (5-10 menit)
   â””â”€ Visual step-by-step di Supabase dashboard
   â””â”€ Klik ini, klik itu, copy ini, paste itu
   â””â”€ Ada troubleshooting jika stuck

3. SUPABASE_RLS_SETUP.md           ğŸ“š PANDUAN LENGKAP (15 menit)
   â””â”€ Penjelasan error & solusi
   â””â”€ 3 opsi code dengan penjelasan
   â””â”€ Include testing checklist

4. RLS_POLICY_FIX.md               ğŸ“– TEKNIS (20 menit)
   â””â”€ Deep dive tentang RLS & error
   â””â”€ Penjelasan tiap policy
   â””â”€ API changes explanation

5. sql_rls_fix.sql                 ğŸ’¾ SQL FILE
   â””â”€ Semua code dalam 1 file .sql
   â””â”€ Bisa dibuka text editor


ğŸš€ QUICK START (TERCEPAT):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Step 1: Buka file "SQL_COPY_PASTE.txt"

Step 2: Copy OPSI 1 code ini:

        -- Hapus policy lama
        DROP POLICY IF EXISTS "Allow dosen to create borrowing requests" ON peminjaman;
        DROP POLICY IF EXISTS "Allow laboran to manage peminjaman" ON peminjaman;
        DROP POLICY IF EXISTS "Users can view peminjaman" ON peminjaman;

        -- Policy 1: Allow create requests
        CREATE POLICY "Allow authenticated users to create borrowing requests"
        ON peminjaman
        FOR INSERT
        WITH CHECK (auth.uid() IS NOT NULL);

        -- Policy 2: Allow view
        CREATE POLICY "Allow authenticated users to view peminjaman"
        ON peminjaman
        FOR SELECT
        USING (auth.uid() IS NOT NULL);

        -- Policy 3: Allow laboran update
        CREATE POLICY "Allow laboran to update peminjaman"
        ON peminjaman
        FOR UPDATE
        USING (
          EXISTS (
            SELECT 1 FROM laboran WHERE user_id = auth.uid()
          )
        )
        WITH CHECK (
          EXISTS (
            SELECT 1 FROM laboran WHERE user_id = auth.uid()
          )
        );

        -- Enable RLS
        ALTER TABLE peminjaman ENABLE ROW LEVEL SECURITY;

Step 3: Login ke https://app.supabase.com

Step 4: Pilih project "sistem-praktikum-pwa"

Step 5: Klik SQL Editor di sidebar

Step 6: Paste code di text editor

Step 7: Klik tombol RUN

Step 8: Tunggu sampai "Success"

Step 9: âœ… DONE! Dosen sekarang bisa buat permintaan


ğŸ“Š OPSI MANA YANG DIPILIH?
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  OPSI 1 âœ…  â†’ Recommended (Paling aman)
              â†’ Jalankan ini dulu
              â†’ Jika error, lanjut ke OPSI 2

  OPSI 2 âš¡  â†’ Jika OPSI 1 error
              â†’ Lebih simple, less strict
              â†’ Coba ini selanjutnya

  OPSI 3 ğŸ’¨  â†’ Last resort (Disable semua RLS)
              â†’ Hanya jika 1 & 2 error
              â†’ JANGAN pakai di production!


âœ… SETELAH FIX:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Dosen sekarang bisa:
  âœ… Buat permintaan peminjaman alat
  âœ… Lihat status permintaan (Menunggu/Disetujui/Ditolak)
  âœ… Tandai alat sudah diambil (Status: Ambil)
  âœ… Kembalikan alat dengan tracking kondisi
  âœ… Lihat stok yang tersedia

Laboran sekarang bisa:
  âœ… Lihat permintaan menunggu approval
  âœ… Approve (stok otomatis berkurang)
  âœ… Reject dengan alasan
  âœ… Lihat history peminjaman & pengembalian


âš ï¸ SEBELUM RUN SQL:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  âœ… Backup database (optional tapi recommended)
  âœ… Login ke Supabase dashboard
  âœ… Di project yang benar: "sistem-praktikum-pwa"
  âœ… Copy code UTUH tanpa potongan
  âœ… Paste di SQL Editor
  âœ… RUN query


âš ï¸ SETELAH RUN SQL:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  âœ… Tunggu "Success" message
  âœ… Refresh browser: Ctrl+F5 atau Cmd+Shift+R
  âœ… Clear cache: F12 â†’ Application â†’ Clear All â†’ OK
  âœ… Logout & Login ulang
  âœ… Test dengan akun dosen
  âœ… Coba buat permintaan peminjaman
  âœ… Lihat apakah muncul di "Riwayat Peminjaman"


ğŸ†˜ JIKA MASIH ERROR:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Buka file: FIX_RLS_STEP_BY_STEP.txt
2. Cari section: "JIKA STUCK, COBA URUTAN INI"
3. Follow instruksi di sana
4. Screenshot error
5. Hubungi admin dengan screenshot


ğŸ¯ TIMELINE:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  â±ï¸  ~2 menit    â†’ Copy & paste code
  â±ï¸  ~1 menit    â†’ Run query di Supabase
  â±ï¸  ~30 detik   â†’ Tunggu success
  â±ï¸  ~2 menit    â†’ Refresh & test
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     ~5-6 menit TOTAL


ğŸ’¾ SEMUA FILE YANG DIBUAT:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  Folder: F:/tes 9/sistem-praktikum-pwa/

  â”œâ”€â”€ SQL_COPY_PASTE.txt         â† MULAI DARI SINI! â­
  â”œâ”€â”€ FIX_RLS_STEP_BY_STEP.txt   â† Detail step-by-step
  â”œâ”€â”€ SUPABASE_RLS_SETUP.md      â† Panduan lengkap
  â”œâ”€â”€ RLS_POLICY_FIX.md          â† Penjelasan teknis
  â”œâ”€â”€ sql_rls_fix.sql            â† SQL file (backup)
  â”œâ”€â”€ README_RLS_FIX.md          â† Index semua file
  â””â”€â”€ RINGKASAN_RLS_FIX.txt      â† File ini


âœ¨ REKOMENDASI NEXT STEPS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  1ï¸âƒ£  Baca: README_RLS_FIX.md (index semua file)

  2ï¸âƒ£  Pilih salah satu dari:
      â€¢ SQL_COPY_PASTE.txt (paling cepat)
      â€¢ FIX_RLS_STEP_BY_STEP.txt (step-by-step)
      â€¢ SUPABASE_RLS_SETUP.md (lengkap)

  3ï¸âƒ£  Jalankan SQL code

  4ï¸âƒ£  Test di aplikasi

  5ï¸âƒ£  âœ… Done! Dosen bisa membuat permintaan


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Questions?    â†’ Cek troubleshooting di FIX_RLS_STEP_BY_STEP.txt
  Want details? â†’ Baca RLS_POLICY_FIX.md
  Need checklist? â†’ Lihat SUPABASE_RLS_SETUP.md

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                        HAPPY FIXING! ğŸ‰

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
